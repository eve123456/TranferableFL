nohup: ignoring input
working!
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 64
	clients_per_round : 100
	             clip : False
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0001
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 1
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : False
	       reg_J_coef : 0.0
	   reg_J_ind_coef : 0.0
	  reg_J_norm_coef : 0.0001
	           repeat : 1
	     repeat_epoch : 10
	             seed : 0
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230925163918
FL pretrained model will be saved at ./models/lenet_mnist_20230925163918.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 10.620% / Loss: 2.3022 / Grad Norm: 0.1613 / Grad Diff: 1.6667 / Time: 12.28s
======================================================================================================

= Test = round: 0 / acc: 10.900% / loss: 2.3017 / Time: 1.05s
======================================================================================================

round 0 local learning rate = 0.01
round 1 local learning rate = 0.01
round 2 local learning rate = 0.01
round 3 local learning rate = 0.01
round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 14.821% / Loss: 2.2794 / Grad Norm: 0.5131 / Grad Diff: 21.7726 / Time: 12.91s
======================================================================================================

= Test = round: 5 / acc: 14.930% / loss: 2.2850 / Time: 1.19s
======================================================================================================

round 5 local learning rate = 0.01
round 6 local learning rate = 0.01
round 7 local learning rate = 0.01
round 8 local learning rate = 0.01
round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 46.456% / Loss: 2.1515 / Grad Norm: 0.9370 / Grad Diff: 185.9355 / Time: 12.62s
======================================================================================================

= Test = round: 10 / acc: 47.890% / loss: 2.1489 / Time: 1.11s
======================================================================================================

round 10 local learning rate = 0.01
round 11 local learning rate = 0.01
round 12 local learning rate = 0.01
round 13 local learning rate = 0.01
round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 60.225% / Loss: 1.9839 / Grad Norm: 1.1260 / Grad Diff: 186.4143 / Time: 12.65s
======================================================================================================

= Test = round: 15 / acc: 62.150% / loss: 1.9747 / Time: 1.13s
======================================================================================================

round 15 local learning rate = 0.01
round 16 local learning rate = 0.01
round 17 local learning rate = 0.01
round 18 local learning rate = 0.01
round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 63.910% / Loss: 1.7363 / Grad Norm: 1.4380 / Grad Diff: 185.1775 / Time: 16.11s
======================================================================================================

= Test = round: 20 / acc: 65.910% / loss: 1.7165 / Time: 1.43s
======================================================================================================

round 20 local learning rate = 0.01
round 21 local learning rate = 0.01
round 22 local learning rate = 0.01
round 23 local learning rate = 0.01
round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 67.042% / Loss: 1.4530 / Grad Norm: 1.5683 / Grad Diff: 183.5427 / Time: 17.34s
======================================================================================================

= Test = round: 25 / acc: 69.010% / loss: 1.4252 / Time: 1.31s
======================================================================================================

round 25 local learning rate = 0.01
round 26 local learning rate = 0.01
round 27 local learning rate = 0.01
round 28 local learning rate = 0.01
round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 71.330% / Loss: 1.2086 / Grad Norm: 1.3623 / Grad Diff: 176.9760 / Time: 17.10s
======================================================================================================

= Test = round: 30 / acc: 73.050% / loss: 1.1742 / Time: 1.57s
======================================================================================================

round 30 local learning rate = 0.01
round 31 local learning rate = 0.01
round 32 local learning rate = 0.01
round 33 local learning rate = 0.01
round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 74.107% / Loss: 1.0397 / Grad Norm: 1.4156 / Grad Diff: 158.4675 / Time: 18.96s
======================================================================================================

= Test = round: 35 / acc: 75.320% / loss: 1.0037 / Time: 1.42s
======================================================================================================

round 35 local learning rate = 0.01
round 36 local learning rate = 0.01
round 37 local learning rate = 0.01
round 38 local learning rate = 0.01
round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 76.605% / Loss: 0.9114 / Grad Norm: 1.4166 / Grad Diff: 145.2295 / Time: 18.48s
======================================================================================================

= Test = round: 40 / acc: 77.630% / loss: 0.8762 / Time: 1.43s
======================================================================================================

round 40 local learning rate = 0.01
round 41 local learning rate = 0.01
round 42 local learning rate = 0.01
round 43 local learning rate = 0.01
round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 78.566% / Loss: 0.8146 / Grad Norm: 1.2968 / Grad Diff: 132.8389 / Time: 16.14s
======================================================================================================

= Test = round: 45 / acc: 79.580% / loss: 0.7797 / Time: 1.30s
======================================================================================================

round 45 local learning rate = 0.01
round 46 local learning rate = 0.01
round 47 local learning rate = 0.01
round 48 local learning rate = 0.01
round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 80.354% / Loss: 0.7378 / Grad Norm: 1.1285 / Grad Diff: 125.3870 / Time: 14.14s
======================================================================================================

= Test = round: 50 / acc: 81.680% / loss: 0.7039 / Time: 1.34s
======================================================================================================

round 50 local learning rate = 0.01
round 51 local learning rate = 0.01
round 52 local learning rate = 0.01
round 53 local learning rate = 0.01
round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 81.624% / Loss: 0.6829 / Grad Norm: 1.0032 / Grad Diff: 115.0296 / Time: 14.79s
======================================================================================================

= Test = round: 55 / acc: 82.910% / loss: 0.6498 / Time: 1.48s
======================================================================================================

round 55 local learning rate = 0.01
round 56 local learning rate = 0.01
round 57 local learning rate = 0.01
round 58 local learning rate = 0.01
round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 82.738% / Loss: 0.6370 / Grad Norm: 0.9111 / Grad Diff: 106.3182 / Time: 16.50s
======================================================================================================

= Test = round: 60 / acc: 84.130% / loss: 0.6041 / Time: 1.42s
======================================================================================================

round 60 local learning rate = 0.01
round 61 local learning rate = 0.01
round 62 local learning rate = 0.01
round 63 local learning rate = 0.01
round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 83.747% / Loss: 0.5975 / Grad Norm: 0.7793 / Grad Diff: 99.9444 / Time: 15.73s
======================================================================================================

= Test = round: 65 / acc: 85.220% / loss: 0.5658 / Time: 1.41s
======================================================================================================

round 65 local learning rate = 0.01
round 66 local learning rate = 0.01
round 67 local learning rate = 0.01
round 68 local learning rate = 0.01
round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 84.496% / Loss: 0.5666 / Grad Norm: 0.8391 / Grad Diff: 93.9290 / Time: 16.35s
======================================================================================================

= Test = round: 70 / acc: 85.870% / loss: 0.5358 / Time: 1.41s
======================================================================================================

round 70 local learning rate = 0.01
round 71 local learning rate = 0.01
round 72 local learning rate = 0.01
round 73 local learning rate = 0.01
round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 85.247% / Loss: 0.5393 / Grad Norm: 0.7547 / Grad Diff: 87.1638 / Time: 15.13s
======================================================================================================

= Test = round: 75 / acc: 86.870% / loss: 0.5094 / Time: 1.35s
======================================================================================================

round 75 local learning rate = 0.01
round 76 local learning rate = 0.01
round 77 local learning rate = 0.01
round 78 local learning rate = 0.01
round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 85.819% / Loss: 0.5145 / Grad Norm: 0.8180 / Grad Diff: 83.0373 / Time: 15.84s
======================================================================================================

= Test = round: 80 / acc: 87.320% / loss: 0.4854 / Time: 1.46s
======================================================================================================

round 80 local learning rate = 0.01
round 81 local learning rate = 0.01
round 82 local learning rate = 0.01
round 83 local learning rate = 0.01
round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 86.384% / Loss: 0.4934 / Grad Norm: 0.7527 / Grad Diff: 77.5015 / Time: 15.35s
======================================================================================================

= Test = round: 85 / acc: 87.740% / loss: 0.4647 / Time: 1.20s
======================================================================================================

round 85 local learning rate = 0.01
round 86 local learning rate = 0.01
round 87 local learning rate = 0.01
round 88 local learning rate = 0.01
round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 86.871% / Loss: 0.4744 / Grad Norm: 0.6506 / Grad Diff: 72.4928 / Time: 14.08s
======================================================================================================

= Test = round: 90 / acc: 88.180% / loss: 0.4459 / Time: 1.27s
======================================================================================================

round 90 local learning rate = 0.01
round 91 local learning rate = 0.01
round 92 local learning rate = 0.01
round 93 local learning rate = 0.01
round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 87.148% / Loss: 0.4576 / Grad Norm: 0.7877 / Grad Diff: 69.9903 / Time: 13.51s
======================================================================================================

= Test = round: 95 / acc: 88.410% / loss: 0.4296 / Time: 1.32s
======================================================================================================

round 95 local learning rate = 0.01
round 96 local learning rate = 0.01
round 97 local learning rate = 0.01
round 98 local learning rate = 0.01
round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 87.662% / Loss: 0.4415 / Grad Norm: 0.6684 / Grad Diff: 65.9614 / Time: 13.74s
======================================================================================================

= Test = round: 100 / acc: 88.770% / loss: 0.4138 / Time: 1.40s
======================================================================================================

round 100 local learning rate = 0.01
round 101 local learning rate = 0.01
round 102 local learning rate = 0.01
round 103 local learning rate = 0.01
round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 88.059% / Loss: 0.4264 / Grad Norm: 0.6242 / Grad Diff: 62.8443 / Time: 15.99s
======================================================================================================

= Test = round: 105 / acc: 89.230% / loss: 0.3990 / Time: 1.28s
======================================================================================================

round 105 local learning rate = 0.01
round 106 local learning rate = 0.01
round 107 local learning rate = 0.01
round 108 local learning rate = 0.01
round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 88.352% / Loss: 0.4130 / Grad Norm: 0.5607 / Grad Diff: 59.5264 / Time: 17.25s
======================================================================================================

= Test = round: 110 / acc: 89.550% / loss: 0.3862 / Time: 1.32s
======================================================================================================

round 110 local learning rate = 0.01
round 111 local learning rate = 0.01
round 112 local learning rate = 0.01
round 113 local learning rate = 0.01
round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 88.653% / Loss: 0.4008 / Grad Norm: 0.5356 / Grad Diff: 57.0722 / Time: 17.36s
======================================================================================================

= Test = round: 115 / acc: 89.790% / loss: 0.3748 / Time: 1.49s
======================================================================================================

round 115 local learning rate = 0.01
round 116 local learning rate = 0.01
round 117 local learning rate = 0.01
round 118 local learning rate = 0.01
round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 88.814% / Loss: 0.3904 / Grad Norm: 0.6816 / Grad Diff: 55.6731 / Time: 17.36s
======================================================================================================

= Test = round: 120 / acc: 89.930% / loss: 0.3648 / Time: 1.47s
======================================================================================================

round 120 local learning rate = 0.01
round 121 local learning rate = 0.01
round 122 local learning rate = 0.01
round 123 local learning rate = 0.01
round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 89.138% / Loss: 0.3788 / Grad Norm: 0.5408 / Grad Diff: 53.1702 / Time: 17.04s
======================================================================================================

= Test = round: 125 / acc: 90.170% / loss: 0.3533 / Time: 1.37s
======================================================================================================

round 125 local learning rate = 0.01
round 126 local learning rate = 0.01
round 127 local learning rate = 0.01
round 128 local learning rate = 0.01
round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 89.437% / Loss: 0.3683 / Grad Norm: 0.4661 / Grad Diff: 51.1878 / Time: 15.93s
======================================================================================================

= Test = round: 130 / acc: 90.510% / loss: 0.3432 / Time: 1.41s
======================================================================================================

round 130 local learning rate = 0.01
round 131 local learning rate = 0.01
round 132 local learning rate = 0.01
round 133 local learning rate = 0.01
round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 89.694% / Loss: 0.3597 / Grad Norm: 0.4375 / Grad Diff: 48.8613 / Time: 15.74s
======================================================================================================

= Test = round: 135 / acc: 90.710% / loss: 0.3355 / Time: 1.35s
======================================================================================================

round 135 local learning rate = 0.01
round 136 local learning rate = 0.01
round 137 local learning rate = 0.01
round 138 local learning rate = 0.01
round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 89.832% / Loss: 0.3527 / Grad Norm: 0.5258 / Grad Diff: 46.8091 / Time: 16.49s
======================================================================================================

= Test = round: 140 / acc: 90.800% / loss: 0.3283 / Time: 1.40s
======================================================================================================

round 140 local learning rate = 0.01
round 141 local learning rate = 0.01
round 142 local learning rate = 0.01
round 143 local learning rate = 0.01
round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 90.020% / Loss: 0.3439 / Grad Norm: 0.5358 / Grad Diff: 45.6074 / Time: 17.46s
======================================================================================================

= Test = round: 145 / acc: 90.920% / loss: 0.3201 / Time: 1.44s
======================================================================================================

round 145 local learning rate = 0.01
round 146 local learning rate = 0.01
round 147 local learning rate = 0.01
round 148 local learning rate = 0.01
round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 90.280% / Loss: 0.3357 / Grad Norm: 0.4505 / Grad Diff: 43.9352 / Time: 17.37s
======================================================================================================

= Test = round: 150 / acc: 91.280% / loss: 0.3121 / Time: 1.42s
======================================================================================================

round 150 local learning rate = 0.01
round 151 local learning rate = 0.01
round 152 local learning rate = 0.01
round 153 local learning rate = 0.01
round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 90.411% / Loss: 0.3287 / Grad Norm: 0.4983 / Grad Diff: 42.8154 / Time: 15.78s
======================================================================================================

= Test = round: 155 / acc: 91.340% / loss: 0.3054 / Time: 1.31s
======================================================================================================

round 155 local learning rate = 0.01
round 156 local learning rate = 0.01
round 157 local learning rate = 0.01
round 158 local learning rate = 0.01
round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 90.727% / Loss: 0.3209 / Grad Norm: 0.4570 / Grad Diff: 41.7146 / Time: 16.97s
======================================================================================================

= Test = round: 160 / acc: 91.530% / loss: 0.2984 / Time: 1.56s
======================================================================================================

round 160 local learning rate = 0.01
round 161 local learning rate = 0.01
round 162 local learning rate = 0.01
round 163 local learning rate = 0.01
round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 90.865% / Loss: 0.3138 / Grad Norm: 0.3701 / Grad Diff: 40.1756 / Time: 18.08s
======================================================================================================

= Test = round: 165 / acc: 91.820% / loss: 0.2918 / Time: 1.43s
======================================================================================================

round 165 local learning rate = 0.01
round 166 local learning rate = 0.01
round 167 local learning rate = 0.01
round 168 local learning rate = 0.01
round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 91.037% / Loss: 0.3085 / Grad Norm: 0.4121 / Grad Diff: 38.7914 / Time: 17.81s
======================================================================================================

= Test = round: 170 / acc: 91.890% / loss: 0.2867 / Time: 1.60s
======================================================================================================

round 170 local learning rate = 0.01
round 171 local learning rate = 0.01
round 172 local learning rate = 0.01
round 173 local learning rate = 0.01
round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 91.157% / Loss: 0.3021 / Grad Norm: 0.4125 / Grad Diff: 37.8903 / Time: 16.28s
======================================================================================================

= Test = round: 175 / acc: 92.060% / loss: 0.2807 / Time: 1.51s
======================================================================================================

round 175 local learning rate = 0.01
round 176 local learning rate = 0.01
round 177 local learning rate = 0.01
round 178 local learning rate = 0.01
round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 91.288% / Loss: 0.2954 / Grad Norm: 0.3918 / Grad Diff: 37.6160 / Time: 16.19s
======================================================================================================

= Test = round: 180 / acc: 92.200% / loss: 0.2745 / Time: 1.57s
======================================================================================================

round 180 local learning rate = 0.01
round 181 local learning rate = 0.01
round 182 local learning rate = 0.01
round 183 local learning rate = 0.01
round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 91.461% / Loss: 0.2904 / Grad Norm: 0.3665 / Grad Diff: 36.1179 / Time: 14.89s
======================================================================================================

= Test = round: 185 / acc: 92.390% / loss: 0.2694 / Time: 1.49s
======================================================================================================

round 185 local learning rate = 0.01
round 186 local learning rate = 0.01
round 187 local learning rate = 0.01
round 188 local learning rate = 0.01
round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 91.583% / Loss: 0.2852 / Grad Norm: 0.3809 / Grad Diff: 35.2063 / Time: 16.37s
======================================================================================================

= Test = round: 190 / acc: 92.570% / loss: 0.2643 / Time: 1.34s
======================================================================================================

round 190 local learning rate = 0.01
round 191 local learning rate = 0.01
round 192 local learning rate = 0.01
round 193 local learning rate = 0.01
round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 91.681% / Loss: 0.2803 / Grad Norm: 0.4476 / Grad Diff: 34.7792 / Time: 14.57s
======================================================================================================

= Test = round: 195 / acc: 92.470% / loss: 0.2596 / Time: 1.16s
======================================================================================================

round 195 local learning rate = 0.01
round 196 local learning rate = 0.01
round 197 local learning rate = 0.01
round 198 local learning rate = 0.01
round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 91.863% / Loss: 0.2749 / Grad Norm: 0.3043 / Grad Diff: 33.4376 / Time: 14.88s
======================================================================================================

= Test = round: 200 / acc: 92.760% / loss: 0.2545 / Time: 1.29s
======================================================================================================

>>> Training model_ft
Epoch: 001, Train_loss: 1.1612, Train_acc: 0.6390, Test_loss: 1.1379, Test_acc: 0.6506
Epoch: 006, Train_loss: 0.9009, Train_acc: 0.7148, Test_loss: 0.8993, Test_acc: 0.7140
Epoch: 011, Train_loss: 0.8425, Train_acc: 0.7320, Test_loss: 0.8525, Test_acc: 0.7339
Epoch: 016, Train_loss: 0.8167, Train_acc: 0.7414, Test_loss: 0.8372, Test_acc: 0.7426
Epoch: 021, Train_loss: 0.7758, Train_acc: 0.7508, Test_loss: 0.8102, Test_acc: 0.7461
Epoch: 026, Train_loss: 0.7582, Train_acc: 0.7574, Test_loss: 0.7953, Test_acc: 0.7524
Epoch: 031, Train_loss: 0.7415, Train_acc: 0.7629, Test_loss: 0.7837, Test_acc: 0.7538
Epoch: 036, Train_loss: 0.7325, Train_acc: 0.7664, Test_loss: 0.7855, Test_acc: 0.7540
Epoch: 041, Train_loss: 0.7238, Train_acc: 0.7666, Test_loss: 0.7843, Test_acc: 0.7532
Epoch: 046, Train_loss: 0.7126, Train_acc: 0.7691, Test_loss: 0.7736, Test_acc: 0.7572
Epoch: 051, Train_loss: 0.7022, Train_acc: 0.7755, Test_loss: 0.7746, Test_acc: 0.7619
Epoch: 056, Train_loss: 0.6990, Train_acc: 0.7756, Test_loss: 0.7739, Test_acc: 0.7585
Epoch: 061, Train_loss: 0.6897, Train_acc: 0.7758, Test_loss: 0.7703, Test_acc: 0.7572
Epoch: 066, Train_loss: 0.6906, Train_acc: 0.7758, Test_loss: 0.7766, Test_acc: 0.7571
Epoch: 071, Train_loss: 0.6814, Train_acc: 0.7786, Test_loss: 0.7715, Test_acc: 0.7596
Epoch: 076, Train_loss: 0.6708, Train_acc: 0.7816, Test_loss: 0.7663, Test_acc: 0.7612
Epoch: 081, Train_loss: 0.6674, Train_acc: 0.7829, Test_loss: 0.7632, Test_acc: 0.7618
Epoch: 086, Train_loss: 0.6711, Train_acc: 0.7809, Test_loss: 0.7722, Test_acc: 0.7605
Epoch: 091, Train_loss: 0.6714, Train_acc: 0.7805, Test_loss: 0.7712, Test_acc: 0.7634
Epoch: 096, Train_loss: 0.6644, Train_acc: 0.7839, Test_loss: 0.7701, Test_acc: 0.7587
Epoch: 101, Train_loss: 0.6628, Train_acc: 0.7843, Test_loss: 0.7805, Test_acc: 0.7579
Epoch: 106, Train_loss: 0.6618, Train_acc: 0.7837, Test_loss: 0.7726, Test_acc: 0.7569
Epoch: 111, Train_loss: 0.6592, Train_acc: 0.7844, Test_loss: 0.7776, Test_acc: 0.7589
Epoch: 116, Train_loss: 0.6499, Train_acc: 0.7880, Test_loss: 0.7631, Test_acc: 0.7618
Epoch: 121, Train_loss: 0.6609, Train_acc: 0.7838, Test_loss: 0.7782, Test_acc: 0.7598
Epoch: 126, Train_loss: 0.6479, Train_acc: 0.7884, Test_loss: 0.7683, Test_acc: 0.7630
Epoch: 131, Train_loss: 0.6580, Train_acc: 0.7846, Test_loss: 0.7830, Test_acc: 0.7567
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230925163918_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230925163918_model_ft.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_ft: [0.6369304635262454, 0.7921391162861646, 0.7568539182896906, 0.7636929230085546]
model_source_only: [2.4910047256417807, 0.4294503482991814, 2.522255707576452, 0.4257304743917342]
fl_test_acc_mean 0.9272
model_source_only_test_acc_mean 0.4257304743917342
model_ft_test_acc_mean 0.7636929230085546
