nohup: ignoring input
working!
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 600
	clients_per_round : 100
	             clip : False
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0001
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 1
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : False
	       reg_J_coef : 0.0
	   reg_J_ind_coef : 0.01
	  reg_J_norm_coef : 0.0001
	           repeat : 1
	     repeat_epoch : 10
	             seed : 0
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
nohup: ignoring input
working!
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 600
	clients_per_round : 100
	             clip : False
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0001
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 1
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : False
	       reg_J_coef : 0.0
	   reg_J_ind_coef : 0.01
	  reg_J_norm_coef : 0.0
	           repeat : 1
	     repeat_epoch : 10
	             seed : 0
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230925164953
FL pretrained model will be saved at ./models/lenet_mnist_20230925164953.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 10.018% / Loss: 2.3066 / Grad Norm: 0.1856 / Grad Diff: 1.4027 / Time: 8.89s
======================================================================================================

= Test = round: 0 / acc: 10.920% / loss: 2.3056 / Time: 1.25s
======================================================================================================

round 0 local learning rate = 0.01
round 1 local learning rate = 0.01
round 2 local learning rate = 0.01
round 3 local learning rate = 0.01
round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 22.100% / Loss: 2.2810 / Grad Norm: 0.2825 / Grad Diff: 3.9390 / Time: 8.96s
======================================================================================================

= Test = round: 5 / acc: 23.520% / loss: 2.2796 / Time: 1.10s
======================================================================================================

round 5 local learning rate = 0.01
round 6 local learning rate = 0.01
round 7 local learning rate = 0.01
round 8 local learning rate = 0.01
round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 39.718% / Loss: 2.1652 / Grad Norm: 0.9839 / Grad Diff: 85.8344 / Time: 9.26s
======================================================================================================

= Test = round: 10 / acc: 39.640% / loss: 2.1624 / Time: 1.14s
======================================================================================================

round 10 local learning rate = 0.01
round 11 local learning rate = 0.01
round 12 local learning rate = 0.01
round 13 local learning rate = 0.01
round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 57.081% / Loss: 2.0196 / Grad Norm: 1.0522 / Grad Diff: 65.7097 / Time: 8.90s
======================================================================================================

= Test = round: 15 / acc: 59.920% / loss: 2.0092 / Time: 1.10s
======================================================================================================

round 15 local learning rate = 0.01
round 16 local learning rate = 0.01
round 17 local learning rate = 0.01
round 18 local learning rate = 0.01
round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 69.555% / Loss: 1.7878 / Grad Norm: 1.3244 / Grad Diff: 64.7145 / Time: 8.58s
======================================================================================================

= Test = round: 20 / acc: 72.380% / loss: 1.7689 / Time: 0.97s
======================================================================================================

round 20 local learning rate = 0.01
round 21 local learning rate = 0.01
round 22 local learning rate = 0.01
round 23 local learning rate = 0.01
round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 73.072% / Loss: 1.4858 / Grad Norm: 1.4229 / Grad Diff: 62.9600 / Time: 8.54s
======================================================================================================

= Test = round: 25 / acc: 75.310% / loss: 1.4584 / Time: 1.02s
======================================================================================================

round 25 local learning rate = 0.01
round 26 local learning rate = 0.01
round 27 local learning rate = 0.01
round 28 local learning rate = 0.01
round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 76.766% / Loss: 1.1960 / Grad Norm: 1.4227 / Grad Diff: 65.2978 / Time: 8.58s
======================================================================================================

= Test = round: 30 / acc: 79.120% / loss: 1.1595 / Time: 0.99s
======================================================================================================

round 30 local learning rate = 0.01
round 31 local learning rate = 0.01
round 32 local learning rate = 0.01
round 33 local learning rate = 0.01
round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 79.109% / Loss: 0.9997 / Grad Norm: 1.3580 / Grad Diff: 58.3654 / Time: 8.76s
======================================================================================================

= Test = round: 35 / acc: 80.720% / loss: 0.9598 / Time: 1.03s
======================================================================================================

round 35 local learning rate = 0.01
round 36 local learning rate = 0.01
round 37 local learning rate = 0.01
round 38 local learning rate = 0.01
round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 80.522% / Loss: 0.8565 / Grad Norm: 1.1981 / Grad Diff: 52.3563 / Time: 8.85s
======================================================================================================

= Test = round: 40 / acc: 82.040% / loss: 0.8139 / Time: 1.05s
======================================================================================================

round 40 local learning rate = 0.01
round 41 local learning rate = 0.01
round 42 local learning rate = 0.01
round 43 local learning rate = 0.01
round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 81.668% / Loss: 0.7674 / Grad Norm: 1.1039 / Grad Diff: 45.3285 / Time: 10.39s
======================================================================================================

= Test = round: 45 / acc: 83.250% / loss: 0.7243 / Time: 1.18s
======================================================================================================

round 45 local learning rate = 0.01
round 46 local learning rate = 0.01
round 47 local learning rate = 0.01
round 48 local learning rate = 0.01
round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 82.614% / Loss: 0.6892 / Grad Norm: 0.9785 / Grad Diff: 42.0392 / Time: 8.39s
======================================================================================================

= Test = round: 50 / acc: 84.100% / loss: 0.6476 / Time: 0.95s
======================================================================================================

round 50 local learning rate = 0.01
round 51 local learning rate = 0.01
round 52 local learning rate = 0.01
round 53 local learning rate = 0.01
round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 83.577% / Loss: 0.6321 / Grad Norm: 0.8960 / Grad Diff: 38.9996 / Time: 8.89s
======================================================================================================

= Test = round: 55 / acc: 84.990% / loss: 0.5921 / Time: 1.29s
======================================================================================================

round 55 local learning rate = 0.01
round 56 local learning rate = 0.01
round 57 local learning rate = 0.01
round 58 local learning rate = 0.01
round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 84.402% / Loss: 0.5869 / Grad Norm: 0.8137 / Grad Diff: 35.9399 / Time: 8.74s
======================================================================================================

= Test = round: 60 / acc: 85.810% / loss: 0.5480 / Time: 0.96s
======================================================================================================

round 60 local learning rate = 0.01
round 61 local learning rate = 0.01
round 62 local learning rate = 0.01
round 63 local learning rate = 0.01
round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 85.258% / Loss: 0.5516 / Grad Norm: 0.7463 / Grad Diff: 33.3353 / Time: 8.77s
======================================================================================================

= Test = round: 65 / acc: 86.580% / loss: 0.5145 / Time: 1.03s
======================================================================================================

round 65 local learning rate = 0.01
round 66 local learning rate = 0.01
round 67 local learning rate = 0.01
round 68 local learning rate = 0.01
round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 85.834% / Loss: 0.5204 / Grad Norm: 0.7070 / Grad Diff: 31.2024 / Time: 9.17s
======================================================================================================

= Test = round: 70 / acc: 87.210% / loss: 0.4844 / Time: 1.04s
======================================================================================================

round 70 local learning rate = 0.01
round 71 local learning rate = 0.01
round 72 local learning rate = 0.01
round 73 local learning rate = 0.01
round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 86.312% / Loss: 0.4965 / Grad Norm: 0.6942 / Grad Diff: 28.8871 / Time: 9.53s
======================================================================================================

= Test = round: 75 / acc: 87.690% / loss: 0.4613 / Time: 1.07s
======================================================================================================

round 75 local learning rate = 0.01
round 76 local learning rate = 0.01
round 77 local learning rate = 0.01
round 78 local learning rate = 0.01
round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 86.657% / Loss: 0.4735 / Grad Norm: 0.7189 / Grad Diff: 27.4391 / Time: 8.95s
======================================================================================================

= Test = round: 80 / acc: 88.070% / loss: 0.4386 / Time: 1.03s
======================================================================================================

round 80 local learning rate = 0.01
round 81 local learning rate = 0.01
round 82 local learning rate = 0.01
round 83 local learning rate = 0.01
round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 87.493% / Loss: 0.4496 / Grad Norm: 0.5967 / Grad Diff: 25.8712 / Time: 9.16s
======================================================================================================

= Test = round: 85 / acc: 88.790% / loss: 0.4163 / Time: 1.07s
======================================================================================================

round 85 local learning rate = 0.01
round 86 local learning rate = 0.01
round 87 local learning rate = 0.01
round 88 local learning rate = 0.01
round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 87.911% / Loss: 0.4310 / Grad Norm: 0.5904 / Grad Diff: 24.4602 / Time: 9.30s
======================================================================================================

= Test = round: 90 / acc: 89.160% / loss: 0.3987 / Time: 1.10s
======================================================================================================

round 90 local learning rate = 0.01
round 91 local learning rate = 0.01
round 92 local learning rate = 0.01
round 93 local learning rate = 0.01
round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 88.452% / Loss: 0.4117 / Grad Norm: 0.5181 / Grad Diff: 23.3131 / Time: 8.88s
======================================================================================================

= Test = round: 95 / acc: 89.690% / loss: 0.3807 / Time: 1.06s
======================================================================================================

round 95 local learning rate = 0.01
round 96 local learning rate = 0.01
round 97 local learning rate = 0.01
round 98 local learning rate = 0.01
round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 88.786% / Loss: 0.3946 / Grad Norm: 0.4938 / Grad Diff: 22.3363 / Time: 9.18s
======================================================================================================

= Test = round: 100 / acc: 90.010% / loss: 0.3645 / Time: 1.15s
======================================================================================================

round 100 local learning rate = 0.01
round 101 local learning rate = 0.01
round 102 local learning rate = 0.01
round 103 local learning rate = 0.01
round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 89.161% / Loss: 0.3807 / Grad Norm: 0.4687 / Grad Diff: 21.0298 / Time: 8.95s
======================================================================================================

= Test = round: 105 / acc: 90.300% / loss: 0.3515 / Time: 1.03s
======================================================================================================

round 105 local learning rate = 0.01
round 106 local learning rate = 0.01
round 107 local learning rate = 0.01
round 108 local learning rate = 0.01
round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 89.509% / Loss: 0.3678 / Grad Norm: 0.4785 / Grad Diff: 20.0559 / Time: 9.04s
======================================================================================================

= Test = round: 110 / acc: 90.550% / loss: 0.3392 / Time: 1.09s
======================================================================================================

round 110 local learning rate = 0.01
round 111 local learning rate = 0.01
round 112 local learning rate = 0.01
round 113 local learning rate = 0.01
round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 89.891% / Loss: 0.3560 / Grad Norm: 0.4543 / Grad Diff: 18.9499 / Time: 9.91s
======================================================================================================

= Test = round: 115 / acc: 90.780% / loss: 0.3281 / Time: 1.05s
======================================================================================================

round 115 local learning rate = 0.01
round 116 local learning rate = 0.01
round 117 local learning rate = 0.01
round 118 local learning rate = 0.01
round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 90.181% / Loss: 0.3442 / Grad Norm: 0.4637 / Grad Diff: 18.2474 / Time: 10.10s
======================================================================================================

= Test = round: 120 / acc: 91.120% / loss: 0.3173 / Time: 0.92s
======================================================================================================

round 120 local learning rate = 0.01
round 121 local learning rate = 0.01
round 122 local learning rate = 0.01
round 123 local learning rate = 0.01
round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 90.539% / Loss: 0.3320 / Grad Norm: 0.4063 / Grad Diff: 17.4276 / Time: 9.31s
======================================================================================================

= Test = round: 125 / acc: 91.290% / loss: 0.3057 / Time: 0.93s
======================================================================================================

round 125 local learning rate = 0.01
round 126 local learning rate = 0.01
round 127 local learning rate = 0.01
round 128 local learning rate = 0.01
round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 90.882% / Loss: 0.3225 / Grad Norm: 0.4058 / Grad Diff: 16.6220 / Time: 9.15s
======================================================================================================

= Test = round: 130 / acc: 91.530% / loss: 0.2971 / Time: 0.87s
======================================================================================================

round 130 local learning rate = 0.01
round 131 local learning rate = 0.01
round 132 local learning rate = 0.01
round 133 local learning rate = 0.01
round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 91.094% / Loss: 0.3116 / Grad Norm: 0.3690 / Grad Diff: 16.1049 / Time: 10.18s
======================================================================================================

= Test = round: 135 / acc: 91.770% / loss: 0.2867 / Time: 0.89s
======================================================================================================

round 135 local learning rate = 0.01
round 136 local learning rate = 0.01
round 137 local learning rate = 0.01
round 138 local learning rate = 0.01
round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 91.349% / Loss: 0.3028 / Grad Norm: 0.3641 / Grad Diff: 15.5120 / Time: 10.07s
======================================================================================================

= Test = round: 140 / acc: 91.940% / loss: 0.2784 / Time: 0.94s
======================================================================================================

round 140 local learning rate = 0.01
round 141 local learning rate = 0.01
round 142 local learning rate = 0.01
round 143 local learning rate = 0.01
round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 91.524% / Loss: 0.2958 / Grad Norm: 0.3896 / Grad Diff: 14.8718 / Time: 9.32s
======================================================================================================

= Test = round: 145 / acc: 92.140% / loss: 0.2718 / Time: 0.88s
======================================================================================================

round 145 local learning rate = 0.01
round 146 local learning rate = 0.01
round 147 local learning rate = 0.01
round 148 local learning rate = 0.01
round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 91.734% / Loss: 0.2888 / Grad Norm: 0.3898 / Grad Diff: 14.2455 / Time: 11.40s
======================================================================================================

= Test = round: 150 / acc: 92.360% / loss: 0.2651 / Time: 0.96s
======================================================================================================

round 150 local learning rate = 0.01
round 151 local learning rate = 0.01
round 152 local learning rate = 0.01
round 153 local learning rate = 0.01
round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 91.952% / Loss: 0.2800 / Grad Norm: 0.3458 / Grad Diff: 13.8253 / Time: 9.91s
======================================================================================================

= Test = round: 155 / acc: 92.570% / loss: 0.2572 / Time: 0.95s
======================================================================================================

round 155 local learning rate = 0.01
round 156 local learning rate = 0.01
round 157 local learning rate = 0.01
round 158 local learning rate = 0.01
round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 92.146% / Loss: 0.2724 / Grad Norm: 0.3295 / Grad Diff: 13.4325 / Time: 9.61s
======================================================================================================

= Test = round: 160 / acc: 92.740% / loss: 0.2500 / Time: 1.04s
======================================================================================================

round 160 local learning rate = 0.01
round 161 local learning rate = 0.01
round 162 local learning rate = 0.01
round 163 local learning rate = 0.01
round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 92.301% / Loss: 0.2659 / Grad Norm: 0.3258 / Grad Diff: 13.0457 / Time: 9.57s
======================================================================================================

= Test = round: 165 / acc: 92.900% / loss: 0.2438 / Time: 1.05s
======================================================================================================

round 165 local learning rate = 0.01
round 166 local learning rate = 0.01
round 167 local learning rate = 0.01
round 168 local learning rate = 0.01
round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 92.459% / Loss: 0.2593 / Grad Norm: 0.3181 / Grad Diff: 12.7089 / Time: 9.75s
======================================================================================================

= Test = round: 170 / acc: 93.120% / loss: 0.2377 / Time: 0.93s
======================================================================================================

round 170 local learning rate = 0.01
round 171 local learning rate = 0.01
round 172 local learning rate = 0.01
round 173 local learning rate = 0.01
round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 92.611% / Loss: 0.2525 / Grad Norm: 0.3198 / Grad Diff: 12.4855 / Time: 9.79s
======================================================================================================

= Test = round: 175 / acc: 93.240% / loss: 0.2312 / Time: 0.94s
======================================================================================================

round 175 local learning rate = 0.01
round 176 local learning rate = 0.01
round 177 local learning rate = 0.01
round 178 local learning rate = 0.01
round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 92.780% / Loss: 0.2471 / Grad Norm: 0.3054 / Grad Diff: 12.0857 / Time: 9.68s
======================================================================================================

= Test = round: 180 / acc: 93.380% / loss: 0.2264 / Time: 0.90s
======================================================================================================

round 180 local learning rate = 0.01
round 181 local learning rate = 0.01
round 182 local learning rate = 0.01
round 183 local learning rate = 0.01
round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 92.928% / Loss: 0.2410 / Grad Norm: 0.3148 / Grad Diff: 11.9315 / Time: 9.58s
======================================================================================================

= Test = round: 185 / acc: 93.540% / loss: 0.2209 / Time: 0.99s
======================================================================================================

round 185 local learning rate = 0.01
round 186 local learning rate = 0.01
round 187 local learning rate = 0.01
round 188 local learning rate = 0.01
round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 93.072% / Loss: 0.2360 / Grad Norm: 0.2953 / Grad Diff: 11.5646 / Time: 8.47s
======================================================================================================

= Test = round: 190 / acc: 93.660% / loss: 0.2162 / Time: 0.90s
======================================================================================================

round 190 local learning rate = 0.01
round 191 local learning rate = 0.01
round 192 local learning rate = 0.01
round 193 local learning rate = 0.01
round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 93.221% / Loss: 0.2308 / Grad Norm: 0.2927 / Grad Diff: 11.3801 / Time: 7.80s
======================================================================================================

= Test = round: 195 / acc: 93.750% / loss: 0.2113 / Time: 0.80s
======================================================================================================

round 195 local learning rate = 0.01
round 196 local learning rate = 0.01
round 197 local learning rate = 0.01
round 198 local learning rate = 0.01
round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 93.332% / Loss: 0.2258 / Grad Norm: 0.2837 / Grad Diff: 11.1499 / Time: 7.88s
======================================================================================================

= Test = round: 200 / acc: 93.780% / loss: 0.2066 / Time: 0.93s
======================================================================================================

>>> Training model_ft
Epoch: 001, Train_loss: 1.0612, Train_acc: 0.6689, Test_loss: 1.0433, Test_acc: 0.6764
Epoch: 006, Train_loss: 0.8605, Train_acc: 0.7260, Test_loss: 0.8561, Test_acc: 0.7354
Epoch: 011, Train_loss: 0.7905, Train_acc: 0.7487, Test_loss: 0.8018, Test_acc: 0.7526
Epoch: 016, Train_loss: 0.7620, Train_acc: 0.7575, Test_loss: 0.7860, Test_acc: 0.7494
Epoch: 021, Train_loss: 0.7252, Train_acc: 0.7663, Test_loss: 0.7622, Test_acc: 0.7611
Epoch: 026, Train_loss: 0.6999, Train_acc: 0.7741, Test_loss: 0.7493, Test_acc: 0.7629
Epoch: 031, Train_loss: 0.6864, Train_acc: 0.7768, Test_loss: 0.7438, Test_acc: 0.7610
Epoch: 036, Train_loss: 0.6701, Train_acc: 0.7809, Test_loss: 0.7327, Test_acc: 0.7656
Epoch: 041, Train_loss: 0.6620, Train_acc: 0.7832, Test_loss: 0.7306, Test_acc: 0.7649
Epoch: 046, Train_loss: 0.6446, Train_acc: 0.7894, Test_loss: 0.7230, Test_acc: 0.7681
Epoch: 051, Train_loss: 0.6395, Train_acc: 0.7908, Test_loss: 0.7301, Test_acc: 0.7676
Epoch: 056, Train_loss: 0.6512, Train_acc: 0.7869, Test_loss: 0.7459, Test_acc: 0.7638
Epoch: 061, Train_loss: 0.6297, Train_acc: 0.7934, Test_loss: 0.7305, Test_acc: 0.7696
Epoch: 066, Train_loss: 0.6209, Train_acc: 0.7956, Test_loss: 0.7234, Test_acc: 0.7712
Epoch: 071, Train_loss: 0.6154, Train_acc: 0.7976, Test_loss: 0.7192, Test_acc: 0.7716
Epoch: 076, Train_loss: 0.6147, Train_acc: 0.7982, Test_loss: 0.7287, Test_acc: 0.7720
Epoch: 081, Train_loss: 0.6118, Train_acc: 0.7988, Test_loss: 0.7281, Test_acc: 0.7690
Epoch: 086, Train_loss: 0.6039, Train_acc: 0.8020, Test_loss: 0.7270, Test_acc: 0.7716
Epoch: 091, Train_loss: 0.6020, Train_acc: 0.8021, Test_loss: 0.7257, Test_acc: 0.7742
Epoch: 096, Train_loss: 0.6041, Train_acc: 0.8005, Test_loss: 0.7240, Test_acc: 0.7729
Epoch: 101, Train_loss: 0.5990, Train_acc: 0.8026, Test_loss: 0.7322, Test_acc: 0.7717
Epoch: 106, Train_loss: 0.5949, Train_acc: 0.8038, Test_loss: 0.7296, Test_acc: 0.7692
Epoch: 111, Train_loss: 0.5864, Train_acc: 0.8077, Test_loss: 0.7220, Test_acc: 0.7749
Epoch: 116, Train_loss: 0.5929, Train_acc: 0.8041, Test_loss: 0.7267, Test_acc: 0.7719
Epoch: 121, Train_loss: 0.5862, Train_acc: 0.8064, Test_loss: 0.7273, Test_acc: 0.7716
Epoch: 126, Train_loss: 0.5897, Train_acc: 0.8055, Test_loss: 0.7282, Test_acc: 0.7704
Epoch: 131, Train_loss: 0.5913, Train_acc: 0.8036, Test_loss: 0.7405, Test_acc: 0.7649
Epoch: 136, Train_loss: 0.5908, Train_acc: 0.8054, Test_loss: 0.7424, Test_acc: 0.7710
Epoch: 141, Train_loss: 0.5876, Train_acc: 0.8067, Test_loss: 0.7359, Test_acc: 0.7704
Epoch: 146, Train_loss: 0.5831, Train_acc: 0.8064, Test_loss: 0.7358, Test_acc: 0.7704
Epoch: 151, Train_loss: 0.5783, Train_acc: 0.8078, Test_loss: 0.7318, Test_acc: 0.7694
Epoch: 156, Train_loss: 0.5709, Train_acc: 0.8108, Test_loss: 0.7288, Test_acc: 0.7699
Epoch: 161, Train_loss: 0.5723, Train_acc: 0.8112, Test_loss: 0.7314, Test_acc: 0.7711
Epoch: 166, Train_loss: 0.5782, Train_acc: 0.8083, Test_loss: 0.7358, Test_acc: 0.7689
Epoch: 171, Train_loss: 0.5744, Train_acc: 0.8100, Test_loss: 0.7407, Test_acc: 0.7702
Epoch: 176, Train_loss: 0.5735, Train_acc: 0.8097, Test_loss: 0.7406, Test_acc: 0.7721
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230925164953_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230925164953_model_ft.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_ft: [0.56646416518329, 0.8118506465992101, 0.7282134094194311, 0.7726919231196534]
model_source_only: [1.9624922547941925, 0.4627040219657294, 1.9760957905324668, 0.46550383290745473]
fl_test_acc_mean 0.9381
model_source_only_test_acc_mean 0.46550383290745473
model_ft_test_acc_mean 0.7726919231196534
