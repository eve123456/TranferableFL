nohup: ignoring input
working!
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 600
	clients_per_round : 100
	             clip : False
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0001
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 1
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : False
	       reg_J_coef : 0.0
	   reg_J_ind_coef : 0.0
	  reg_J_norm_coef : 0.01
	           repeat : 1
	     repeat_epoch : 10
	             seed : 0
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230925165026
FL pretrained model will be saved at ./models/lenet_mnist_20230925165026.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 8.402% / Loss: 2.3077 / Grad Norm: 0.1865 / Grad Diff: 1.3222 / Time: 8.52s
======================================================================================================

= Test = round: 0 / acc: 8.560% / loss: 2.3053 / Time: 1.01s
======================================================================================================

round 0 local learning rate = 0.01
round 1 local learning rate = 0.01
round 2 local learning rate = 0.01
round 3 local learning rate = 0.01
round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 10.446% / Loss: 2.2827 / Grad Norm: 0.2876 / Grad Diff: 4.9116 / Time: 9.14s
======================================================================================================

= Test = round: 5 / acc: 10.360% / loss: 2.2792 / Time: 1.07s
======================================================================================================

round 5 local learning rate = 0.01
round 6 local learning rate = 0.01
round 7 local learning rate = 0.01
round 8 local learning rate = 0.01
round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 34.301% / Loss: 2.1766 / Grad Norm: 0.9941 / Grad Diff: 89.7829 / Time: 8.88s
======================================================================================================

= Test = round: 10 / acc: 36.230% / loss: 2.1687 / Time: 1.08s
======================================================================================================

round 10 local learning rate = 0.01
round 11 local learning rate = 0.01
round 12 local learning rate = 0.01
round 13 local learning rate = 0.01
round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 61.251% / Loss: 2.0315 / Grad Norm: 0.8820 / Grad Diff: 72.9681 / Time: 8.92s
======================================================================================================

= Test = round: 15 / acc: 63.920% / loss: 2.0176 / Time: 1.02s
======================================================================================================

round 15 local learning rate = 0.01
round 16 local learning rate = 0.01
round 17 local learning rate = 0.01
round 18 local learning rate = 0.01
round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 68.494% / Loss: 1.7771 / Grad Norm: 1.1864 / Grad Diff: 109.9721 / Time: 8.75s
======================================================================================================

= Test = round: 20 / acc: 70.660% / loss: 1.7518 / Time: 1.12s
======================================================================================================

round 20 local learning rate = 0.01
round 21 local learning rate = 0.01
round 22 local learning rate = 0.01
round 23 local learning rate = 0.01
round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 72.220% / Loss: 1.5452 / Grad Norm: 1.3514 / Grad Diff: 78.0725 / Time: 8.41s
======================================================================================================

= Test = round: 25 / acc: 73.970% / loss: 1.5096 / Time: 0.97s
======================================================================================================

round 25 local learning rate = 0.01
round 26 local learning rate = 0.01
round 27 local learning rate = 0.01
round 28 local learning rate = 0.01
round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 75.253% / Loss: 1.2770 / Grad Norm: 1.3878 / Grad Diff: 76.0559 / Time: 8.87s
======================================================================================================

= Test = round: 30 / acc: 77.150% / loss: 1.2355 / Time: 0.98s
======================================================================================================

round 30 local learning rate = 0.01
round 31 local learning rate = 0.01
round 32 local learning rate = 0.01
round 33 local learning rate = 0.01
round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 77.498% / Loss: 1.0656 / Grad Norm: 1.3359 / Grad Diff: 68.0797 / Time: 9.04s
======================================================================================================

= Test = round: 35 / acc: 79.360% / loss: 1.0229 / Time: 1.13s
======================================================================================================

round 35 local learning rate = 0.01
round 36 local learning rate = 0.01
round 37 local learning rate = 0.01
round 38 local learning rate = 0.01
round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 79.482% / Loss: 0.9164 / Grad Norm: 1.2015 / Grad Diff: 58.6323 / Time: 8.85s
======================================================================================================

= Test = round: 40 / acc: 81.060% / loss: 0.8760 / Time: 1.11s
======================================================================================================

round 40 local learning rate = 0.01
round 41 local learning rate = 0.01
round 42 local learning rate = 0.01
round 43 local learning rate = 0.01
round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 80.644% / Loss: 0.8068 / Grad Norm: 1.0779 / Grad Diff: 51.8003 / Time: 8.63s
======================================================================================================

= Test = round: 45 / acc: 82.100% / loss: 0.7688 / Time: 1.01s
======================================================================================================

round 45 local learning rate = 0.01
round 46 local learning rate = 0.01
round 47 local learning rate = 0.01
round 48 local learning rate = 0.01
round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 81.607% / Loss: 0.7288 / Grad Norm: 0.9730 / Grad Diff: 46.8253 / Time: 8.75s
======================================================================================================

= Test = round: 50 / acc: 83.060% / loss: 0.6925 / Time: 0.98s
======================================================================================================

round 50 local learning rate = 0.01
round 51 local learning rate = 0.01
round 52 local learning rate = 0.01
round 53 local learning rate = 0.01
round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 82.489% / Loss: 0.6685 / Grad Norm: 0.8798 / Grad Diff: 43.2332 / Time: 9.17s
======================================================================================================

= Test = round: 55 / acc: 83.690% / loss: 0.6339 / Time: 1.09s
======================================================================================================

round 55 local learning rate = 0.01
round 56 local learning rate = 0.01
round 57 local learning rate = 0.01
round 58 local learning rate = 0.01
round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 83.255% / Loss: 0.6190 / Grad Norm: 0.8115 / Grad Diff: 40.9598 / Time: 8.68s
======================================================================================================

= Test = round: 60 / acc: 84.530% / loss: 0.5850 / Time: 1.04s
======================================================================================================

round 60 local learning rate = 0.01
round 61 local learning rate = 0.01
round 62 local learning rate = 0.01
round 63 local learning rate = 0.01
round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 84.026% / Loss: 0.5815 / Grad Norm: 0.7344 / Grad Diff: 38.3511 / Time: 9.15s
======================================================================================================

= Test = round: 65 / acc: 85.440% / loss: 0.5476 / Time: 1.08s
======================================================================================================

round 65 local learning rate = 0.01
round 66 local learning rate = 0.01
round 67 local learning rate = 0.01
round 68 local learning rate = 0.01
round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 84.871% / Loss: 0.5438 / Grad Norm: 0.6308 / Grad Diff: 37.4001 / Time: 9.04s
======================================================================================================

= Test = round: 70 / acc: 86.200% / loss: 0.5103 / Time: 1.01s
======================================================================================================

round 70 local learning rate = 0.01
round 71 local learning rate = 0.01
round 72 local learning rate = 0.01
round 73 local learning rate = 0.01
round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 85.461% / Loss: 0.5236 / Grad Norm: 0.6215 / Grad Diff: 33.9632 / Time: 9.04s
======================================================================================================

= Test = round: 75 / acc: 86.990% / loss: 0.4902 / Time: 1.07s
======================================================================================================

round 75 local learning rate = 0.01
round 76 local learning rate = 0.01
round 77 local learning rate = 0.01
round 78 local learning rate = 0.01
round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 85.893% / Loss: 0.5047 / Grad Norm: 0.6525 / Grad Diff: 31.3696 / Time: 8.74s
======================================================================================================

= Test = round: 80 / acc: 87.430% / loss: 0.4710 / Time: 1.06s
======================================================================================================

round 80 local learning rate = 0.01
round 81 local learning rate = 0.01
round 82 local learning rate = 0.01
round 83 local learning rate = 0.01
round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 86.397% / Loss: 0.4834 / Grad Norm: 0.6261 / Grad Diff: 29.7008 / Time: 8.79s
======================================================================================================

= Test = round: 85 / acc: 87.840% / loss: 0.4499 / Time: 1.07s
======================================================================================================

round 85 local learning rate = 0.01
round 86 local learning rate = 0.01
round 87 local learning rate = 0.01
round 88 local learning rate = 0.01
round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 86.827% / Loss: 0.4643 / Grad Norm: 0.6077 / Grad Diff: 28.1668 / Time: 8.95s
======================================================================================================

= Test = round: 90 / acc: 88.220% / loss: 0.4313 / Time: 0.99s
======================================================================================================

round 90 local learning rate = 0.01
round 91 local learning rate = 0.01
round 92 local learning rate = 0.01
round 93 local learning rate = 0.01
round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 87.415% / Loss: 0.4445 / Grad Norm: 0.5183 / Grad Diff: 26.8169 / Time: 9.13s
======================================================================================================

= Test = round: 95 / acc: 88.710% / loss: 0.4121 / Time: 0.93s
======================================================================================================

round 95 local learning rate = 0.01
round 96 local learning rate = 0.01
round 97 local learning rate = 0.01
round 98 local learning rate = 0.01
round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 87.827% / Loss: 0.4300 / Grad Norm: 0.5315 / Grad Diff: 25.3149 / Time: 8.98s
======================================================================================================

= Test = round: 100 / acc: 89.070% / loss: 0.3982 / Time: 1.14s
======================================================================================================

round 100 local learning rate = 0.01
round 101 local learning rate = 0.01
round 102 local learning rate = 0.01
round 103 local learning rate = 0.01
round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 88.216% / Loss: 0.4137 / Grad Norm: 0.4865 / Grad Diff: 24.3956 / Time: 9.16s
======================================================================================================

= Test = round: 105 / acc: 89.450% / loss: 0.3826 / Time: 1.11s
======================================================================================================

round 105 local learning rate = 0.01
round 106 local learning rate = 0.01
round 107 local learning rate = 0.01
round 108 local learning rate = 0.01
round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 88.592% / Loss: 0.3998 / Grad Norm: 0.4566 / Grad Diff: 23.3092 / Time: 9.03s
======================================================================================================

= Test = round: 110 / acc: 89.810% / loss: 0.3694 / Time: 1.12s
======================================================================================================

round 110 local learning rate = 0.01
round 111 local learning rate = 0.01
round 112 local learning rate = 0.01
round 113 local learning rate = 0.01
round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 88.923% / Loss: 0.3868 / Grad Norm: 0.4542 / Grad Diff: 22.4784 / Time: 10.82s
======================================================================================================

= Test = round: 115 / acc: 90.140% / loss: 0.3572 / Time: 1.04s
======================================================================================================

round 115 local learning rate = 0.01
round 116 local learning rate = 0.01
round 117 local learning rate = 0.01
round 118 local learning rate = 0.01
round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 89.227% / Loss: 0.3751 / Grad Norm: 0.4386 / Grad Diff: 21.5560 / Time: 10.00s
======================================================================================================

= Test = round: 120 / acc: 90.400% / loss: 0.3462 / Time: 1.10s
======================================================================================================

round 120 local learning rate = 0.01
round 121 local learning rate = 0.01
round 122 local learning rate = 0.01
round 123 local learning rate = 0.01
round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 89.465% / Loss: 0.3650 / Grad Norm: 0.4714 / Grad Diff: 20.8028 / Time: 9.77s
======================================================================================================

= Test = round: 125 / acc: 90.550% / loss: 0.3369 / Time: 0.98s
======================================================================================================

round 125 local learning rate = 0.01
round 126 local learning rate = 0.01
round 127 local learning rate = 0.01
round 128 local learning rate = 0.01
round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 89.790% / Loss: 0.3530 / Grad Norm: 0.4283 / Grad Diff: 20.0216 / Time: 9.88s
======================================================================================================

= Test = round: 130 / acc: 90.790% / loss: 0.3250 / Time: 0.95s
======================================================================================================

round 130 local learning rate = 0.01
round 131 local learning rate = 0.01
round 132 local learning rate = 0.01
round 133 local learning rate = 0.01
round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 90.153% / Loss: 0.3417 / Grad Norm: 0.3700 / Grad Diff: 19.5286 / Time: 10.30s
======================================================================================================

= Test = round: 135 / acc: 91.090% / loss: 0.3144 / Time: 0.96s
======================================================================================================

round 135 local learning rate = 0.01
round 136 local learning rate = 0.01
round 137 local learning rate = 0.01
round 138 local learning rate = 0.01
round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 90.292% / Loss: 0.3340 / Grad Norm: 0.4298 / Grad Diff: 18.7789 / Time: 10.25s
======================================================================================================

= Test = round: 140 / acc: 91.310% / loss: 0.3072 / Time: 0.99s
======================================================================================================

round 140 local learning rate = 0.01
round 141 local learning rate = 0.01
round 142 local learning rate = 0.01
round 143 local learning rate = 0.01
round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 90.592% / Loss: 0.3241 / Grad Norm: 0.3766 / Grad Diff: 18.2571 / Time: 10.72s
======================================================================================================

= Test = round: 145 / acc: 91.490% / loss: 0.2978 / Time: 0.96s
======================================================================================================

round 145 local learning rate = 0.01
round 146 local learning rate = 0.01
round 147 local learning rate = 0.01
round 148 local learning rate = 0.01
round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 90.808% / Loss: 0.3163 / Grad Norm: 0.3893 / Grad Diff: 17.6442 / Time: 9.67s
======================================================================================================

= Test = round: 150 / acc: 91.710% / loss: 0.2905 / Time: 0.92s
======================================================================================================

round 150 local learning rate = 0.01
round 151 local learning rate = 0.01
round 152 local learning rate = 0.01
round 153 local learning rate = 0.01
round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 91.044% / Loss: 0.3080 / Grad Norm: 0.3356 / Grad Diff: 17.0955 / Time: 9.46s
======================================================================================================

= Test = round: 155 / acc: 91.880% / loss: 0.2828 / Time: 1.35s
======================================================================================================

round 155 local learning rate = 0.01
round 156 local learning rate = 0.01
round 157 local learning rate = 0.01
round 158 local learning rate = 0.01
round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 91.260% / Loss: 0.3017 / Grad Norm: 0.3579 / Grad Diff: 16.5035 / Time: 10.94s
======================================================================================================

= Test = round: 160 / acc: 92.100% / loss: 0.2769 / Time: 0.99s
======================================================================================================

round 160 local learning rate = 0.01
round 161 local learning rate = 0.01
round 162 local learning rate = 0.01
round 163 local learning rate = 0.01
round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 91.472% / Loss: 0.2941 / Grad Norm: 0.3196 / Grad Diff: 16.0721 / Time: 9.72s
======================================================================================================

= Test = round: 165 / acc: 92.390% / loss: 0.2698 / Time: 1.26s
======================================================================================================

round 165 local learning rate = 0.01
round 166 local learning rate = 0.01
round 167 local learning rate = 0.01
round 168 local learning rate = 0.01
round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 91.661% / Loss: 0.2877 / Grad Norm: 0.3287 / Grad Diff: 15.6155 / Time: 9.88s
======================================================================================================

= Test = round: 170 / acc: 92.450% / loss: 0.2639 / Time: 0.89s
======================================================================================================

round 170 local learning rate = 0.01
round 171 local learning rate = 0.01
round 172 local learning rate = 0.01
round 173 local learning rate = 0.01
round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 91.838% / Loss: 0.2811 / Grad Norm: 0.2962 / Grad Diff: 15.1861 / Time: 10.27s
======================================================================================================

= Test = round: 175 / acc: 92.570% / loss: 0.2577 / Time: 0.92s
======================================================================================================

round 175 local learning rate = 0.01
round 176 local learning rate = 0.01
round 177 local learning rate = 0.01
round 178 local learning rate = 0.01
round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 92.004% / Loss: 0.2763 / Grad Norm: 0.3178 / Grad Diff: 14.5924 / Time: 9.56s
======================================================================================================

= Test = round: 180 / acc: 92.700% / loss: 0.2535 / Time: 1.22s
======================================================================================================

round 180 local learning rate = 0.01
round 181 local learning rate = 0.01
round 182 local learning rate = 0.01
round 183 local learning rate = 0.01
round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 92.175% / Loss: 0.2702 / Grad Norm: 0.3150 / Grad Diff: 14.2878 / Time: 9.64s
======================================================================================================

= Test = round: 185 / acc: 92.810% / loss: 0.2476 / Time: 0.88s
======================================================================================================

round 185 local learning rate = 0.01
round 186 local learning rate = 0.01
round 187 local learning rate = 0.01
round 188 local learning rate = 0.01
round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 92.363% / Loss: 0.2649 / Grad Norm: 0.3026 / Grad Diff: 13.8728 / Time: 8.33s
======================================================================================================

= Test = round: 190 / acc: 92.980% / loss: 0.2431 / Time: 0.81s
======================================================================================================

round 190 local learning rate = 0.01
round 191 local learning rate = 0.01
round 192 local learning rate = 0.01
round 193 local learning rate = 0.01
round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 92.524% / Loss: 0.2590 / Grad Norm: 0.2845 / Grad Diff: 13.6017 / Time: 7.78s
======================================================================================================

= Test = round: 195 / acc: 93.180% / loss: 0.2372 / Time: 0.80s
======================================================================================================

round 195 local learning rate = 0.01
round 196 local learning rate = 0.01
round 197 local learning rate = 0.01
round 198 local learning rate = 0.01
round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 92.614% / Loss: 0.2534 / Grad Norm: 0.3421 / Grad Diff: 13.6112 / Time: 8.22s
======================================================================================================

= Test = round: 200 / acc: 93.190% / loss: 0.2321 / Time: 0.78s
======================================================================================================

>>> Training model_ft
Epoch: 001, Train_loss: 1.0935, Train_acc: 0.6663, Test_loss: 1.0744, Test_acc: 0.6733
Epoch: 006, Train_loss: 0.8713, Train_acc: 0.7275, Test_loss: 0.8765, Test_acc: 0.7283
Epoch: 011, Train_loss: 0.8055, Train_acc: 0.7462, Test_loss: 0.8246, Test_acc: 0.7436
Epoch: 016, Train_loss: 0.7732, Train_acc: 0.7558, Test_loss: 0.7984, Test_acc: 0.7502
Epoch: 021, Train_loss: 0.7418, Train_acc: 0.7623, Test_loss: 0.7842, Test_acc: 0.7512
Epoch: 026, Train_loss: 0.7279, Train_acc: 0.7661, Test_loss: 0.7755, Test_acc: 0.7522
Epoch: 031, Train_loss: 0.7091, Train_acc: 0.7704, Test_loss: 0.7673, Test_acc: 0.7549
Epoch: 036, Train_loss: 0.7100, Train_acc: 0.7704, Test_loss: 0.7806, Test_acc: 0.7522
Epoch: 041, Train_loss: 0.6819, Train_acc: 0.7789, Test_loss: 0.7561, Test_acc: 0.7608
Epoch: 046, Train_loss: 0.6670, Train_acc: 0.7830, Test_loss: 0.7460, Test_acc: 0.7617
Epoch: 051, Train_loss: 0.6621, Train_acc: 0.7849, Test_loss: 0.7518, Test_acc: 0.7586
Epoch: 056, Train_loss: 0.6683, Train_acc: 0.7820, Test_loss: 0.7663, Test_acc: 0.7538
Epoch: 061, Train_loss: 0.6536, Train_acc: 0.7867, Test_loss: 0.7569, Test_acc: 0.7617
Epoch: 066, Train_loss: 0.6478, Train_acc: 0.7887, Test_loss: 0.7498, Test_acc: 0.7611
Epoch: 071, Train_loss: 0.6409, Train_acc: 0.7906, Test_loss: 0.7458, Test_acc: 0.7626
Epoch: 076, Train_loss: 0.6385, Train_acc: 0.7909, Test_loss: 0.7629, Test_acc: 0.7556
Epoch: 081, Train_loss: 0.6313, Train_acc: 0.7925, Test_loss: 0.7531, Test_acc: 0.7632
Epoch: 086, Train_loss: 0.6333, Train_acc: 0.7919, Test_loss: 0.7566, Test_acc: 0.7576
Epoch: 091, Train_loss: 0.6209, Train_acc: 0.7974, Test_loss: 0.7431, Test_acc: 0.7675
Epoch: 096, Train_loss: 0.6185, Train_acc: 0.7971, Test_loss: 0.7471, Test_acc: 0.7592
Epoch: 101, Train_loss: 0.6169, Train_acc: 0.7983, Test_loss: 0.7479, Test_acc: 0.7616
Epoch: 106, Train_loss: 0.6164, Train_acc: 0.7976, Test_loss: 0.7484, Test_acc: 0.7631
Epoch: 111, Train_loss: 0.6129, Train_acc: 0.7974, Test_loss: 0.7545, Test_acc: 0.7616
Epoch: 116, Train_loss: 0.6234, Train_acc: 0.7954, Test_loss: 0.7618, Test_acc: 0.7604
Epoch: 121, Train_loss: 0.6085, Train_acc: 0.8006, Test_loss: 0.7487, Test_acc: 0.7625
Epoch: 126, Train_loss: 0.6056, Train_acc: 0.8017, Test_loss: 0.7516, Test_acc: 0.7596
Epoch: 131, Train_loss: 0.6105, Train_acc: 0.7996, Test_loss: 0.7629, Test_acc: 0.7601
Epoch: 136, Train_loss: 0.6047, Train_acc: 0.8010, Test_loss: 0.7614, Test_acc: 0.7628
Epoch: 141, Train_loss: 0.6074, Train_acc: 0.8004, Test_loss: 0.7555, Test_acc: 0.7639
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230925165026_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230925165026_model_ft.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_ft: [0.5950348270163491, 0.8051558448161895, 0.7484440823128959, 0.7640262193089656]
model_source_only: [2.0432263730964433, 0.45251775393637395, 2.06049070275104, 0.45172758582379735]
fl_test_acc_mean 0.9319
model_source_only_test_acc_mean 0.45172758582379735
model_ft_test_acc_mean 0.7640262193089656
