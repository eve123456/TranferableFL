nohup: ignoring input
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 64
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.01
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 10
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : True
	       reg_J_coef : 0.01
	           repeat : 1
	             seed : 0
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230919165428
FL pretrained model will be saved at ./models/lenet_mnist_20230919165428.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 13.764% / Loss: 2.3020 / Grad Norm: 0.1476 / Grad Diff: 1.1384 / Time: 9.52s
======================================================================================================

= Test = round: 0 / acc: 13.000% / loss: 2.3010 / Time: 0.78s
======================================================================================================

round 0 local learning rate = 0.01
round 1 local learning rate = 0.01
round 2 local learning rate = 0.01
round 3 local learning rate = 0.01
round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 16.227% / Loss: 2.2842 / Grad Norm: 0.2110 / Grad Diff: 3.0137 / Time: 8.88s
======================================================================================================

= Test = round: 5 / acc: 15.380% / loss: 2.2833 / Time: 0.78s
======================================================================================================

round 5 local learning rate = 0.01
round 6 local learning rate = 0.01
round 7 local learning rate = 0.01
round 8 local learning rate = 0.01
round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 23.491% / Loss: 2.1789 / Grad Norm: 1.1087 / Grad Diff: 111.0316 / Time: 8.93s
======================================================================================================

= Test = round: 10 / acc: 22.320% / loss: 2.1783 / Time: 0.77s
======================================================================================================

round 10 local learning rate = 0.01
round 11 local learning rate = 0.01
round 12 local learning rate = 0.01
round 13 local learning rate = 0.01
round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 58.768% / Loss: 1.9473 / Grad Norm: 1.2655 / Grad Diff: 189.9679 / Time: 9.00s
======================================================================================================

= Test = round: 15 / acc: 60.990% / loss: 1.9385 / Time: 0.78s
======================================================================================================

round 15 local learning rate = 0.01
round 16 local learning rate = 0.01
round 17 local learning rate = 0.01
round 18 local learning rate = 0.01
round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 67.895% / Loss: 1.6708 / Grad Norm: 1.4434 / Grad Diff: 189.3866 / Time: 8.96s
======================================================================================================

= Test = round: 20 / acc: 70.220% / loss: 1.6508 / Time: 0.77s
======================================================================================================

round 20 local learning rate = 0.01
round 21 local learning rate = 0.01
round 22 local learning rate = 0.01
round 23 local learning rate = 0.01
round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 70.319% / Loss: 1.3892 / Grad Norm: 1.5353 / Grad Diff: 182.9380 / Time: 9.03s
======================================================================================================

= Test = round: 25 / acc: 72.640% / loss: 1.3593 / Time: 0.76s
======================================================================================================

round 25 local learning rate = 0.01
round 26 local learning rate = 0.01
round 27 local learning rate = 0.01
round 28 local learning rate = 0.01
round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 73.518% / Loss: 1.1582 / Grad Norm: 1.4075 / Grad Diff: 168.2390 / Time: 8.89s
======================================================================================================

= Test = round: 30 / acc: 75.560% / loss: 1.1221 / Time: 0.78s
======================================================================================================

round 30 local learning rate = 0.01
round 31 local learning rate = 0.01
round 32 local learning rate = 0.01
round 33 local learning rate = 0.01
round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 75.472% / Loss: 0.9948 / Grad Norm: 1.4180 / Grad Diff: 146.0094 / Time: 9.03s
======================================================================================================

= Test = round: 35 / acc: 77.340% / loss: 0.9570 / Time: 0.76s
======================================================================================================

round 35 local learning rate = 0.01
round 36 local learning rate = 0.01
round 37 local learning rate = 0.01
round 38 local learning rate = 0.01
round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 77.371% / Loss: 0.8696 / Grad Norm: 1.2473 / Grad Diff: 131.7571 / Time: 9.04s
======================================================================================================

= Test = round: 40 / acc: 79.200% / loss: 0.8325 / Time: 0.82s
======================================================================================================

round 40 local learning rate = 0.01
round 41 local learning rate = 0.01
round 42 local learning rate = 0.01
round 43 local learning rate = 0.01
round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 79.000% / Loss: 0.7833 / Grad Norm: 1.1049 / Grad Diff: 118.4204 / Time: 8.92s
======================================================================================================

= Test = round: 45 / acc: 80.630% / loss: 0.7464 / Time: 0.79s
======================================================================================================

round 45 local learning rate = 0.01
round 46 local learning rate = 0.01
round 47 local learning rate = 0.01
round 48 local learning rate = 0.01
round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 80.185% / Loss: 0.7171 / Grad Norm: 1.0401 / Grad Diff: 109.9616 / Time: 8.15s
======================================================================================================

= Test = round: 50 / acc: 81.550% / loss: 0.6812 / Time: 0.77s
======================================================================================================

round 50 local learning rate = 0.01
round 51 local learning rate = 0.01
round 52 local learning rate = 0.01
round 53 local learning rate = 0.01
round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 81.384% / Loss: 0.6647 / Grad Norm: 0.8692 / Grad Diff: 103.4114 / Time: 8.98s
======================================================================================================

= Test = round: 55 / acc: 82.570% / loss: 0.6293 / Time: 0.77s
======================================================================================================

round 55 local learning rate = 0.01
round 56 local learning rate = 0.01
round 57 local learning rate = 0.01
round 58 local learning rate = 0.01
round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 82.231% / Loss: 0.6253 / Grad Norm: 0.8422 / Grad Diff: 97.0876 / Time: 12.18s
======================================================================================================

= Test = round: 60 / acc: 83.370% / loss: 0.5897 / Time: 1.08s
======================================================================================================

round 60 local learning rate = 0.01
round 61 local learning rate = 0.01
round 62 local learning rate = 0.01
round 63 local learning rate = 0.01
round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 83.048% / Loss: 0.5927 / Grad Norm: 0.7192 / Grad Diff: 90.8911 / Time: 8.94s
======================================================================================================

= Test = round: 65 / acc: 84.200% / loss: 0.5580 / Time: 0.78s
======================================================================================================

round 65 local learning rate = 0.01
round 66 local learning rate = 0.01
round 67 local learning rate = 0.01
round 68 local learning rate = 0.01
round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 83.568% / Loss: 0.5648 / Grad Norm: 0.7489 / Grad Diff: 87.8736 / Time: 8.90s
======================================================================================================

= Test = round: 70 / acc: 84.880% / loss: 0.5297 / Time: 0.77s
======================================================================================================

round 70 local learning rate = 0.01
round 71 local learning rate = 0.01
round 72 local learning rate = 0.01
round 73 local learning rate = 0.01
round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 84.216% / Loss: 0.5425 / Grad Norm: 0.7157 / Grad Diff: 82.4425 / Time: 11.82s
======================================================================================================

= Test = round: 75 / acc: 85.300% / loss: 0.5078 / Time: 0.77s
======================================================================================================

round 75 local learning rate = 0.01
round 76 local learning rate = 0.01
round 77 local learning rate = 0.01
round 78 local learning rate = 0.01
round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 84.747% / Loss: 0.5217 / Grad Norm: 0.7125 / Grad Diff: 78.8938 / Time: 9.03s
======================================================================================================

= Test = round: 80 / acc: 85.940% / loss: 0.4877 / Time: 0.77s
======================================================================================================

round 80 local learning rate = 0.01
round 81 local learning rate = 0.01
round 82 local learning rate = 0.01
round 83 local learning rate = 0.01
round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 85.299% / Loss: 0.5024 / Grad Norm: 0.6389 / Grad Diff: 75.6223 / Time: 8.96s
======================================================================================================

= Test = round: 85 / acc: 86.460% / loss: 0.4686 / Time: 0.79s
======================================================================================================

round 85 local learning rate = 0.01
round 86 local learning rate = 0.01
round 87 local learning rate = 0.01
round 88 local learning rate = 0.01
round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 85.845% / Loss: 0.4864 / Grad Norm: 0.6488 / Grad Diff: 71.9891 / Time: 8.89s
======================================================================================================

= Test = round: 90 / acc: 86.970% / loss: 0.4520 / Time: 0.76s
======================================================================================================

round 90 local learning rate = 0.01
round 91 local learning rate = 0.01
round 92 local learning rate = 0.01
round 93 local learning rate = 0.01
round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 86.229% / Loss: 0.4700 / Grad Norm: 0.5835 / Grad Diff: 69.5027 / Time: 8.91s
======================================================================================================

= Test = round: 95 / acc: 87.410% / loss: 0.4364 / Time: 0.77s
======================================================================================================

round 95 local learning rate = 0.01
round 96 local learning rate = 0.01
round 97 local learning rate = 0.01
round 98 local learning rate = 0.01
round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 86.692% / Loss: 0.4570 / Grad Norm: 0.6257 / Grad Diff: 66.3067 / Time: 8.93s
======================================================================================================

= Test = round: 100 / acc: 87.850% / loss: 0.4241 / Time: 0.79s
======================================================================================================

round 100 local learning rate = 0.01
round 101 local learning rate = 0.01
round 102 local learning rate = 0.01
round 103 local learning rate = 0.01
round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 87.096% / Loss: 0.4416 / Grad Norm: 0.5478 / Grad Diff: 64.6212 / Time: 8.91s
======================================================================================================

= Test = round: 105 / acc: 88.250% / loss: 0.4087 / Time: 0.77s
======================================================================================================

round 105 local learning rate = 0.01
round 106 local learning rate = 0.01
round 107 local learning rate = 0.01
round 108 local learning rate = 0.01
round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 87.480% / Loss: 0.4286 / Grad Norm: 0.4882 / Grad Diff: 61.7150 / Time: 8.97s
======================================================================================================

= Test = round: 110 / acc: 88.630% / loss: 0.3963 / Time: 0.76s
======================================================================================================

round 110 local learning rate = 0.01
round 111 local learning rate = 0.01
round 112 local learning rate = 0.01
round 113 local learning rate = 0.01
round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 87.799% / Loss: 0.4168 / Grad Norm: 0.4525 / Grad Diff: 59.2873 / Time: 8.21s
======================================================================================================

= Test = round: 115 / acc: 88.940% / loss: 0.3855 / Time: 0.78s
======================================================================================================

round 115 local learning rate = 0.01
round 116 local learning rate = 0.01
round 117 local learning rate = 0.01
round 118 local learning rate = 0.01
round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 88.096% / Loss: 0.4062 / Grad Norm: 0.5150 / Grad Diff: 57.3497 / Time: 9.35s
======================================================================================================

= Test = round: 120 / acc: 89.340% / loss: 0.3748 / Time: 0.77s
======================================================================================================

round 120 local learning rate = 0.01
round 121 local learning rate = 0.01
round 122 local learning rate = 0.01
round 123 local learning rate = 0.01
round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 88.450% / Loss: 0.3948 / Grad Norm: 0.4277 / Grad Diff: 55.7356 / Time: 8.90s
======================================================================================================

= Test = round: 125 / acc: 89.590% / loss: 0.3637 / Time: 0.77s
======================================================================================================

round 125 local learning rate = 0.01
round 126 local learning rate = 0.01
round 127 local learning rate = 0.01
round 128 local learning rate = 0.01
round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 88.773% / Loss: 0.3845 / Grad Norm: 0.4048 / Grad Diff: 53.9218 / Time: 9.05s
======================================================================================================

= Test = round: 130 / acc: 89.870% / loss: 0.3537 / Time: 0.80s
======================================================================================================

round 130 local learning rate = 0.01
round 131 local learning rate = 0.01
round 132 local learning rate = 0.01
round 133 local learning rate = 0.01
round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 89.050% / Loss: 0.3764 / Grad Norm: 0.4688 / Grad Diff: 51.6054 / Time: 12.11s
======================================================================================================

= Test = round: 135 / acc: 90.120% / loss: 0.3463 / Time: 1.06s
======================================================================================================

round 135 local learning rate = 0.01
round 136 local learning rate = 0.01
round 137 local learning rate = 0.01
round 138 local learning rate = 0.01
round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 89.282% / Loss: 0.3678 / Grad Norm: 0.5009 / Grad Diff: 49.7100 / Time: 8.83s
======================================================================================================

= Test = round: 140 / acc: 90.340% / loss: 0.3377 / Time: 0.78s
======================================================================================================

round 140 local learning rate = 0.01
round 141 local learning rate = 0.01
round 142 local learning rate = 0.01
round 143 local learning rate = 0.01
round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 89.517% / Loss: 0.3583 / Grad Norm: 0.4375 / Grad Diff: 48.1860 / Time: 12.06s
======================================================================================================

= Test = round: 145 / acc: 90.550% / loss: 0.3290 / Time: 1.05s
======================================================================================================

round 145 local learning rate = 0.01
round 146 local learning rate = 0.01
round 147 local learning rate = 0.01
round 148 local learning rate = 0.01
round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 89.760% / Loss: 0.3492 / Grad Norm: 0.3878 / Grad Diff: 47.1662 / Time: 10.84s
======================================================================================================

= Test = round: 150 / acc: 90.820% / loss: 0.3201 / Time: 0.77s
======================================================================================================

round 150 local learning rate = 0.01
round 151 local learning rate = 0.01
round 152 local learning rate = 0.01
round 153 local learning rate = 0.01
round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 90.009% / Loss: 0.3424 / Grad Norm: 0.5286 / Grad Diff: 45.7051 / Time: 9.00s
======================================================================================================

= Test = round: 155 / acc: 90.990% / loss: 0.3133 / Time: 0.77s
======================================================================================================

round 155 local learning rate = 0.01
round 156 local learning rate = 0.01
round 157 local learning rate = 0.01
round 158 local learning rate = 0.01
round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 90.255% / Loss: 0.3340 / Grad Norm: 0.4072 / Grad Diff: 43.9984 / Time: 9.19s
======================================================================================================

= Test = round: 160 / acc: 91.220% / loss: 0.3062 / Time: 0.80s
======================================================================================================

round 160 local learning rate = 0.01
round 161 local learning rate = 0.01
round 162 local learning rate = 0.01
round 163 local learning rate = 0.01
round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 90.461% / Loss: 0.3262 / Grad Norm: 0.3189 / Grad Diff: 42.5969 / Time: 12.39s
======================================================================================================

= Test = round: 165 / acc: 91.240% / loss: 0.2992 / Time: 0.77s
======================================================================================================

round 165 local learning rate = 0.01
round 166 local learning rate = 0.01
round 167 local learning rate = 0.01
round 168 local learning rate = 0.01
round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 90.655% / Loss: 0.3198 / Grad Norm: 0.3675 / Grad Diff: 41.1273 / Time: 8.95s
======================================================================================================

= Test = round: 170 / acc: 91.470% / loss: 0.2929 / Time: 0.76s
======================================================================================================

round 170 local learning rate = 0.01
round 171 local learning rate = 0.01
round 172 local learning rate = 0.01
round 173 local learning rate = 0.01
round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 90.832% / Loss: 0.3130 / Grad Norm: 0.3839 / Grad Diff: 40.1264 / Time: 9.05s
======================================================================================================

= Test = round: 175 / acc: 91.740% / loss: 0.2865 / Time: 0.81s
======================================================================================================

round 175 local learning rate = 0.01
round 176 local learning rate = 0.01
round 177 local learning rate = 0.01
round 178 local learning rate = 0.01
round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 90.976% / Loss: 0.3058 / Grad Norm: 0.3628 / Grad Diff: 39.8433 / Time: 9.03s
======================================================================================================

= Test = round: 180 / acc: 91.820% / loss: 0.2795 / Time: 0.81s
======================================================================================================

round 180 local learning rate = 0.01
round 181 local learning rate = 0.01
round 182 local learning rate = 0.01
round 183 local learning rate = 0.01
round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 91.098% / Loss: 0.3008 / Grad Norm: 0.4274 / Grad Diff: 38.2461 / Time: 8.34s
======================================================================================================

= Test = round: 185 / acc: 91.970% / loss: 0.2748 / Time: 0.80s
======================================================================================================

round 185 local learning rate = 0.01
round 186 local learning rate = 0.01
round 187 local learning rate = 0.01
round 188 local learning rate = 0.01
round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 91.323% / Loss: 0.2947 / Grad Norm: 0.3896 / Grad Diff: 36.9691 / Time: 9.09s
======================================================================================================

= Test = round: 190 / acc: 92.100% / loss: 0.2693 / Time: 0.79s
======================================================================================================

round 190 local learning rate = 0.01
round 191 local learning rate = 0.01
round 192 local learning rate = 0.01
round 193 local learning rate = 0.01
round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 91.554% / Loss: 0.2889 / Grad Norm: 0.3549 / Grad Diff: 35.7876 / Time: 9.01s
======================================================================================================

= Test = round: 195 / acc: 92.270% / loss: 0.2641 / Time: 0.77s
======================================================================================================

round 195 local learning rate = 0.01
round 196 local learning rate = 0.01
round 197 local learning rate = 0.01
round 198 local learning rate = 0.01
round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 91.625% / Loss: 0.2833 / Grad Norm: 0.3859 / Grad Diff: 35.3883 / Time: 9.15s
======================================================================================================

= Test = round: 200 / acc: 92.370% / loss: 0.2589 / Time: 0.80s
======================================================================================================

>>> Training model_target_only
Epoch: 001, Train_loss: 0.7097, Train_acc: 0.7922, Test_loss: 0.6943, Test_acc: 0.7976
Epoch: 006, Train_loss: 0.5131, Train_acc: 0.8436, Test_loss: 0.5311, Test_acc: 0.8424
Epoch: 011, Train_loss: 0.4833, Train_acc: 0.8516, Test_loss: 0.5017, Test_acc: 0.8448
Epoch: 016, Train_loss: 0.4429, Train_acc: 0.8693, Test_loss: 0.4642, Test_acc: 0.8618
Epoch: 021, Train_loss: 0.4528, Train_acc: 0.8595, Test_loss: 0.4828, Test_acc: 0.8467
Epoch: 026, Train_loss: 0.4359, Train_acc: 0.8668, Test_loss: 0.4644, Test_acc: 0.8589
Epoch: 031, Train_loss: 0.4298, Train_acc: 0.8649, Test_loss: 0.4596, Test_acc: 0.8578
Epoch: 036, Train_loss: 0.4294, Train_acc: 0.8705, Test_loss: 0.4598, Test_acc: 0.8625
Epoch: 041, Train_loss: 0.4290, Train_acc: 0.8692, Test_loss: 0.4533, Test_acc: 0.8639
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230919165428_model_target_only.pt.
Model saved at ./models/ft_checkpoints/20230919165428_model_target_only.pt.
>>> Fine-tuning done!
>>> Training model_ft
Epoch: 001, Train_loss: 1.2358, Train_acc: 0.6329, Test_loss: 1.2124, Test_acc: 0.6458
Epoch: 006, Train_loss: 1.0497, Train_acc: 0.6855, Test_loss: 1.0325, Test_acc: 0.6935
Epoch: 011, Train_loss: 1.0476, Train_acc: 0.6795, Test_loss: 1.0326, Test_acc: 0.6888
Epoch: 016, Train_loss: 1.0285, Train_acc: 0.6905, Test_loss: 1.0140, Test_acc: 0.6976
Epoch: 021, Train_loss: 1.0289, Train_acc: 0.6948, Test_loss: 1.0174, Test_acc: 0.6967
Epoch: 026, Train_loss: 1.0216, Train_acc: 0.6982, Test_loss: 1.0074, Test_acc: 0.7038
Epoch: 031, Train_loss: 1.0274, Train_acc: 0.6935, Test_loss: 1.0137, Test_acc: 0.6969
Epoch: 036, Train_loss: 1.0175, Train_acc: 0.6960, Test_loss: 1.0060, Test_acc: 0.6983
Epoch: 041, Train_loss: 1.0204, Train_acc: 0.6948, Test_loss: 1.0053, Test_acc: 0.7017
Epoch: 046, Train_loss: 1.0145, Train_acc: 0.7000, Test_loss: 1.0046, Test_acc: 0.7043
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230919165428_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230919165428_model_ft.pt.
>>> Fine-tuning done!
>>> Training model_random
Epoch: 001, Train_loss: 2.2972, Train_acc: 0.1273, Test_loss: 2.2974, Test_acc: 0.1279
Epoch: 006, Train_loss: 2.2944, Train_acc: 0.1298, Test_loss: 2.2943, Test_acc: 0.1323
Epoch: 011, Train_loss: 2.2953, Train_acc: 0.1184, Test_loss: 2.2951, Test_acc: 0.1184
Epoch: 016, Train_loss: 2.2943, Train_acc: 0.1378, Test_loss: 2.2944, Test_acc: 0.1384
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230919165428_model_random.pt.
Model saved at ./models/ft_checkpoints/20230919165428_model_random.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_target_only: [0.42203725378375256, 0.8740699310181184, 0.45004456951914595, 0.8649038995667148]
model_ft: [1.010738842494528, 0.7041406077863087, 0.9985603710079628, 0.7081435396067104]
model_random: [2.2941922373986725, 0.13660785410416773, 2.294249361136955, 0.13698477946894788]
model_source_only: [2.4929078610896522, 0.42828087659531194, 2.5191714083164376, 0.42861904232863013]
fl_test_acc_mean 0.9231
model_source_only_test_acc_mean 0.42861904232863013
model_ft_test_acc_mean 0.7081435396067104
model_target_only_test_acc_mean 0.8649038995667148
model_random_test_acc_mean 0.13698477946894788
