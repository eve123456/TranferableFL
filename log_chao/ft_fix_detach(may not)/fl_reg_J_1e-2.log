nohup: ignoring input
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 64
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 10
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : True
	       reg_J_coef : 0.01
	           repeat : 1
	             seed : 123
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230916194620
FL pretrained model will be saved at ./models/lenet_mnist_20230916194620.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 10.031% / Loss: 2.3040 / Grad Norm: 0.0984 / Grad Diff: 0.8664 / Time: 7.47s
======================================================================================================

= Test = round: 0 / acc: 11.370% / loss: 2.3018 / Time: 0.61s
======================================================================================================

round 0 local learning rate = 0.01

>>> Round:    1 / Acc: 10.063% / Loss: 2.3030 / Grad Norm: 0.1026 / Grad Diff: 0.9060 / Time: 7.56s
======================================================================================================

round 1 local learning rate = 0.01

>>> Round:    2 / Acc: 10.183% / Loss: 2.3019 / Grad Norm: 0.1074 / Grad Diff: 0.9550 / Time: 7.89s
======================================================================================================

round 2 local learning rate = 0.01

>>> Round:    3 / Acc: 10.458% / Loss: 2.3007 / Grad Norm: 0.1127 / Grad Diff: 1.0158 / Time: 7.71s
======================================================================================================

round 3 local learning rate = 0.01

>>> Round:    4 / Acc: 11.273% / Loss: 2.2993 / Grad Norm: 0.1192 / Grad Diff: 1.0933 / Time: 7.53s
======================================================================================================

round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 13.188% / Loss: 2.2977 / Grad Norm: 0.1268 / Grad Diff: 1.1938 / Time: 7.09s
======================================================================================================

= Test = round: 5 / acc: 15.110% / loss: 2.2953 / Time: 0.63s
======================================================================================================

round 5 local learning rate = 0.01

>>> Round:    6 / Acc: 16.779% / Loss: 2.2958 / Grad Norm: 0.1364 / Grad Diff: 1.3278 / Time: 7.21s
======================================================================================================

round 6 local learning rate = 0.01

>>> Round:    7 / Acc: 20.020% / Loss: 2.2936 / Grad Norm: 0.1488 / Grad Diff: 1.5132 / Time: 6.89s
======================================================================================================

round 7 local learning rate = 0.01

>>> Round:    8 / Acc: 19.548% / Loss: 2.2909 / Grad Norm: 0.1639 / Grad Diff: 1.7821 / Time: 7.38s
======================================================================================================

round 8 local learning rate = 0.01

>>> Round:    9 / Acc: 17.000% / Loss: 2.2875 / Grad Norm: 0.1839 / Grad Diff: 2.1903 / Time: 7.35s
======================================================================================================

round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 15.050% / Loss: 2.2830 / Grad Norm: 0.2101 / Grad Diff: 2.8682 / Time: 6.77s
======================================================================================================

= Test = round: 10 / acc: 15.590% / loss: 2.2798 / Time: 0.61s
======================================================================================================

round 10 local learning rate = 0.01

>>> Round:   11 / Acc: 14.463% / Loss: 2.2767 / Grad Norm: 0.2491 / Grad Diff: 4.1158 / Time: 7.68s
======================================================================================================

round 11 local learning rate = 0.01

>>> Round:   12 / Acc: 14.024% / Loss: 2.2671 / Grad Norm: 0.3149 / Grad Diff: 6.8329 / Time: 7.83s
======================================================================================================

round 12 local learning rate = 0.01

>>> Round:   13 / Acc: 15.009% / Loss: 2.2504 / Grad Norm: 0.4294 / Grad Diff: 14.3752 / Time: 9.09s
======================================================================================================

round 13 local learning rate = 0.01

>>> Round:   14 / Acc: 20.419% / Loss: 2.2232 / Grad Norm: 0.6272 / Grad Diff: 37.7706 / Time: 7.64s
======================================================================================================

round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 29.022% / Loss: 2.1845 / Grad Norm: 0.8558 / Grad Diff: 87.9499 / Time: 8.62s
======================================================================================================

= Test = round: 15 / acc: 30.220% / loss: 2.1777 / Time: 0.60s
======================================================================================================

round 15 local learning rate = 0.01

>>> Round:   16 / Acc: 35.753% / Loss: 2.1380 / Grad Norm: 1.0195 / Grad Diff: 153.8347 / Time: 7.52s
======================================================================================================

round 16 local learning rate = 0.01

>>> Round:   17 / Acc: 48.961% / Loss: 2.0968 / Grad Norm: 1.1321 / Grad Diff: 182.8411 / Time: 7.48s
======================================================================================================

round 17 local learning rate = 0.01

>>> Round:   18 / Acc: 53.627% / Loss: 2.0569 / Grad Norm: 1.1364 / Grad Diff: 184.6058 / Time: 7.47s
======================================================================================================

round 18 local learning rate = 0.01

>>> Round:   19 / Acc: 56.031% / Loss: 2.0180 / Grad Norm: 1.2781 / Grad Diff: 185.2757 / Time: 7.40s
======================================================================================================

round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 59.620% / Loss: 1.9702 / Grad Norm: 1.2088 / Grad Diff: 186.4295 / Time: 7.41s
======================================================================================================

= Test = round: 20 / acc: 62.170% / loss: 1.9562 / Time: 0.63s
======================================================================================================

round 20 local learning rate = 0.01

>>> Round:   21 / Acc: 64.260% / Loss: 1.9213 / Grad Norm: 1.2461 / Grad Diff: 187.1764 / Time: 7.37s
======================================================================================================

round 21 local learning rate = 0.01

>>> Round:   22 / Acc: 65.441% / Loss: 1.8691 / Grad Norm: 1.2351 / Grad Diff: 187.2908 / Time: 7.47s
======================================================================================================

round 22 local learning rate = 0.01

>>> Round:   23 / Acc: 63.985% / Loss: 1.8137 / Grad Norm: 1.2978 / Grad Diff: 190.3045 / Time: 8.21s
======================================================================================================

round 23 local learning rate = 0.01

>>> Round:   24 / Acc: 65.581% / Loss: 1.7583 / Grad Norm: 1.3705 / Grad Diff: 187.7397 / Time: 7.38s
======================================================================================================

round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 67.144% / Loss: 1.6969 / Grad Norm: 1.3927 / Grad Diff: 189.0981 / Time: 7.40s
======================================================================================================

= Test = round: 25 / acc: 69.550% / loss: 1.6702 / Time: 0.64s
======================================================================================================

round 25 local learning rate = 0.01

>>> Round:   26 / Acc: 67.380% / Loss: 1.6316 / Grad Norm: 1.3233 / Grad Diff: 190.4842 / Time: 9.69s
======================================================================================================

round 26 local learning rate = 0.01

>>> Round:   27 / Acc: 67.592% / Loss: 1.5706 / Grad Norm: 1.3634 / Grad Diff: 188.9667 / Time: 7.85s
======================================================================================================

round 27 local learning rate = 0.01

>>> Round:   28 / Acc: 68.590% / Loss: 1.5084 / Grad Norm: 1.4378 / Grad Diff: 188.6119 / Time: 7.62s
======================================================================================================

round 28 local learning rate = 0.01

>>> Round:   29 / Acc: 69.648% / Loss: 1.4495 / Grad Norm: 1.4508 / Grad Diff: 185.1338 / Time: 7.42s
======================================================================================================

round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 69.839% / Loss: 1.3917 / Grad Norm: 1.5732 / Grad Diff: 184.3795 / Time: 7.65s
======================================================================================================

= Test = round: 30 / acc: 72.400% / loss: 1.3550 / Time: 0.62s
======================================================================================================

round 30 local learning rate = 0.01

>>> Round:   31 / Acc: 70.766% / Loss: 1.3353 / Grad Norm: 1.4541 / Grad Diff: 179.9064 / Time: 8.15s
======================================================================================================

round 31 local learning rate = 0.01

>>> Round:   32 / Acc: 71.762% / Loss: 1.2784 / Grad Norm: 1.3625 / Grad Diff: 179.5907 / Time: 7.54s
======================================================================================================

round 32 local learning rate = 0.01

>>> Round:   33 / Acc: 71.996% / Loss: 1.2294 / Grad Norm: 1.3564 / Grad Diff: 175.1747 / Time: 7.38s
======================================================================================================

round 33 local learning rate = 0.01

>>> Round:   34 / Acc: 72.756% / Loss: 1.1818 / Grad Norm: 1.3149 / Grad Diff: 172.4500 / Time: 7.41s
======================================================================================================

round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 73.120% / Loss: 1.1383 / Grad Norm: 1.3179 / Grad Diff: 169.4751 / Time: 7.48s
======================================================================================================

= Test = round: 35 / acc: 74.890% / loss: 1.0962 / Time: 0.62s
======================================================================================================

round 35 local learning rate = 0.01

>>> Round:   36 / Acc: 73.201% / Loss: 1.1035 / Grad Norm: 1.4975 / Grad Diff: 163.2706 / Time: 7.82s
======================================================================================================

round 36 local learning rate = 0.01

>>> Round:   37 / Acc: 74.140% / Loss: 1.0613 / Grad Norm: 1.3803 / Grad Diff: 162.2150 / Time: 7.36s
======================================================================================================

round 37 local learning rate = 0.01

>>> Round:   38 / Acc: 73.987% / Loss: 1.0294 / Grad Norm: 1.5730 / Grad Diff: 158.7965 / Time: 7.47s
======================================================================================================

round 38 local learning rate = 0.01

>>> Round:   39 / Acc: 75.166% / Loss: 0.9924 / Grad Norm: 1.2869 / Grad Diff: 156.0818 / Time: 7.42s
======================================================================================================

round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 75.378% / Loss: 0.9642 / Grad Norm: 1.3104 / Grad Diff: 150.8678 / Time: 7.42s
======================================================================================================

= Test = round: 40 / acc: 77.250% / loss: 0.9213 / Time: 0.68s
======================================================================================================

round 40 local learning rate = 0.01

>>> Round:   41 / Acc: 75.928% / Loss: 0.9351 / Grad Norm: 1.2329 / Grad Diff: 147.7380 / Time: 7.45s
======================================================================================================

round 41 local learning rate = 0.01

>>> Round:   42 / Acc: 76.387% / Loss: 0.9093 / Grad Norm: 1.2434 / Grad Diff: 144.6223 / Time: 7.41s
======================================================================================================

round 42 local learning rate = 0.01

>>> Round:   43 / Acc: 76.803% / Loss: 0.8859 / Grad Norm: 1.2912 / Grad Diff: 141.7010 / Time: 7.59s
======================================================================================================

round 43 local learning rate = 0.01

>>> Round:   44 / Acc: 77.221% / Loss: 0.8600 / Grad Norm: 1.2305 / Grad Diff: 140.8292 / Time: 7.38s
======================================================================================================

round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 77.609% / Loss: 0.8415 / Grad Norm: 1.1968 / Grad Diff: 135.8734 / Time: 7.65s
======================================================================================================

= Test = round: 45 / acc: 79.180% / loss: 0.8001 / Time: 0.59s
======================================================================================================

round 45 local learning rate = 0.01

>>> Round:   46 / Acc: 78.033% / Loss: 0.8183 / Grad Norm: 1.1006 / Grad Diff: 135.3462 / Time: 7.38s
======================================================================================================

round 46 local learning rate = 0.01

>>> Round:   47 / Acc: 78.083% / Loss: 0.8035 / Grad Norm: 1.1522 / Grad Diff: 129.3698 / Time: 7.28s
======================================================================================================

round 47 local learning rate = 0.01

>>> Round:   48 / Acc: 78.620% / Loss: 0.7842 / Grad Norm: 1.0840 / Grad Diff: 128.7983 / Time: 7.53s
======================================================================================================

round 48 local learning rate = 0.01

>>> Round:   49 / Acc: 78.657% / Loss: 0.7707 / Grad Norm: 1.1782 / Grad Diff: 125.3022 / Time: 7.58s
======================================================================================================

round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 78.832% / Loss: 0.7554 / Grad Norm: 1.2547 / Grad Diff: 124.1907 / Time: 7.44s
======================================================================================================

= Test = round: 50 / acc: 80.560% / loss: 0.7144 / Time: 0.63s
======================================================================================================

round 50 local learning rate = 0.01

>>> Round:   51 / Acc: 79.244% / Loss: 0.7394 / Grad Norm: 1.1053 / Grad Diff: 121.9545 / Time: 8.25s
======================================================================================================

round 51 local learning rate = 0.01

>>> Round:   52 / Acc: 79.506% / Loss: 0.7270 / Grad Norm: 1.1341 / Grad Diff: 119.2507 / Time: 7.58s
======================================================================================================

round 52 local learning rate = 0.01

>>> Round:   53 / Acc: 79.673% / Loss: 0.7146 / Grad Norm: 1.1346 / Grad Diff: 117.4962 / Time: 7.42s
======================================================================================================

round 53 local learning rate = 0.01

>>> Round:   54 / Acc: 79.996% / Loss: 0.7040 / Grad Norm: 1.1122 / Grad Diff: 114.5268 / Time: 7.34s
======================================================================================================

round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 80.256% / Loss: 0.6931 / Grad Norm: 1.2220 / Grad Diff: 113.9893 / Time: 7.36s
======================================================================================================

= Test = round: 55 / acc: 81.680% / loss: 0.6537 / Time: 0.60s
======================================================================================================

round 55 local learning rate = 0.01

>>> Round:   56 / Acc: 80.557% / Loss: 0.6792 / Grad Norm: 1.1334 / Grad Diff: 114.1345 / Time: 7.82s
======================================================================================================

round 56 local learning rate = 0.01

>>> Round:   57 / Acc: 80.661% / Loss: 0.6683 / Grad Norm: 1.0015 / Grad Diff: 111.6416 / Time: 7.49s
======================================================================================================

round 57 local learning rate = 0.01

>>> Round:   58 / Acc: 80.937% / Loss: 0.6602 / Grad Norm: 1.0308 / Grad Diff: 109.3986 / Time: 9.36s
======================================================================================================

round 58 local learning rate = 0.01

>>> Round:   59 / Acc: 81.125% / Loss: 0.6516 / Grad Norm: 0.9362 / Grad Diff: 105.8096 / Time: 7.66s
======================================================================================================

round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 81.397% / Loss: 0.6435 / Grad Norm: 0.9765 / Grad Diff: 104.2148 / Time: 7.48s
======================================================================================================

= Test = round: 60 / acc: 82.840% / loss: 0.6054 / Time: 0.62s
======================================================================================================

round 60 local learning rate = 0.01

>>> Round:   61 / Acc: 81.441% / Loss: 0.6360 / Grad Norm: 1.0733 / Grad Diff: 103.5586 / Time: 7.20s
======================================================================================================

round 61 local learning rate = 0.01

>>> Round:   62 / Acc: 81.668% / Loss: 0.6276 / Grad Norm: 1.1211 / Grad Diff: 103.2140 / Time: 7.73s
======================================================================================================

round 62 local learning rate = 0.01

>>> Round:   63 / Acc: 81.932% / Loss: 0.6186 / Grad Norm: 1.0775 / Grad Diff: 102.6304 / Time: 7.83s
======================================================================================================

round 63 local learning rate = 0.01

>>> Round:   64 / Acc: 81.965% / Loss: 0.6131 / Grad Norm: 1.0753 / Grad Diff: 99.4537 / Time: 7.28s
======================================================================================================

round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 82.260% / Loss: 0.6029 / Grad Norm: 0.8483 / Grad Diff: 98.5877 / Time: 7.77s
======================================================================================================

= Test = round: 65 / acc: 83.540% / loss: 0.5659 / Time: 0.60s
======================================================================================================

round 65 local learning rate = 0.01

>>> Round:   66 / Acc: 82.493% / Loss: 0.5955 / Grad Norm: 0.7562 / Grad Diff: 97.0623 / Time: 7.54s
======================================================================================================

round 66 local learning rate = 0.01

>>> Round:   67 / Acc: 82.708% / Loss: 0.5896 / Grad Norm: 0.9140 / Grad Diff: 97.1356 / Time: 7.43s
======================================================================================================

round 67 local learning rate = 0.01

>>> Round:   68 / Acc: 82.825% / Loss: 0.5833 / Grad Norm: 0.9588 / Grad Diff: 96.3728 / Time: 7.48s
======================================================================================================

round 68 local learning rate = 0.01

>>> Round:   69 / Acc: 82.993% / Loss: 0.5773 / Grad Norm: 0.8338 / Grad Diff: 94.1017 / Time: 7.72s
======================================================================================================

round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 83.203% / Loss: 0.5703 / Grad Norm: 0.7969 / Grad Diff: 93.7976 / Time: 7.57s
======================================================================================================

= Test = round: 70 / acc: 84.420% / loss: 0.5337 / Time: 0.63s
======================================================================================================

round 70 local learning rate = 0.01

>>> Round:   71 / Acc: 83.264% / Loss: 0.5663 / Grad Norm: 0.8734 / Grad Diff: 91.9054 / Time: 7.50s
======================================================================================================

round 71 local learning rate = 0.01

>>> Round:   72 / Acc: 83.472% / Loss: 0.5603 / Grad Norm: 0.8057 / Grad Diff: 90.6706 / Time: 7.79s
======================================================================================================

round 72 local learning rate = 0.01

>>> Round:   73 / Acc: 83.526% / Loss: 0.5567 / Grad Norm: 0.9091 / Grad Diff: 88.8372 / Time: 7.55s
======================================================================================================

round 73 local learning rate = 0.01

>>> Round:   74 / Acc: 83.681% / Loss: 0.5515 / Grad Norm: 0.9401 / Grad Diff: 88.5302 / Time: 7.46s
======================================================================================================

round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 83.910% / Loss: 0.5426 / Grad Norm: 0.6460 / Grad Diff: 88.0914 / Time: 7.76s
======================================================================================================

= Test = round: 75 / acc: 85.020% / loss: 0.5069 / Time: 0.60s
======================================================================================================

round 75 local learning rate = 0.01

>>> Round:   76 / Acc: 83.978% / Loss: 0.5390 / Grad Norm: 0.7512 / Grad Diff: 86.7718 / Time: 7.44s
======================================================================================================

round 76 local learning rate = 0.01

>>> Round:   77 / Acc: 84.166% / Loss: 0.5341 / Grad Norm: 0.7643 / Grad Diff: 86.2488 / Time: 6.90s
======================================================================================================

round 77 local learning rate = 0.01

>>> Round:   78 / Acc: 84.343% / Loss: 0.5286 / Grad Norm: 0.7011 / Grad Diff: 85.7237 / Time: 6.97s
======================================================================================================

round 78 local learning rate = 0.01

>>> Round:   79 / Acc: 84.339% / Loss: 0.5235 / Grad Norm: 0.6716 / Grad Diff: 85.1032 / Time: 7.38s
======================================================================================================

round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 84.461% / Loss: 0.5198 / Grad Norm: 0.7293 / Grad Diff: 84.2207 / Time: 7.41s
======================================================================================================

= Test = round: 80 / acc: 85.600% / loss: 0.4843 / Time: 0.63s
======================================================================================================

round 80 local learning rate = 0.01

>>> Round:   81 / Acc: 84.677% / Loss: 0.5140 / Grad Norm: 0.5128 / Grad Diff: 82.7112 / Time: 7.48s
======================================================================================================

round 81 local learning rate = 0.01

>>> Round:   82 / Acc: 84.677% / Loss: 0.5120 / Grad Norm: 0.7936 / Grad Diff: 82.3473 / Time: 7.41s
======================================================================================================

round 82 local learning rate = 0.01

>>> Round:   83 / Acc: 84.875% / Loss: 0.5073 / Grad Norm: 0.7622 / Grad Diff: 82.0808 / Time: 7.40s
======================================================================================================

round 83 local learning rate = 0.01

>>> Round:   84 / Acc: 84.932% / Loss: 0.5039 / Grad Norm: 0.6937 / Grad Diff: 79.8575 / Time: 7.42s
======================================================================================================

round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 85.070% / Loss: 0.5010 / Grad Norm: 0.7641 / Grad Diff: 78.8119 / Time: 6.82s
======================================================================================================

= Test = round: 85 / acc: 86.340% / loss: 0.4658 / Time: 0.63s
======================================================================================================

round 85 local learning rate = 0.01

>>> Round:   86 / Acc: 85.232% / Loss: 0.4966 / Grad Norm: 0.8006 / Grad Diff: 78.9236 / Time: 7.48s
======================================================================================================

round 86 local learning rate = 0.01

>>> Round:   87 / Acc: 85.319% / Loss: 0.4929 / Grad Norm: 0.7651 / Grad Diff: 77.6694 / Time: 7.52s
======================================================================================================

round 87 local learning rate = 0.01

>>> Round:   88 / Acc: 85.480% / Loss: 0.4887 / Grad Norm: 0.7223 / Grad Diff: 76.9961 / Time: 7.54s
======================================================================================================

round 88 local learning rate = 0.01

>>> Round:   89 / Acc: 85.590% / Loss: 0.4859 / Grad Norm: 0.6968 / Grad Diff: 75.0643 / Time: 8.22s
======================================================================================================

round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 85.673% / Loss: 0.4805 / Grad Norm: 0.6221 / Grad Diff: 75.5209 / Time: 6.92s
======================================================================================================

= Test = round: 90 / acc: 86.780% / loss: 0.4458 / Time: 0.65s
======================================================================================================

round 90 local learning rate = 0.01

>>> Round:   91 / Acc: 85.777% / Loss: 0.4769 / Grad Norm: 0.7211 / Grad Diff: 75.9271 / Time: 7.52s
======================================================================================================

round 91 local learning rate = 0.01

>>> Round:   92 / Acc: 85.889% / Loss: 0.4736 / Grad Norm: 0.6951 / Grad Diff: 74.8609 / Time: 7.56s
======================================================================================================

round 92 local learning rate = 0.01

>>> Round:   93 / Acc: 86.030% / Loss: 0.4698 / Grad Norm: 0.5860 / Grad Diff: 73.2739 / Time: 7.44s
======================================================================================================

round 93 local learning rate = 0.01

>>> Round:   94 / Acc: 86.118% / Loss: 0.4668 / Grad Norm: 0.6334 / Grad Diff: 72.8295 / Time: 7.55s
======================================================================================================

round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 86.090% / Loss: 0.4659 / Grad Norm: 0.8504 / Grad Diff: 71.9805 / Time: 7.48s
======================================================================================================

= Test = round: 95 / acc: 87.260% / loss: 0.4319 / Time: 0.63s
======================================================================================================

round 95 local learning rate = 0.01

>>> Round:   96 / Acc: 86.238% / Loss: 0.4611 / Grad Norm: 0.6538 / Grad Diff: 70.5450 / Time: 7.50s
======================================================================================================

round 96 local learning rate = 0.01

>>> Round:   97 / Acc: 86.371% / Loss: 0.4564 / Grad Norm: 0.6191 / Grad Diff: 71.3939 / Time: 7.46s
======================================================================================================

round 97 local learning rate = 0.01

>>> Round:   98 / Acc: 86.482% / Loss: 0.4536 / Grad Norm: 0.6389 / Grad Diff: 70.5284 / Time: 7.38s
======================================================================================================

round 98 local learning rate = 0.01

>>> Round:   99 / Acc: 86.565% / Loss: 0.4505 / Grad Norm: 0.6487 / Grad Diff: 70.0226 / Time: 7.42s
======================================================================================================

round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 86.614% / Loss: 0.4475 / Grad Norm: 0.6931 / Grad Diff: 69.7740 / Time: 6.77s
======================================================================================================

= Test = round: 100 / acc: 87.710% / loss: 0.4134 / Time: 0.61s
======================================================================================================

round 100 local learning rate = 0.01

>>> Round:  101 / Acc: 86.688% / Loss: 0.4451 / Grad Norm: 0.7375 / Grad Diff: 69.2092 / Time: 6.78s
======================================================================================================

round 101 local learning rate = 0.01

>>> Round:  102 / Acc: 86.747% / Loss: 0.4432 / Grad Norm: 0.7522 / Grad Diff: 67.4564 / Time: 7.43s
======================================================================================================

round 102 local learning rate = 0.01

>>> Round:  103 / Acc: 86.902% / Loss: 0.4394 / Grad Norm: 0.6896 / Grad Diff: 66.8783 / Time: 7.40s
======================================================================================================

round 103 local learning rate = 0.01

>>> Round:  104 / Acc: 87.055% / Loss: 0.4352 / Grad Norm: 0.5676 / Grad Diff: 66.4670 / Time: 7.44s
======================================================================================================

round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 87.094% / Loss: 0.4329 / Grad Norm: 0.7097 / Grad Diff: 66.7786 / Time: 7.09s
======================================================================================================

= Test = round: 105 / acc: 88.110% / loss: 0.3993 / Time: 0.62s
======================================================================================================

round 105 local learning rate = 0.01

>>> Round:  106 / Acc: 87.177% / Loss: 0.4301 / Grad Norm: 0.6505 / Grad Diff: 65.4811 / Time: 7.12s
======================================================================================================

round 106 local learning rate = 0.01

>>> Round:  107 / Acc: 87.293% / Loss: 0.4267 / Grad Norm: 0.6302 / Grad Diff: 65.1889 / Time: 9.20s
======================================================================================================

round 107 local learning rate = 0.01

>>> Round:  108 / Acc: 87.465% / Loss: 0.4236 / Grad Norm: 0.6310 / Grad Diff: 65.3322 / Time: 7.88s
======================================================================================================

round 108 local learning rate = 0.01

>>> Round:  109 / Acc: 87.537% / Loss: 0.4212 / Grad Norm: 0.5500 / Grad Diff: 63.2479 / Time: 7.55s
======================================================================================================

round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 87.657% / Loss: 0.4186 / Grad Norm: 0.5481 / Grad Diff: 62.6757 / Time: 7.85s
======================================================================================================

= Test = round: 110 / acc: 88.590% / loss: 0.3860 / Time: 0.61s
======================================================================================================

round 110 local learning rate = 0.01

>>> Round:  111 / Acc: 87.685% / Loss: 0.4165 / Grad Norm: 0.6028 / Grad Diff: 62.1344 / Time: 7.48s
======================================================================================================

round 111 local learning rate = 0.01

>>> Round:  112 / Acc: 87.777% / Loss: 0.4135 / Grad Norm: 0.5382 / Grad Diff: 61.1183 / Time: 7.63s
======================================================================================================

round 112 local learning rate = 0.01

>>> Round:  113 / Acc: 87.792% / Loss: 0.4123 / Grad Norm: 0.6444 / Grad Diff: 60.1455 / Time: 6.81s
======================================================================================================

round 113 local learning rate = 0.01

>>> Round:  114 / Acc: 87.873% / Loss: 0.4092 / Grad Norm: 0.6609 / Grad Diff: 60.3766 / Time: 7.51s
======================================================================================================

round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 87.889% / Loss: 0.4068 / Grad Norm: 0.6447 / Grad Diff: 59.5511 / Time: 7.72s
======================================================================================================

= Test = round: 115 / acc: 88.900% / loss: 0.3740 / Time: 0.64s
======================================================================================================

round 115 local learning rate = 0.01

>>> Round:  116 / Acc: 88.046% / Loss: 0.4031 / Grad Norm: 0.5144 / Grad Diff: 58.8153 / Time: 7.83s
======================================================================================================

round 116 local learning rate = 0.01

>>> Round:  117 / Acc: 88.133% / Loss: 0.4021 / Grad Norm: 0.5962 / Grad Diff: 57.8464 / Time: 7.46s
======================================================================================================

round 117 local learning rate = 0.01

>>> Round:  118 / Acc: 88.229% / Loss: 0.3989 / Grad Norm: 0.5388 / Grad Diff: 57.1928 / Time: 7.50s
======================================================================================================

round 118 local learning rate = 0.01

>>> Round:  119 / Acc: 88.280% / Loss: 0.3960 / Grad Norm: 0.5506 / Grad Diff: 57.2657 / Time: 8.91s
======================================================================================================

round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 88.426% / Loss: 0.3927 / Grad Norm: 0.4559 / Grad Diff: 57.0469 / Time: 8.62s
======================================================================================================

= Test = round: 120 / acc: 89.300% / loss: 0.3608 / Time: 0.65s
======================================================================================================

round 120 local learning rate = 0.01

>>> Round:  121 / Acc: 88.399% / Loss: 0.3914 / Grad Norm: 0.6033 / Grad Diff: 56.7240 / Time: 7.50s
======================================================================================================

round 121 local learning rate = 0.01

>>> Round:  122 / Acc: 88.494% / Loss: 0.3890 / Grad Norm: 0.6405 / Grad Diff: 56.6626 / Time: 7.34s
======================================================================================================

round 122 local learning rate = 0.01

>>> Round:  123 / Acc: 88.524% / Loss: 0.3866 / Grad Norm: 0.6865 / Grad Diff: 56.8251 / Time: 7.36s
======================================================================================================

round 123 local learning rate = 0.01

>>> Round:  124 / Acc: 88.629% / Loss: 0.3836 / Grad Norm: 0.5399 / Grad Diff: 55.8897 / Time: 7.39s
======================================================================================================

round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 88.685% / Loss: 0.3820 / Grad Norm: 0.5428 / Grad Diff: 54.7198 / Time: 7.39s
======================================================================================================

= Test = round: 125 / acc: 89.590% / loss: 0.3511 / Time: 0.62s
======================================================================================================

round 125 local learning rate = 0.01

>>> Round:  126 / Acc: 88.788% / Loss: 0.3790 / Grad Norm: 0.5311 / Grad Diff: 54.9016 / Time: 8.31s
======================================================================================================

round 126 local learning rate = 0.01

>>> Round:  127 / Acc: 88.869% / Loss: 0.3758 / Grad Norm: 0.4242 / Grad Diff: 54.5901 / Time: 7.54s
======================================================================================================

round 127 local learning rate = 0.01

>>> Round:  128 / Acc: 88.921% / Loss: 0.3739 / Grad Norm: 0.4537 / Grad Diff: 54.1591 / Time: 7.41s
======================================================================================================

round 128 local learning rate = 0.01

>>> Round:  129 / Acc: 88.965% / Loss: 0.3723 / Grad Norm: 0.5415 / Grad Diff: 53.7839 / Time: 7.40s
======================================================================================================

round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 89.033% / Loss: 0.3698 / Grad Norm: 0.5538 / Grad Diff: 54.2343 / Time: 6.89s
======================================================================================================

= Test = round: 130 / acc: 89.930% / loss: 0.3390 / Time: 0.63s
======================================================================================================

round 130 local learning rate = 0.01

>>> Round:  131 / Acc: 89.131% / Loss: 0.3678 / Grad Norm: 0.5216 / Grad Diff: 53.3480 / Time: 7.50s
======================================================================================================

round 131 local learning rate = 0.01

>>> Round:  132 / Acc: 89.196% / Loss: 0.3659 / Grad Norm: 0.5346 / Grad Diff: 52.9787 / Time: 7.41s
======================================================================================================

round 132 local learning rate = 0.01

>>> Round:  133 / Acc: 89.159% / Loss: 0.3646 / Grad Norm: 0.5606 / Grad Diff: 51.6039 / Time: 7.18s
======================================================================================================

round 133 local learning rate = 0.01

>>> Round:  134 / Acc: 89.321% / Loss: 0.3621 / Grad Norm: 0.5461 / Grad Diff: 51.4895 / Time: 7.38s
======================================================================================================

round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 89.406% / Loss: 0.3599 / Grad Norm: 0.4789 / Grad Diff: 50.6099 / Time: 7.42s
======================================================================================================

= Test = round: 135 / acc: 90.260% / loss: 0.3302 / Time: 0.62s
======================================================================================================

round 135 local learning rate = 0.01

>>> Round:  136 / Acc: 89.467% / Loss: 0.3574 / Grad Norm: 0.4348 / Grad Diff: 50.3557 / Time: 7.44s
======================================================================================================

round 136 local learning rate = 0.01

>>> Round:  137 / Acc: 89.487% / Loss: 0.3575 / Grad Norm: 0.6766 / Grad Diff: 50.1560 / Time: 7.74s
======================================================================================================

round 137 local learning rate = 0.01

>>> Round:  138 / Acc: 89.596% / Loss: 0.3544 / Grad Norm: 0.4747 / Grad Diff: 48.8276 / Time: 7.58s
======================================================================================================

round 138 local learning rate = 0.01

>>> Round:  139 / Acc: 89.644% / Loss: 0.3523 / Grad Norm: 0.4662 / Grad Diff: 48.6959 / Time: 7.57s
======================================================================================================

round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 89.723% / Loss: 0.3504 / Grad Norm: 0.4866 / Grad Diff: 48.4765 / Time: 7.64s
======================================================================================================

= Test = round: 140 / acc: 90.490% / loss: 0.3214 / Time: 0.63s
======================================================================================================

round 140 local learning rate = 0.01

>>> Round:  141 / Acc: 89.755% / Loss: 0.3476 / Grad Norm: 0.4693 / Grad Diff: 49.0776 / Time: 7.54s
======================================================================================================

round 141 local learning rate = 0.01

>>> Round:  142 / Acc: 89.718% / Loss: 0.3470 / Grad Norm: 0.6302 / Grad Diff: 48.9638 / Time: 9.11s
======================================================================================================

round 142 local learning rate = 0.01

>>> Round:  143 / Acc: 89.815% / Loss: 0.3436 / Grad Norm: 0.4636 / Grad Diff: 48.4341 / Time: 7.31s
======================================================================================================

round 143 local learning rate = 0.01

>>> Round:  144 / Acc: 89.858% / Loss: 0.3421 / Grad Norm: 0.4724 / Grad Diff: 47.8677 / Time: 7.30s
======================================================================================================

round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 89.935% / Loss: 0.3403 / Grad Norm: 0.4868 / Grad Diff: 47.5157 / Time: 7.56s
======================================================================================================

= Test = round: 145 / acc: 90.700% / loss: 0.3117 / Time: 0.62s
======================================================================================================

round 145 local learning rate = 0.01

>>> Round:  146 / Acc: 89.989% / Loss: 0.3381 / Grad Norm: 0.4724 / Grad Diff: 47.6992 / Time: 7.91s
======================================================================================================

round 146 local learning rate = 0.01

>>> Round:  147 / Acc: 89.993% / Loss: 0.3369 / Grad Norm: 0.6164 / Grad Diff: 48.1730 / Time: 7.39s
======================================================================================================

round 147 local learning rate = 0.01

>>> Round:  148 / Acc: 90.107% / Loss: 0.3340 / Grad Norm: 0.4417 / Grad Diff: 47.3604 / Time: 6.91s
======================================================================================================

round 148 local learning rate = 0.01

>>> Round:  149 / Acc: 90.155% / Loss: 0.3321 / Grad Norm: 0.3926 / Grad Diff: 46.8931 / Time: 7.35s
======================================================================================================

round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 90.183% / Loss: 0.3309 / Grad Norm: 0.4377 / Grad Diff: 46.2995 / Time: 7.35s
======================================================================================================

= Test = round: 150 / acc: 90.830% / loss: 0.3027 / Time: 0.63s
======================================================================================================

round 150 local learning rate = 0.01

>>> Round:  151 / Acc: 90.201% / Loss: 0.3299 / Grad Norm: 0.4936 / Grad Diff: 45.8668 / Time: 7.36s
======================================================================================================

round 151 local learning rate = 0.01

>>> Round:  152 / Acc: 90.245% / Loss: 0.3295 / Grad Norm: 0.5554 / Grad Diff: 44.6913 / Time: 7.33s
======================================================================================================

round 152 local learning rate = 0.01

>>> Round:  153 / Acc: 90.308% / Loss: 0.3275 / Grad Norm: 0.5517 / Grad Diff: 44.6004 / Time: 7.38s
======================================================================================================

round 153 local learning rate = 0.01

>>> Round:  154 / Acc: 90.358% / Loss: 0.3251 / Grad Norm: 0.4741 / Grad Diff: 44.5658 / Time: 8.01s
======================================================================================================

round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 90.384% / Loss: 0.3241 / Grad Norm: 0.5392 / Grad Diff: 44.3096 / Time: 7.49s
======================================================================================================

= Test = round: 155 / acc: 91.060% / loss: 0.2965 / Time: 0.61s
======================================================================================================

round 155 local learning rate = 0.01

>>> Round:  156 / Acc: 90.445% / Loss: 0.3223 / Grad Norm: 0.5022 / Grad Diff: 43.5317 / Time: 7.52s
======================================================================================================

round 156 local learning rate = 0.01

>>> Round:  157 / Acc: 90.554% / Loss: 0.3200 / Grad Norm: 0.4681 / Grad Diff: 43.5049 / Time: 7.41s
======================================================================================================

round 157 local learning rate = 0.01

>>> Round:  158 / Acc: 90.601% / Loss: 0.3185 / Grad Norm: 0.4403 / Grad Diff: 42.7826 / Time: 7.43s
======================================================================================================

round 158 local learning rate = 0.01

>>> Round:  159 / Acc: 90.642% / Loss: 0.3168 / Grad Norm: 0.4312 / Grad Diff: 42.4556 / Time: 7.39s
======================================================================================================

round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 90.659% / Loss: 0.3153 / Grad Norm: 0.4059 / Grad Diff: 42.1204 / Time: 7.19s
======================================================================================================

= Test = round: 160 / acc: 91.300% / loss: 0.2878 / Time: 0.63s
======================================================================================================

round 160 local learning rate = 0.01

>>> Round:  161 / Acc: 90.692% / Loss: 0.3140 / Grad Norm: 0.4039 / Grad Diff: 41.4140 / Time: 7.27s
======================================================================================================

round 161 local learning rate = 0.01

>>> Round:  162 / Acc: 90.768% / Loss: 0.3121 / Grad Norm: 0.3996 / Grad Diff: 41.4515 / Time: 8.63s
======================================================================================================

round 162 local learning rate = 0.01

>>> Round:  163 / Acc: 90.836% / Loss: 0.3108 / Grad Norm: 0.4260 / Grad Diff: 41.2087 / Time: 7.83s
======================================================================================================

round 163 local learning rate = 0.01

>>> Round:  164 / Acc: 90.915% / Loss: 0.3090 / Grad Norm: 0.4038 / Grad Diff: 40.9847 / Time: 7.35s
======================================================================================================

round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 90.959% / Loss: 0.3077 / Grad Norm: 0.4278 / Grad Diff: 40.7786 / Time: 7.53s
======================================================================================================

= Test = round: 165 / acc: 91.650% / loss: 0.2810 / Time: 0.60s
======================================================================================================

round 165 local learning rate = 0.01

>>> Round:  166 / Acc: 91.030% / Loss: 0.3060 / Grad Norm: 0.4035 / Grad Diff: 40.2315 / Time: 7.41s
======================================================================================================

round 166 local learning rate = 0.01

>>> Round:  167 / Acc: 91.041% / Loss: 0.3050 / Grad Norm: 0.3906 / Grad Diff: 39.6711 / Time: 7.38s
======================================================================================================

round 167 local learning rate = 0.01

>>> Round:  168 / Acc: 91.066% / Loss: 0.3037 / Grad Norm: 0.4506 / Grad Diff: 39.7039 / Time: 7.37s
======================================================================================================

round 168 local learning rate = 0.01

>>> Round:  169 / Acc: 91.140% / Loss: 0.3015 / Grad Norm: 0.3787 / Grad Diff: 39.3647 / Time: 7.44s
======================================================================================================

round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 91.177% / Loss: 0.3002 / Grad Norm: 0.4011 / Grad Diff: 39.2800 / Time: 7.38s
======================================================================================================

= Test = round: 170 / acc: 91.750% / loss: 0.2739 / Time: 0.60s
======================================================================================================

round 170 local learning rate = 0.01

>>> Round:  171 / Acc: 91.218% / Loss: 0.2989 / Grad Norm: 0.4609 / Grad Diff: 39.3211 / Time: 7.35s
======================================================================================================

round 171 local learning rate = 0.01

>>> Round:  172 / Acc: 91.212% / Loss: 0.2977 / Grad Norm: 0.4651 / Grad Diff: 39.1722 / Time: 7.37s
======================================================================================================

round 172 local learning rate = 0.01

>>> Round:  173 / Acc: 91.240% / Loss: 0.2960 / Grad Norm: 0.4544 / Grad Diff: 38.9753 / Time: 7.52s
======================================================================================================

round 173 local learning rate = 0.01

>>> Round:  174 / Acc: 91.280% / Loss: 0.2946 / Grad Norm: 0.4438 / Grad Diff: 38.8133 / Time: 7.51s
======================================================================================================

round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 91.315% / Loss: 0.2929 / Grad Norm: 0.4195 / Grad Diff: 38.5460 / Time: 7.40s
======================================================================================================

= Test = round: 175 / acc: 91.940% / loss: 0.2674 / Time: 0.61s
======================================================================================================

round 175 local learning rate = 0.01

>>> Round:  176 / Acc: 91.382% / Loss: 0.2914 / Grad Norm: 0.4144 / Grad Diff: 38.4666 / Time: 7.62s
======================================================================================================

round 176 local learning rate = 0.01

>>> Round:  177 / Acc: 91.415% / Loss: 0.2900 / Grad Norm: 0.3835 / Grad Diff: 38.1320 / Time: 7.56s
======================================================================================================

round 177 local learning rate = 0.01

>>> Round:  178 / Acc: 91.476% / Loss: 0.2889 / Grad Norm: 0.4489 / Grad Diff: 38.2409 / Time: 7.55s
======================================================================================================

round 178 local learning rate = 0.01

>>> Round:  179 / Acc: 91.520% / Loss: 0.2877 / Grad Norm: 0.4563 / Grad Diff: 37.9112 / Time: 7.98s
======================================================================================================

round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 91.572% / Loss: 0.2869 / Grad Norm: 0.4546 / Grad Diff: 37.2411 / Time: 7.46s
======================================================================================================

= Test = round: 180 / acc: 92.030% / loss: 0.2616 / Time: 0.62s
======================================================================================================

round 180 local learning rate = 0.01

>>> Round:  181 / Acc: 91.589% / Loss: 0.2849 / Grad Norm: 0.3799 / Grad Diff: 37.2618 / Time: 7.79s
======================================================================================================

round 181 local learning rate = 0.01

>>> Round:  182 / Acc: 91.653% / Loss: 0.2836 / Grad Norm: 0.4204 / Grad Diff: 37.2026 / Time: 7.32s
======================================================================================================

round 182 local learning rate = 0.01

>>> Round:  183 / Acc: 91.690% / Loss: 0.2827 / Grad Norm: 0.4328 / Grad Diff: 36.9365 / Time: 7.49s
======================================================================================================

round 183 local learning rate = 0.01

>>> Round:  184 / Acc: 91.747% / Loss: 0.2815 / Grad Norm: 0.3679 / Grad Diff: 36.1916 / Time: 7.82s
======================================================================================================

round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 91.769% / Loss: 0.2799 / Grad Norm: 0.3674 / Grad Diff: 36.2096 / Time: 7.59s
======================================================================================================

= Test = round: 185 / acc: 92.310% / loss: 0.2548 / Time: 0.61s
======================================================================================================

round 185 local learning rate = 0.01

>>> Round:  186 / Acc: 91.821% / Loss: 0.2790 / Grad Norm: 0.3891 / Grad Diff: 35.8820 / Time: 6.82s
======================================================================================================

round 186 local learning rate = 0.01

>>> Round:  187 / Acc: 91.828% / Loss: 0.2775 / Grad Norm: 0.3682 / Grad Diff: 35.8283 / Time: 6.84s
======================================================================================================

round 187 local learning rate = 0.01

>>> Round:  188 / Acc: 91.849% / Loss: 0.2760 / Grad Norm: 0.3997 / Grad Diff: 36.2632 / Time: 7.84s
======================================================================================================

round 188 local learning rate = 0.01

>>> Round:  189 / Acc: 91.895% / Loss: 0.2751 / Grad Norm: 0.4025 / Grad Diff: 35.5895 / Time: 8.77s
======================================================================================================

round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 91.924% / Loss: 0.2739 / Grad Norm: 0.4140 / Grad Diff: 35.6733 / Time: 7.54s
======================================================================================================

= Test = round: 190 / acc: 92.430% / loss: 0.2497 / Time: 0.63s
======================================================================================================

round 190 local learning rate = 0.01

>>> Round:  191 / Acc: 91.926% / Loss: 0.2727 / Grad Norm: 0.3907 / Grad Diff: 35.3478 / Time: 9.82s
======================================================================================================

round 191 local learning rate = 0.01

>>> Round:  192 / Acc: 91.913% / Loss: 0.2707 / Grad Norm: 0.3218 / Grad Diff: 35.4498 / Time: 7.38s
======================================================================================================

round 192 local learning rate = 0.01

>>> Round:  193 / Acc: 91.993% / Loss: 0.2702 / Grad Norm: 0.4211 / Grad Diff: 35.2447 / Time: 7.48s
======================================================================================================

round 193 local learning rate = 0.01

>>> Round:  194 / Acc: 92.042% / Loss: 0.2689 / Grad Norm: 0.3856 / Grad Diff: 34.9313 / Time: 7.52s
======================================================================================================

round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 92.037% / Loss: 0.2676 / Grad Norm: 0.3870 / Grad Diff: 35.3217 / Time: 7.53s
======================================================================================================

= Test = round: 195 / acc: 92.600% / loss: 0.2434 / Time: 0.61s
======================================================================================================

round 195 local learning rate = 0.01

>>> Round:  196 / Acc: 92.077% / Loss: 0.2672 / Grad Norm: 0.4756 / Grad Diff: 34.8524 / Time: 7.43s
======================================================================================================

round 196 local learning rate = 0.01

>>> Round:  197 / Acc: 92.109% / Loss: 0.2657 / Grad Norm: 0.3741 / Grad Diff: 34.0143 / Time: 7.36s
======================================================================================================

round 197 local learning rate = 0.01

>>> Round:  198 / Acc: 92.111% / Loss: 0.2653 / Grad Norm: 0.4275 / Grad Diff: 33.4248 / Time: 7.47s
======================================================================================================

round 198 local learning rate = 0.01

>>> Round:  199 / Acc: 92.194% / Loss: 0.2641 / Grad Norm: 0.3559 / Grad Diff: 33.0155 / Time: 7.66s
======================================================================================================

round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 92.212% / Loss: 0.2630 / Grad Norm: 0.3667 / Grad Diff: 33.0104 / Time: 7.54s
======================================================================================================

= Test = round: 200 / acc: 92.760% / loss: 0.2394 / Time: 0.63s
======================================================================================================

>>> Training model_target_only
Epoch: 001, Train_loss: 0.6231, Train_acc: 0.8123, Test_loss: 0.6338, Test_acc: 0.8090
Epoch: 006, Train_loss: 0.3590, Train_acc: 0.8832, Test_loss: 0.4321, Test_acc: 0.8603
Epoch: 011, Train_loss: 0.2588, Train_acc: 0.9152, Test_loss: 0.4244, Test_acc: 0.8671
Epoch: 016, Train_loss: 0.1806, Train_acc: 0.9410, Test_loss: 0.4639, Test_acc: 0.8680
Epoch: 021, Train_loss: 0.1413, Train_acc: 0.9526, Test_loss: 0.5478, Test_acc: 0.8683
Epoch: 026, Train_loss: 0.1075, Train_acc: 0.9639, Test_loss: 0.6409, Test_acc: 0.8675
Epoch: 031, Train_loss: 0.0913, Train_acc: 0.9689, Test_loss: 0.7253, Test_acc: 0.8650
Epoch: 036, Train_loss: 0.0837, Train_acc: 0.9720, Test_loss: 0.8785, Test_acc: 0.8566
Epoch: 041, Train_loss: 0.0725, Train_acc: 0.9751, Test_loss: 0.9821, Test_acc: 0.8575
Epoch: 046, Train_loss: 0.0483, Train_acc: 0.9846, Test_loss: 1.0416, Test_acc: 0.8581
Epoch: 051, Train_loss: 0.0866, Train_acc: 0.9723, Test_loss: 1.1159, Test_acc: 0.8575
Epoch: 056, Train_loss: 0.0460, Train_acc: 0.9838, Test_loss: 1.2004, Test_acc: 0.8582
Epoch: 061, Train_loss: 0.0444, Train_acc: 0.9860, Test_loss: 1.3361, Test_acc: 0.8546
Epoch: 066, Train_loss: 0.0466, Train_acc: 0.9843, Test_loss: 1.4233, Test_acc: 0.8589
Epoch: 071, Train_loss: 0.0368, Train_acc: 0.9883, Test_loss: 1.4958, Test_acc: 0.8573
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230916194620_model_target_only.pt.
Model saved at ./models/ft_checkpoints/20230916194620_model_target_only.pt.
>>> Fine-tuning done!
>>> Training model_ft
Epoch: 001, Train_loss: 1.1348, Train_acc: 0.6520, Test_loss: 1.1093, Test_acc: 0.6614
Epoch: 006, Train_loss: 0.8825, Train_acc: 0.7258, Test_loss: 0.8908, Test_acc: 0.7247
Epoch: 011, Train_loss: 0.8126, Train_acc: 0.7473, Test_loss: 0.8378, Test_acc: 0.7409
Epoch: 016, Train_loss: 0.7914, Train_acc: 0.7498, Test_loss: 0.8209, Test_acc: 0.7465
Epoch: 021, Train_loss: 0.7686, Train_acc: 0.7564, Test_loss: 0.8120, Test_acc: 0.7467
Epoch: 026, Train_loss: 0.7370, Train_acc: 0.7670, Test_loss: 0.7975, Test_acc: 0.7538
Epoch: 031, Train_loss: 0.7190, Train_acc: 0.7716, Test_loss: 0.7894, Test_acc: 0.7565
Epoch: 036, Train_loss: 0.7049, Train_acc: 0.7755, Test_loss: 0.7812, Test_acc: 0.7550
Epoch: 041, Train_loss: 0.6944, Train_acc: 0.7790, Test_loss: 0.7784, Test_acc: 0.7575
Epoch: 046, Train_loss: 0.7020, Train_acc: 0.7735, Test_loss: 0.7972, Test_acc: 0.7494
Epoch: 051, Train_loss: 0.6824, Train_acc: 0.7814, Test_loss: 0.7811, Test_acc: 0.7544
Epoch: 056, Train_loss: 0.6734, Train_acc: 0.7842, Test_loss: 0.7811, Test_acc: 0.7564
Epoch: 061, Train_loss: 0.6643, Train_acc: 0.7859, Test_loss: 0.7807, Test_acc: 0.7555
Epoch: 066, Train_loss: 0.6614, Train_acc: 0.7865, Test_loss: 0.7828, Test_acc: 0.7547
Epoch: 071, Train_loss: 0.6517, Train_acc: 0.7896, Test_loss: 0.7760, Test_acc: 0.7611
Epoch: 076, Train_loss: 0.6574, Train_acc: 0.7868, Test_loss: 0.7859, Test_acc: 0.7552
Epoch: 081, Train_loss: 0.6498, Train_acc: 0.7898, Test_loss: 0.7855, Test_acc: 0.7559
Epoch: 086, Train_loss: 0.6395, Train_acc: 0.7933, Test_loss: 0.7794, Test_acc: 0.7586
Epoch: 091, Train_loss: 0.6438, Train_acc: 0.7899, Test_loss: 0.7933, Test_acc: 0.7550
Epoch: 096, Train_loss: 0.6345, Train_acc: 0.7943, Test_loss: 0.7880, Test_acc: 0.7588
Epoch: 101, Train_loss: 0.6293, Train_acc: 0.7954, Test_loss: 0.7813, Test_acc: 0.7578
Epoch: 106, Train_loss: 0.6323, Train_acc: 0.7952, Test_loss: 0.7872, Test_acc: 0.7598
Epoch: 111, Train_loss: 0.6215, Train_acc: 0.7995, Test_loss: 0.7866, Test_acc: 0.7590
Epoch: 116, Train_loss: 0.6247, Train_acc: 0.7979, Test_loss: 0.7868, Test_acc: 0.7592
Epoch: 121, Train_loss: 0.6219, Train_acc: 0.7977, Test_loss: 0.7919, Test_acc: 0.7602
Epoch: 126, Train_loss: 0.6147, Train_acc: 0.8021, Test_loss: 0.7965, Test_acc: 0.7589
Epoch: 131, Train_loss: 0.6347, Train_acc: 0.7922, Test_loss: 0.8069, Test_acc: 0.7548
Epoch: 136, Train_loss: 0.6072, Train_acc: 0.8036, Test_loss: 0.7887, Test_acc: 0.7639
Epoch: 141, Train_loss: 0.6184, Train_acc: 0.7980, Test_loss: 0.7986, Test_acc: 0.7571
Epoch: 146, Train_loss: 0.6043, Train_acc: 0.8043, Test_loss: 0.7910, Test_acc: 0.7617
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230916194620_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230916194620_model_ft.pt.
>>> Fine-tuning done!
>>> Training model_random
Epoch: 001, Train_loss: 1.8393, Train_acc: 0.4096, Test_loss: 1.8407, Test_acc: 0.4053
Epoch: 006, Train_loss: 1.4117, Train_acc: 0.5404, Test_loss: 1.4202, Test_acc: 0.5374
Epoch: 011, Train_loss: 1.3048, Train_acc: 0.5761, Test_loss: 1.3133, Test_acc: 0.5704
Epoch: 016, Train_loss: 1.2303, Train_acc: 0.6022, Test_loss: 1.2387, Test_acc: 0.5975
Epoch: 021, Train_loss: 1.1797, Train_acc: 0.6187, Test_loss: 1.1924, Test_acc: 0.6105
Epoch: 026, Train_loss: 1.1467, Train_acc: 0.6275, Test_loss: 1.1641, Test_acc: 0.6197
Epoch: 031, Train_loss: 1.1183, Train_acc: 0.6354, Test_loss: 1.1405, Test_acc: 0.6266
Epoch: 036, Train_loss: 1.0959, Train_acc: 0.6415, Test_loss: 1.1216, Test_acc: 0.6334
Epoch: 041, Train_loss: 1.0715, Train_acc: 0.6516, Test_loss: 1.1024, Test_acc: 0.6413
Epoch: 046, Train_loss: 1.0561, Train_acc: 0.6543, Test_loss: 1.0903, Test_acc: 0.6417
Epoch: 051, Train_loss: 1.0382, Train_acc: 0.6600, Test_loss: 1.0799, Test_acc: 0.6467
Epoch: 056, Train_loss: 1.0297, Train_acc: 0.6626, Test_loss: 1.0761, Test_acc: 0.6466
Epoch: 061, Train_loss: 1.0175, Train_acc: 0.6668, Test_loss: 1.0663, Test_acc: 0.6490
Epoch: 066, Train_loss: 1.0059, Train_acc: 0.6709, Test_loss: 1.0587, Test_acc: 0.6525
Epoch: 071, Train_loss: 0.9952, Train_acc: 0.6720, Test_loss: 1.0536, Test_acc: 0.6556
Epoch: 076, Train_loss: 0.9912, Train_acc: 0.6743, Test_loss: 1.0519, Test_acc: 0.6557
Epoch: 081, Train_loss: 0.9822, Train_acc: 0.6762, Test_loss: 1.0469, Test_acc: 0.6591
Epoch: 086, Train_loss: 0.9741, Train_acc: 0.6796, Test_loss: 1.0437, Test_acc: 0.6596
Epoch: 091, Train_loss: 0.9681, Train_acc: 0.6805, Test_loss: 1.0426, Test_acc: 0.6588
Epoch: 096, Train_loss: 0.9638, Train_acc: 0.6837, Test_loss: 1.0418, Test_acc: 0.6621
Epoch: 101, Train_loss: 0.9582, Train_acc: 0.6835, Test_loss: 1.0388, Test_acc: 0.6649
Epoch: 106, Train_loss: 0.9524, Train_acc: 0.6848, Test_loss: 1.0339, Test_acc: 0.6653
Epoch: 111, Train_loss: 0.9450, Train_acc: 0.6888, Test_loss: 1.0325, Test_acc: 0.6626
Epoch: 116, Train_loss: 0.9410, Train_acc: 0.6901, Test_loss: 1.0303, Test_acc: 0.6629
Epoch: 121, Train_loss: 0.9376, Train_acc: 0.6924, Test_loss: 1.0317, Test_acc: 0.6668
Epoch: 126, Train_loss: 0.9369, Train_acc: 0.6916, Test_loss: 1.0341, Test_acc: 0.6653
Epoch: 131, Train_loss: 0.9293, Train_acc: 0.6944, Test_loss: 1.0265, Test_acc: 0.6644
Epoch: 136, Train_loss: 0.9252, Train_acc: 0.6948, Test_loss: 1.0286, Test_acc: 0.6635
Epoch: 141, Train_loss: 0.9264, Train_acc: 0.6954, Test_loss: 1.0303, Test_acc: 0.6688
Epoch: 146, Train_loss: 0.9208, Train_acc: 0.6970, Test_loss: 1.0286, Test_acc: 0.6671
Epoch: 151, Train_loss: 0.9218, Train_acc: 0.6968, Test_loss: 1.0307, Test_acc: 0.6663
Epoch: 156, Train_loss: 0.9173, Train_acc: 0.6970, Test_loss: 1.0298, Test_acc: 0.6675
Epoch: 161, Train_loss: 0.9141, Train_acc: 0.6995, Test_loss: 1.0243, Test_acc: 0.6681
Epoch: 166, Train_loss: 0.9121, Train_acc: 0.7001, Test_loss: 1.0287, Test_acc: 0.6666
Epoch: 171, Train_loss: 0.9114, Train_acc: 0.6978, Test_loss: 1.0312, Test_acc: 0.6661
Epoch: 176, Train_loss: 0.9083, Train_acc: 0.7004, Test_loss: 1.0275, Test_acc: 0.6643
Epoch: 181, Train_loss: 0.9055, Train_acc: 0.7007, Test_loss: 1.0272, Test_acc: 0.6663
Epoch: 186, Train_loss: 0.8992, Train_acc: 0.7026, Test_loss: 1.0235, Test_acc: 0.6674
Epoch: 191, Train_loss: 0.9019, Train_acc: 0.7026, Test_loss: 1.0279, Test_acc: 0.6653
Epoch: 196, Train_loss: 0.8979, Train_acc: 0.7031, Test_loss: 1.0264, Test_acc: 0.6674
Model saved at ./models/ft_checkpoints/20230916194620_model_random.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_target_only: [0.030682507985191183, 0.990118811545567, 1.4120963903920225, 0.8601266525941562]
model_ft: [0.6031345111626985, 0.804054168573414, 0.7897010921849209, 0.7621375402733029]
model_random: [0.8925878547821624, 0.7055473636040067, 1.0231731929801302, 0.6692589712254194]
model_source_only: [2.3374595648434093, 0.434450263554855, 2.3518010593098992, 0.4337295856015998]
fl_test_acc_mean 0.9262
model_source_only_test_acc_mean 0.4337295856015998
model_ft_test_acc_mean 0.7621375402733029
model_target_only_test_acc_mean 0.8601266525941562
model_random_test_acc_mean 0.6692589712254194
