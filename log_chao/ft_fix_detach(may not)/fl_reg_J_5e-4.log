nohup: ignoring input
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 64
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 10
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : True
	       reg_J_coef : 0.0005
	           repeat : 1
	             seed : 123
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230917023307
FL pretrained model will be saved at ./models/lenet_mnist_20230917023307.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 10.736% / Loss: 2.3015 / Grad Norm: 0.1398 / Grad Diff: 1.0693 / Time: 7.63s
======================================================================================================

= Test = round: 0 / acc: 12.280% / loss: 2.2987 / Time: 0.61s
======================================================================================================

round 0 local learning rate = 0.01

>>> Round:    1 / Acc: 11.498% / Loss: 2.2993 / Grad Norm: 0.1482 / Grad Diff: 1.1837 / Time: 7.41s
======================================================================================================

round 1 local learning rate = 0.01

>>> Round:    2 / Acc: 12.779% / Loss: 2.2966 / Grad Norm: 0.1593 / Grad Diff: 1.3493 / Time: 8.51s
======================================================================================================

round 2 local learning rate = 0.01

>>> Round:    3 / Acc: 14.777% / Loss: 2.2933 / Grad Norm: 0.1744 / Grad Diff: 1.5999 / Time: 7.59s
======================================================================================================

round 3 local learning rate = 0.01

>>> Round:    4 / Acc: 19.679% / Loss: 2.2890 / Grad Norm: 0.1949 / Grad Diff: 1.9936 / Time: 7.76s
======================================================================================================

round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 27.387% / Loss: 2.2834 / Grad Norm: 0.2223 / Grad Diff: 2.6623 / Time: 7.51s
======================================================================================================

= Test = round: 5 / acc: 29.260% / loss: 2.2798 / Time: 0.61s
======================================================================================================

round 5 local learning rate = 0.01

>>> Round:    6 / Acc: 24.496% / Loss: 2.2757 / Grad Norm: 0.2609 / Grad Diff: 3.9178 / Time: 7.40s
======================================================================================================

round 6 local learning rate = 0.01

>>> Round:    7 / Acc: 17.631% / Loss: 2.2652 / Grad Norm: 0.3251 / Grad Diff: 6.6912 / Time: 6.76s
======================================================================================================

round 7 local learning rate = 0.01

>>> Round:    8 / Acc: 16.808% / Loss: 2.2514 / Grad Norm: 0.4704 / Grad Diff: 14.2165 / Time: 7.37s
======================================================================================================

round 8 local learning rate = 0.01

>>> Round:    9 / Acc: 21.934% / Loss: 2.2338 / Grad Norm: 0.8163 / Grad Diff: 36.5899 / Time: 7.42s
======================================================================================================

round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 28.197% / Loss: 2.1958 / Grad Norm: 1.1859 / Grad Diff: 85.1543 / Time: 8.18s
======================================================================================================

= Test = round: 10 / acc: 28.500% / loss: 2.1904 / Time: 0.61s
======================================================================================================

round 10 local learning rate = 0.01

>>> Round:   11 / Acc: 37.107% / Loss: 2.1371 / Grad Norm: 1.2478 / Grad Diff: 149.4031 / Time: 8.03s
======================================================================================================

round 11 local learning rate = 0.01

>>> Round:   12 / Acc: 40.644% / Loss: 2.0834 / Grad Norm: 1.0479 / Grad Diff: 185.4929 / Time: 7.29s
======================================================================================================

round 12 local learning rate = 0.01

>>> Round:   13 / Acc: 49.812% / Loss: 2.0425 / Grad Norm: 1.0610 / Grad Diff: 186.9673 / Time: 7.83s
======================================================================================================

round 13 local learning rate = 0.01

>>> Round:   14 / Acc: 57.258% / Loss: 1.9997 / Grad Norm: 1.0951 / Grad Diff: 189.2855 / Time: 8.69s
======================================================================================================

round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 59.030% / Loss: 1.9538 / Grad Norm: 1.1292 / Grad Diff: 188.2658 / Time: 7.45s
======================================================================================================

= Test = round: 15 / acc: 61.630% / loss: 1.9325 / Time: 0.62s
======================================================================================================

round 15 local learning rate = 0.01

>>> Round:   16 / Acc: 58.382% / Loss: 1.9053 / Grad Norm: 1.2490 / Grad Diff: 189.1796 / Time: 7.39s
======================================================================================================

round 16 local learning rate = 0.01

>>> Round:   17 / Acc: 62.616% / Loss: 1.8516 / Grad Norm: 1.2312 / Grad Diff: 188.8931 / Time: 7.53s
======================================================================================================

round 17 local learning rate = 0.01

>>> Round:   18 / Acc: 63.190% / Loss: 1.7966 / Grad Norm: 1.2529 / Grad Diff: 187.8027 / Time: 7.47s
======================================================================================================

round 18 local learning rate = 0.01

>>> Round:   19 / Acc: 63.764% / Loss: 1.7413 / Grad Norm: 1.3540 / Grad Diff: 187.9839 / Time: 7.33s
======================================================================================================

round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 65.258% / Loss: 1.6816 / Grad Norm: 1.3238 / Grad Diff: 187.4200 / Time: 8.71s
======================================================================================================

= Test = round: 20 / acc: 68.040% / loss: 1.6456 / Time: 0.62s
======================================================================================================

round 20 local learning rate = 0.01

>>> Round:   21 / Acc: 66.271% / Loss: 1.6235 / Grad Norm: 1.3936 / Grad Diff: 186.5518 / Time: 7.52s
======================================================================================================

round 21 local learning rate = 0.01

>>> Round:   22 / Acc: 66.707% / Loss: 1.5638 / Grad Norm: 1.3667 / Grad Diff: 184.4516 / Time: 7.53s
======================================================================================================

round 22 local learning rate = 0.01

>>> Round:   23 / Acc: 67.426% / Loss: 1.5048 / Grad Norm: 1.3802 / Grad Diff: 183.6902 / Time: 7.66s
======================================================================================================

round 23 local learning rate = 0.01

>>> Round:   24 / Acc: 68.315% / Loss: 1.4489 / Grad Norm: 1.4791 / Grad Diff: 181.6923 / Time: 7.79s
======================================================================================================

round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 68.690% / Loss: 1.3901 / Grad Norm: 1.4588 / Grad Diff: 181.4897 / Time: 8.13s
======================================================================================================

= Test = round: 25 / acc: 71.220% / loss: 1.3444 / Time: 0.60s
======================================================================================================

round 25 local learning rate = 0.01

>>> Round:   26 / Acc: 68.939% / Loss: 1.3328 / Grad Norm: 1.5022 / Grad Diff: 182.8886 / Time: 7.51s
======================================================================================================

round 26 local learning rate = 0.01

>>> Round:   27 / Acc: 69.782% / Loss: 1.2840 / Grad Norm: 1.4989 / Grad Diff: 175.4046 / Time: 7.74s
======================================================================================================

round 27 local learning rate = 0.01

>>> Round:   28 / Acc: 70.408% / Loss: 1.2316 / Grad Norm: 1.3922 / Grad Diff: 173.2344 / Time: 7.40s
======================================================================================================

round 28 local learning rate = 0.01

>>> Round:   29 / Acc: 71.413% / Loss: 1.1826 / Grad Norm: 1.3505 / Grad Diff: 172.1107 / Time: 7.56s
======================================================================================================

round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 72.207% / Loss: 1.1398 / Grad Norm: 1.3416 / Grad Diff: 168.8131 / Time: 7.40s
======================================================================================================

= Test = round: 30 / acc: 74.330% / loss: 1.0924 / Time: 0.59s
======================================================================================================

round 30 local learning rate = 0.01

>>> Round:   31 / Acc: 72.550% / Loss: 1.0966 / Grad Norm: 1.3500 / Grad Diff: 169.0239 / Time: 7.35s
======================================================================================================

round 31 local learning rate = 0.01

>>> Round:   32 / Acc: 73.351% / Loss: 1.0590 / Grad Norm: 1.3259 / Grad Diff: 165.7492 / Time: 7.74s
======================================================================================================

round 32 local learning rate = 0.01

>>> Round:   33 / Acc: 73.661% / Loss: 1.0276 / Grad Norm: 1.3841 / Grad Diff: 160.0875 / Time: 7.96s
======================================================================================================

round 33 local learning rate = 0.01

>>> Round:   34 / Acc: 74.507% / Loss: 0.9912 / Grad Norm: 1.2792 / Grad Diff: 160.3395 / Time: 7.59s
======================================================================================================

round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 74.771% / Loss: 0.9637 / Grad Norm: 1.3091 / Grad Diff: 154.5700 / Time: 7.64s
======================================================================================================

= Test = round: 35 / acc: 76.860% / loss: 0.9172 / Time: 0.66s
======================================================================================================

round 35 local learning rate = 0.01

>>> Round:   36 / Acc: 75.402% / Loss: 0.9328 / Grad Norm: 1.2656 / Grad Diff: 154.7489 / Time: 7.76s
======================================================================================================

round 36 local learning rate = 0.01

>>> Round:   37 / Acc: 75.731% / Loss: 0.9069 / Grad Norm: 1.2583 / Grad Diff: 151.6794 / Time: 8.51s
======================================================================================================

round 37 local learning rate = 0.01

>>> Round:   38 / Acc: 76.148% / Loss: 0.8850 / Grad Norm: 1.2812 / Grad Diff: 147.7103 / Time: 7.38s
======================================================================================================

round 38 local learning rate = 0.01

>>> Round:   39 / Acc: 76.725% / Loss: 0.8615 / Grad Norm: 1.1814 / Grad Diff: 144.9728 / Time: 7.70s
======================================================================================================

round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 76.873% / Loss: 0.8415 / Grad Norm: 1.1921 / Grad Diff: 140.9920 / Time: 8.79s
======================================================================================================

= Test = round: 40 / acc: 78.670% / loss: 0.7977 / Time: 0.79s
======================================================================================================

round 40 local learning rate = 0.01

>>> Round:   41 / Acc: 77.437% / Loss: 0.8192 / Grad Norm: 1.0856 / Grad Diff: 140.6080 / Time: 7.29s
======================================================================================================

round 41 local learning rate = 0.01

>>> Round:   42 / Acc: 77.773% / Loss: 0.7993 / Grad Norm: 1.0372 / Grad Diff: 139.1827 / Time: 7.57s
======================================================================================================

round 42 local learning rate = 0.01

>>> Round:   43 / Acc: 78.057% / Loss: 0.7853 / Grad Norm: 1.0896 / Grad Diff: 134.7934 / Time: 7.47s
======================================================================================================

round 43 local learning rate = 0.01

>>> Round:   44 / Acc: 78.463% / Loss: 0.7685 / Grad Norm: 0.9947 / Grad Diff: 132.2584 / Time: 7.61s
======================================================================================================

round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 78.642% / Loss: 0.7528 / Grad Norm: 1.0098 / Grad Diff: 131.2462 / Time: 8.46s
======================================================================================================

= Test = round: 45 / acc: 80.400% / loss: 0.7116 / Time: 0.64s
======================================================================================================

round 45 local learning rate = 0.01

>>> Round:   46 / Acc: 78.851% / Loss: 0.7378 / Grad Norm: 1.0431 / Grad Diff: 131.3880 / Time: 7.41s
======================================================================================================

round 46 local learning rate = 0.01

>>> Round:   47 / Acc: 79.290% / Loss: 0.7251 / Grad Norm: 0.9303 / Grad Diff: 127.4500 / Time: 7.49s
======================================================================================================

round 47 local learning rate = 0.01

>>> Round:   48 / Acc: 79.476% / Loss: 0.7132 / Grad Norm: 0.9802 / Grad Diff: 125.9383 / Time: 7.29s
======================================================================================================

round 48 local learning rate = 0.01

>>> Round:   49 / Acc: 79.830% / Loss: 0.7008 / Grad Norm: 0.8691 / Grad Diff: 122.6992 / Time: 7.35s
======================================================================================================

round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 80.107% / Loss: 0.6886 / Grad Norm: 0.9006 / Grad Diff: 123.0888 / Time: 7.36s
======================================================================================================

= Test = round: 50 / acc: 81.670% / loss: 0.6484 / Time: 0.60s
======================================================================================================

round 50 local learning rate = 0.01

>>> Round:   51 / Acc: 80.376% / Loss: 0.6796 / Grad Norm: 0.9206 / Grad Diff: 120.4833 / Time: 7.48s
======================================================================================================

round 51 local learning rate = 0.01

>>> Round:   52 / Acc: 80.583% / Loss: 0.6705 / Grad Norm: 0.8565 / Grad Diff: 116.7871 / Time: 8.08s
======================================================================================================

round 52 local learning rate = 0.01

>>> Round:   53 / Acc: 80.716% / Loss: 0.6610 / Grad Norm: 0.8706 / Grad Diff: 115.0838 / Time: 7.49s
======================================================================================================

round 53 local learning rate = 0.01

>>> Round:   54 / Acc: 80.930% / Loss: 0.6545 / Grad Norm: 0.9414 / Grad Diff: 112.5349 / Time: 7.44s
======================================================================================================

round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 81.142% / Loss: 0.6443 / Grad Norm: 0.9261 / Grad Diff: 112.6787 / Time: 7.50s
======================================================================================================

= Test = round: 55 / acc: 82.570% / loss: 0.6063 / Time: 0.61s
======================================================================================================

round 55 local learning rate = 0.01

>>> Round:   56 / Acc: 81.288% / Loss: 0.6335 / Grad Norm: 0.8527 / Grad Diff: 113.0692 / Time: 7.41s
======================================================================================================

round 56 local learning rate = 0.01

>>> Round:   57 / Acc: 81.393% / Loss: 0.6271 / Grad Norm: 0.9057 / Grad Diff: 111.0729 / Time: 7.46s
======================================================================================================

round 57 local learning rate = 0.01

>>> Round:   58 / Acc: 81.657% / Loss: 0.6195 / Grad Norm: 0.8501 / Grad Diff: 109.4015 / Time: 7.46s
======================================================================================================

round 58 local learning rate = 0.01

>>> Round:   59 / Acc: 81.867% / Loss: 0.6127 / Grad Norm: 0.8254 / Grad Diff: 106.8015 / Time: 7.43s
======================================================================================================

round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 82.041% / Loss: 0.6069 / Grad Norm: 0.8211 / Grad Diff: 104.4672 / Time: 7.37s
======================================================================================================

= Test = round: 60 / acc: 83.490% / loss: 0.5698 / Time: 0.62s
======================================================================================================

round 60 local learning rate = 0.01

>>> Round:   61 / Acc: 82.223% / Loss: 0.5992 / Grad Norm: 0.8192 / Grad Diff: 104.6023 / Time: 7.15s
======================================================================================================

round 61 local learning rate = 0.01

>>> Round:   62 / Acc: 82.413% / Loss: 0.5932 / Grad Norm: 0.8340 / Grad Diff: 103.2790 / Time: 7.28s
======================================================================================================

round 62 local learning rate = 0.01

>>> Round:   63 / Acc: 82.487% / Loss: 0.5883 / Grad Norm: 0.9017 / Grad Diff: 101.9476 / Time: 6.79s
======================================================================================================

round 63 local learning rate = 0.01

>>> Round:   64 / Acc: 82.742% / Loss: 0.5826 / Grad Norm: 0.8482 / Grad Diff: 99.8989 / Time: 7.57s
======================================================================================================

round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 82.910% / Loss: 0.5753 / Grad Norm: 0.8035 / Grad Diff: 100.1887 / Time: 7.43s
======================================================================================================

= Test = round: 65 / acc: 84.230% / loss: 0.5394 / Time: 0.62s
======================================================================================================

round 65 local learning rate = 0.01

>>> Round:   66 / Acc: 83.148% / Loss: 0.5688 / Grad Norm: 0.6587 / Grad Diff: 98.6868 / Time: 7.53s
======================================================================================================

round 66 local learning rate = 0.01

>>> Round:   67 / Acc: 83.155% / Loss: 0.5652 / Grad Norm: 0.8354 / Grad Diff: 97.6790 / Time: 7.46s
======================================================================================================

round 67 local learning rate = 0.01

>>> Round:   68 / Acc: 83.327% / Loss: 0.5596 / Grad Norm: 0.8853 / Grad Diff: 98.1447 / Time: 8.99s
======================================================================================================

round 68 local learning rate = 0.01

>>> Round:   69 / Acc: 83.611% / Loss: 0.5533 / Grad Norm: 0.6581 / Grad Diff: 96.0719 / Time: 7.65s
======================================================================================================

round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 83.670% / Loss: 0.5492 / Grad Norm: 0.7101 / Grad Diff: 94.8268 / Time: 7.91s
======================================================================================================

= Test = round: 70 / acc: 84.690% / loss: 0.5137 / Time: 0.64s
======================================================================================================

round 70 local learning rate = 0.01

>>> Round:   71 / Acc: 83.721% / Loss: 0.5456 / Grad Norm: 0.8460 / Grad Diff: 94.2060 / Time: 7.48s
======================================================================================================

round 71 local learning rate = 0.01

>>> Round:   72 / Acc: 83.908% / Loss: 0.5400 / Grad Norm: 0.7055 / Grad Diff: 93.1379 / Time: 7.83s
======================================================================================================

round 72 local learning rate = 0.01

>>> Round:   73 / Acc: 84.061% / Loss: 0.5364 / Grad Norm: 0.7307 / Grad Diff: 91.5622 / Time: 7.00s
======================================================================================================

round 73 local learning rate = 0.01

>>> Round:   74 / Acc: 84.105% / Loss: 0.5332 / Grad Norm: 0.7816 / Grad Diff: 89.8838 / Time: 7.63s
======================================================================================================

round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 84.238% / Loss: 0.5278 / Grad Norm: 0.7108 / Grad Diff: 89.4733 / Time: 7.57s
======================================================================================================

= Test = round: 75 / acc: 85.310% / loss: 0.4931 / Time: 0.60s
======================================================================================================

round 75 local learning rate = 0.01

>>> Round:   76 / Acc: 84.343% / Loss: 0.5243 / Grad Norm: 0.6766 / Grad Diff: 87.8489 / Time: 7.52s
======================================================================================================

round 76 local learning rate = 0.01

>>> Round:   77 / Acc: 84.544% / Loss: 0.5202 / Grad Norm: 0.6642 / Grad Diff: 87.0809 / Time: 7.44s
======================================================================================================

round 77 local learning rate = 0.01

>>> Round:   78 / Acc: 84.659% / Loss: 0.5160 / Grad Norm: 0.6796 / Grad Diff: 86.9408 / Time: 7.60s
======================================================================================================

round 78 local learning rate = 0.01

>>> Round:   79 / Acc: 84.804% / Loss: 0.5107 / Grad Norm: 0.5994 / Grad Diff: 86.6257 / Time: 7.33s
======================================================================================================

round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 84.851% / Loss: 0.5076 / Grad Norm: 0.6363 / Grad Diff: 85.5181 / Time: 7.58s
======================================================================================================

= Test = round: 80 / acc: 85.820% / loss: 0.4734 / Time: 0.76s
======================================================================================================

round 80 local learning rate = 0.01

>>> Round:   81 / Acc: 85.068% / Loss: 0.5040 / Grad Norm: 0.5680 / Grad Diff: 84.2287 / Time: 7.44s
======================================================================================================

round 81 local learning rate = 0.01

>>> Round:   82 / Acc: 84.913% / Loss: 0.5028 / Grad Norm: 0.8107 / Grad Diff: 83.3936 / Time: 7.42s
======================================================================================================

round 82 local learning rate = 0.01

>>> Round:   83 / Acc: 85.087% / Loss: 0.4986 / Grad Norm: 0.7717 / Grad Diff: 83.3959 / Time: 7.25s
======================================================================================================

round 83 local learning rate = 0.01

>>> Round:   84 / Acc: 85.310% / Loss: 0.4943 / Grad Norm: 0.7299 / Grad Diff: 83.2304 / Time: 7.33s
======================================================================================================

round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 85.354% / Loss: 0.4921 / Grad Norm: 0.7460 / Grad Diff: 81.2209 / Time: 7.57s
======================================================================================================

= Test = round: 85 / acc: 86.310% / loss: 0.4578 / Time: 0.61s
======================================================================================================

round 85 local learning rate = 0.01

>>> Round:   86 / Acc: 85.446% / Loss: 0.4879 / Grad Norm: 0.7040 / Grad Diff: 80.9865 / Time: 7.57s
======================================================================================================

round 86 local learning rate = 0.01

>>> Round:   87 / Acc: 85.548% / Loss: 0.4859 / Grad Norm: 0.6890 / Grad Diff: 79.0765 / Time: 7.86s
======================================================================================================

round 87 local learning rate = 0.01

>>> Round:   88 / Acc: 85.701% / Loss: 0.4820 / Grad Norm: 0.6160 / Grad Diff: 78.5827 / Time: 7.50s
======================================================================================================

round 88 local learning rate = 0.01

>>> Round:   89 / Acc: 85.727% / Loss: 0.4791 / Grad Norm: 0.6315 / Grad Diff: 77.8625 / Time: 9.76s
======================================================================================================

round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 85.875% / Loss: 0.4754 / Grad Norm: 0.5991 / Grad Diff: 77.6376 / Time: 8.39s
======================================================================================================

= Test = round: 90 / acc: 86.760% / loss: 0.4425 / Time: 0.65s
======================================================================================================

round 90 local learning rate = 0.01

>>> Round:   91 / Acc: 85.904% / Loss: 0.4733 / Grad Norm: 0.7281 / Grad Diff: 77.4130 / Time: 7.39s
======================================================================================================

round 91 local learning rate = 0.01

>>> Round:   92 / Acc: 86.081% / Loss: 0.4693 / Grad Norm: 0.6261 / Grad Diff: 76.8563 / Time: 9.52s
======================================================================================================

round 92 local learning rate = 0.01

>>> Round:   93 / Acc: 86.137% / Loss: 0.4674 / Grad Norm: 0.6395 / Grad Diff: 75.4361 / Time: 7.43s
======================================================================================================

round 93 local learning rate = 0.01

>>> Round:   94 / Acc: 86.275% / Loss: 0.4647 / Grad Norm: 0.6368 / Grad Diff: 74.9226 / Time: 7.74s
======================================================================================================

round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 86.251% / Loss: 0.4629 / Grad Norm: 0.6792 / Grad Diff: 73.5935 / Time: 7.43s
======================================================================================================

= Test = round: 95 / acc: 87.130% / loss: 0.4302 / Time: 0.63s
======================================================================================================

round 95 local learning rate = 0.01

>>> Round:   96 / Acc: 86.472% / Loss: 0.4584 / Grad Norm: 0.5668 / Grad Diff: 73.7432 / Time: 7.42s
======================================================================================================

round 96 local learning rate = 0.01

>>> Round:   97 / Acc: 86.530% / Loss: 0.4549 / Grad Norm: 0.6013 / Grad Diff: 74.6258 / Time: 7.46s
======================================================================================================

round 97 local learning rate = 0.01

>>> Round:   98 / Acc: 86.579% / Loss: 0.4525 / Grad Norm: 0.6260 / Grad Diff: 74.1275 / Time: 7.34s
======================================================================================================

round 98 local learning rate = 0.01

>>> Round:   99 / Acc: 86.542% / Loss: 0.4508 / Grad Norm: 0.6665 / Grad Diff: 72.7459 / Time: 7.78s
======================================================================================================

round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 86.655% / Loss: 0.4483 / Grad Norm: 0.6740 / Grad Diff: 72.3223 / Time: 7.42s
======================================================================================================

= Test = round: 100 / acc: 87.610% / loss: 0.4158 / Time: 0.62s
======================================================================================================

round 100 local learning rate = 0.01

>>> Round:  101 / Acc: 86.638% / Loss: 0.4465 / Grad Norm: 0.7494 / Grad Diff: 71.9462 / Time: 7.45s
======================================================================================================

round 101 local learning rate = 0.01

>>> Round:  102 / Acc: 86.685% / Loss: 0.4458 / Grad Norm: 0.7875 / Grad Diff: 70.1113 / Time: 7.50s
======================================================================================================

round 102 local learning rate = 0.01

>>> Round:  103 / Acc: 86.852% / Loss: 0.4420 / Grad Norm: 0.6687 / Grad Diff: 69.3557 / Time: 7.79s
======================================================================================================

round 103 local learning rate = 0.01

>>> Round:  104 / Acc: 86.983% / Loss: 0.4383 / Grad Norm: 0.6003 / Grad Diff: 69.4018 / Time: 7.39s
======================================================================================================

round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 87.079% / Loss: 0.4357 / Grad Norm: 0.6210 / Grad Diff: 69.4460 / Time: 7.51s
======================================================================================================

= Test = round: 105 / acc: 88.080% / loss: 0.4038 / Time: 0.65s
======================================================================================================

round 105 local learning rate = 0.01

>>> Round:  106 / Acc: 87.159% / Loss: 0.4332 / Grad Norm: 0.6376 / Grad Diff: 69.1629 / Time: 7.51s
======================================================================================================

round 106 local learning rate = 0.01

>>> Round:  107 / Acc: 87.323% / Loss: 0.4307 / Grad Norm: 0.5455 / Grad Diff: 68.0241 / Time: 7.45s
======================================================================================================

round 107 local learning rate = 0.01

>>> Round:  108 / Acc: 87.384% / Loss: 0.4278 / Grad Norm: 0.5419 / Grad Diff: 68.3535 / Time: 7.66s
======================================================================================================

round 108 local learning rate = 0.01

>>> Round:  109 / Acc: 87.413% / Loss: 0.4261 / Grad Norm: 0.5247 / Grad Diff: 67.0957 / Time: 7.63s
======================================================================================================

round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 87.448% / Loss: 0.4239 / Grad Norm: 0.5357 / Grad Diff: 66.6450 / Time: 7.51s
======================================================================================================

= Test = round: 110 / acc: 88.320% / loss: 0.3930 / Time: 0.62s
======================================================================================================

round 110 local learning rate = 0.01

>>> Round:  111 / Acc: 87.507% / Loss: 0.4222 / Grad Norm: 0.5703 / Grad Diff: 66.1119 / Time: 7.39s
======================================================================================================

round 111 local learning rate = 0.01

>>> Round:  112 / Acc: 87.566% / Loss: 0.4201 / Grad Norm: 0.5295 / Grad Diff: 65.1188 / Time: 7.43s
======================================================================================================

round 112 local learning rate = 0.01

>>> Round:  113 / Acc: 87.539% / Loss: 0.4190 / Grad Norm: 0.5759 / Grad Diff: 63.9862 / Time: 7.49s
======================================================================================================

round 113 local learning rate = 0.01

>>> Round:  114 / Acc: 87.677% / Loss: 0.4159 / Grad Norm: 0.5117 / Grad Diff: 63.8203 / Time: 7.58s
======================================================================================================

round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 87.697% / Loss: 0.4145 / Grad Norm: 0.5387 / Grad Diff: 62.7308 / Time: 8.05s
======================================================================================================

= Test = round: 115 / acc: 88.730% / loss: 0.3832 / Time: 0.61s
======================================================================================================

round 115 local learning rate = 0.01

>>> Round:  116 / Acc: 87.792% / Loss: 0.4120 / Grad Norm: 0.5425 / Grad Diff: 62.7635 / Time: 7.36s
======================================================================================================

round 116 local learning rate = 0.01

>>> Round:  117 / Acc: 87.827% / Loss: 0.4106 / Grad Norm: 0.5536 / Grad Diff: 61.9253 / Time: 8.05s
======================================================================================================

round 117 local learning rate = 0.01

>>> Round:  118 / Acc: 87.902% / Loss: 0.4083 / Grad Norm: 0.5651 / Grad Diff: 61.6772 / Time: 7.02s
======================================================================================================

round 118 local learning rate = 0.01

>>> Round:  119 / Acc: 87.924% / Loss: 0.4059 / Grad Norm: 0.5459 / Grad Diff: 61.6386 / Time: 7.58s
======================================================================================================

round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 88.046% / Loss: 0.4031 / Grad Norm: 0.4992 / Grad Diff: 61.6612 / Time: 8.55s
======================================================================================================

= Test = round: 120 / acc: 88.920% / loss: 0.3730 / Time: 0.66s
======================================================================================================

round 120 local learning rate = 0.01

>>> Round:  121 / Acc: 88.059% / Loss: 0.4020 / Grad Norm: 0.5248 / Grad Diff: 60.4891 / Time: 7.73s
======================================================================================================

round 121 local learning rate = 0.01

>>> Round:  122 / Acc: 88.120% / Loss: 0.4000 / Grad Norm: 0.5506 / Grad Diff: 60.4750 / Time: 7.54s
======================================================================================================

round 122 local learning rate = 0.01

>>> Round:  123 / Acc: 88.166% / Loss: 0.3981 / Grad Norm: 0.6229 / Grad Diff: 60.7595 / Time: 7.49s
======================================================================================================

round 123 local learning rate = 0.01

>>> Round:  124 / Acc: 88.207% / Loss: 0.3963 / Grad Norm: 0.5235 / Grad Diff: 59.4961 / Time: 8.60s
======================================================================================================

round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 88.284% / Loss: 0.3946 / Grad Norm: 0.5032 / Grad Diff: 58.9691 / Time: 7.07s
======================================================================================================

= Test = round: 125 / acc: 89.220% / loss: 0.3647 / Time: 0.61s
======================================================================================================

round 125 local learning rate = 0.01

>>> Round:  126 / Acc: 88.301% / Loss: 0.3927 / Grad Norm: 0.5798 / Grad Diff: 59.0667 / Time: 6.90s
======================================================================================================

round 126 local learning rate = 0.01

>>> Round:  127 / Acc: 88.382% / Loss: 0.3900 / Grad Norm: 0.5234 / Grad Diff: 59.0715 / Time: 7.44s
======================================================================================================

round 127 local learning rate = 0.01

>>> Round:  128 / Acc: 88.389% / Loss: 0.3883 / Grad Norm: 0.5089 / Grad Diff: 58.5116 / Time: 7.88s
======================================================================================================

round 128 local learning rate = 0.01

>>> Round:  129 / Acc: 88.500% / Loss: 0.3866 / Grad Norm: 0.5145 / Grad Diff: 57.9999 / Time: 8.16s
======================================================================================================

round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 88.559% / Loss: 0.3848 / Grad Norm: 0.4781 / Grad Diff: 57.5832 / Time: 7.53s
======================================================================================================

= Test = round: 130 / acc: 89.570% / loss: 0.3553 / Time: 0.60s
======================================================================================================

round 130 local learning rate = 0.01

>>> Round:  131 / Acc: 88.585% / Loss: 0.3836 / Grad Norm: 0.5098 / Grad Diff: 57.1920 / Time: 7.35s
======================================================================================================

round 131 local learning rate = 0.01

>>> Round:  132 / Acc: 88.589% / Loss: 0.3823 / Grad Norm: 0.5767 / Grad Diff: 57.0174 / Time: 7.38s
======================================================================================================

round 132 local learning rate = 0.01

>>> Round:  133 / Acc: 88.644% / Loss: 0.3809 / Grad Norm: 0.5655 / Grad Diff: 56.0612 / Time: 8.48s
======================================================================================================

round 133 local learning rate = 0.01

>>> Round:  134 / Acc: 88.635% / Loss: 0.3796 / Grad Norm: 0.6384 / Grad Diff: 56.0629 / Time: 8.28s
======================================================================================================

round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 88.799% / Loss: 0.3770 / Grad Norm: 0.4903 / Grad Diff: 55.1618 / Time: 7.47s
======================================================================================================

= Test = round: 135 / acc: 89.710% / loss: 0.3488 / Time: 0.63s
======================================================================================================

round 135 local learning rate = 0.01

>>> Round:  136 / Acc: 88.863% / Loss: 0.3747 / Grad Norm: 0.4466 / Grad Diff: 55.0494 / Time: 7.62s
======================================================================================================

round 136 local learning rate = 0.01

>>> Round:  137 / Acc: 88.908% / Loss: 0.3737 / Grad Norm: 0.5216 / Grad Diff: 54.6804 / Time: 7.05s
======================================================================================================

round 137 local learning rate = 0.01

>>> Round:  138 / Acc: 88.928% / Loss: 0.3725 / Grad Norm: 0.5337 / Grad Diff: 54.0444 / Time: 7.42s
======================================================================================================

round 138 local learning rate = 0.01

>>> Round:  139 / Acc: 89.006% / Loss: 0.3698 / Grad Norm: 0.4332 / Grad Diff: 53.8544 / Time: 7.77s
======================================================================================================

round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 89.017% / Loss: 0.3684 / Grad Norm: 0.4653 / Grad Diff: 53.6038 / Time: 8.98s
======================================================================================================

= Test = round: 140 / acc: 90.040% / loss: 0.3403 / Time: 0.64s
======================================================================================================

round 140 local learning rate = 0.01

>>> Round:  141 / Acc: 89.079% / Loss: 0.3670 / Grad Norm: 0.4698 / Grad Diff: 53.3413 / Time: 7.72s
======================================================================================================

round 141 local learning rate = 0.01

>>> Round:  142 / Acc: 89.103% / Loss: 0.3657 / Grad Norm: 0.5245 / Grad Diff: 53.0551 / Time: 7.47s
======================================================================================================

round 142 local learning rate = 0.01

>>> Round:  143 / Acc: 89.155% / Loss: 0.3635 / Grad Norm: 0.4759 / Grad Diff: 53.0020 / Time: 7.49s
======================================================================================================

round 143 local learning rate = 0.01

>>> Round:  144 / Acc: 89.205% / Loss: 0.3623 / Grad Norm: 0.4906 / Grad Diff: 52.5722 / Time: 7.49s
======================================================================================================

round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 89.208% / Loss: 0.3606 / Grad Norm: 0.4795 / Grad Diff: 52.0858 / Time: 7.52s
======================================================================================================

= Test = round: 145 / acc: 90.290% / loss: 0.3325 / Time: 0.61s
======================================================================================================

round 145 local learning rate = 0.01

>>> Round:  146 / Acc: 89.301% / Loss: 0.3589 / Grad Norm: 0.4329 / Grad Diff: 51.8159 / Time: 7.36s
======================================================================================================

round 146 local learning rate = 0.01

>>> Round:  147 / Acc: 89.373% / Loss: 0.3571 / Grad Norm: 0.4875 / Grad Diff: 52.1124 / Time: 7.56s
======================================================================================================

round 147 local learning rate = 0.01

>>> Round:  148 / Acc: 89.443% / Loss: 0.3556 / Grad Norm: 0.4348 / Grad Diff: 51.4784 / Time: 7.38s
======================================================================================================

round 148 local learning rate = 0.01

>>> Round:  149 / Acc: 89.465% / Loss: 0.3542 / Grad Norm: 0.3931 / Grad Diff: 50.6818 / Time: 9.56s
======================================================================================================

round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 89.474% / Loss: 0.3530 / Grad Norm: 0.4367 / Grad Diff: 50.4380 / Time: 7.62s
======================================================================================================

= Test = round: 150 / acc: 90.480% / loss: 0.3255 / Time: 0.68s
======================================================================================================

round 150 local learning rate = 0.01

>>> Round:  151 / Acc: 89.528% / Loss: 0.3516 / Grad Norm: 0.4772 / Grad Diff: 50.5644 / Time: 7.38s
======================================================================================================

round 151 local learning rate = 0.01

>>> Round:  152 / Acc: 89.522% / Loss: 0.3506 / Grad Norm: 0.4897 / Grad Diff: 49.7874 / Time: 7.32s
======================================================================================================

round 152 local learning rate = 0.01

>>> Round:  153 / Acc: 89.601% / Loss: 0.3491 / Grad Norm: 0.4826 / Grad Diff: 49.5338 / Time: 7.44s
======================================================================================================

round 153 local learning rate = 0.01

>>> Round:  154 / Acc: 89.651% / Loss: 0.3475 / Grad Norm: 0.4758 / Grad Diff: 49.5274 / Time: 6.74s
======================================================================================================

round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 89.631% / Loss: 0.3463 / Grad Norm: 0.4445 / Grad Diff: 48.6969 / Time: 7.50s
======================================================================================================

= Test = round: 155 / acc: 90.580% / loss: 0.3191 / Time: 0.61s
======================================================================================================

round 155 local learning rate = 0.01

>>> Round:  156 / Acc: 89.756% / Loss: 0.3445 / Grad Norm: 0.4101 / Grad Diff: 48.5330 / Time: 8.41s
======================================================================================================

round 156 local learning rate = 0.01

>>> Round:  157 / Acc: 89.793% / Loss: 0.3433 / Grad Norm: 0.4479 / Grad Diff: 48.2203 / Time: 7.46s
======================================================================================================

round 157 local learning rate = 0.01

>>> Round:  158 / Acc: 89.779% / Loss: 0.3424 / Grad Norm: 0.4537 / Grad Diff: 47.5036 / Time: 7.69s
======================================================================================================

round 158 local learning rate = 0.01

>>> Round:  159 / Acc: 89.875% / Loss: 0.3404 / Grad Norm: 0.4102 / Grad Diff: 47.2047 / Time: 7.51s
======================================================================================================

round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 89.924% / Loss: 0.3394 / Grad Norm: 0.4290 / Grad Diff: 46.9673 / Time: 7.64s
======================================================================================================

= Test = round: 160 / acc: 90.800% / loss: 0.3125 / Time: 0.61s
======================================================================================================

round 160 local learning rate = 0.01

>>> Round:  161 / Acc: 90.013% / Loss: 0.3379 / Grad Norm: 0.4479 / Grad Diff: 46.9900 / Time: 7.47s
======================================================================================================

round 161 local learning rate = 0.01

>>> Round:  162 / Acc: 90.044% / Loss: 0.3364 / Grad Norm: 0.4373 / Grad Diff: 46.5743 / Time: 7.38s
======================================================================================================

round 162 local learning rate = 0.01

>>> Round:  163 / Acc: 90.004% / Loss: 0.3354 / Grad Norm: 0.5096 / Grad Diff: 46.5671 / Time: 7.42s
======================================================================================================

round 163 local learning rate = 0.01

>>> Round:  164 / Acc: 90.142% / Loss: 0.3334 / Grad Norm: 0.4480 / Grad Diff: 46.2833 / Time: 7.44s
======================================================================================================

round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 90.133% / Loss: 0.3324 / Grad Norm: 0.4798 / Grad Diff: 46.0815 / Time: 7.57s
======================================================================================================

= Test = round: 165 / acc: 90.860% / loss: 0.3060 / Time: 0.60s
======================================================================================================

round 165 local learning rate = 0.01

>>> Round:  166 / Acc: 90.173% / Loss: 0.3307 / Grad Norm: 0.4610 / Grad Diff: 46.0219 / Time: 7.49s
======================================================================================================

round 166 local learning rate = 0.01

>>> Round:  167 / Acc: 90.234% / Loss: 0.3293 / Grad Norm: 0.3869 / Grad Diff: 45.3608 / Time: 7.47s
======================================================================================================

round 167 local learning rate = 0.01

>>> Round:  168 / Acc: 90.214% / Loss: 0.3288 / Grad Norm: 0.5342 / Grad Diff: 45.5360 / Time: 7.74s
======================================================================================================

round 168 local learning rate = 0.01

>>> Round:  169 / Acc: 90.284% / Loss: 0.3268 / Grad Norm: 0.4531 / Grad Diff: 45.2448 / Time: 7.69s
======================================================================================================

round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 90.328% / Loss: 0.3255 / Grad Norm: 0.4240 / Grad Diff: 44.5961 / Time: 7.31s
======================================================================================================

= Test = round: 170 / acc: 91.080% / loss: 0.2993 / Time: 0.60s
======================================================================================================

round 170 local learning rate = 0.01

>>> Round:  171 / Acc: 90.397% / Loss: 0.3240 / Grad Norm: 0.4027 / Grad Diff: 44.4027 / Time: 7.47s
======================================================================================================

round 171 local learning rate = 0.01

>>> Round:  172 / Acc: 90.387% / Loss: 0.3229 / Grad Norm: 0.4017 / Grad Diff: 44.0134 / Time: 7.45s
======================================================================================================

round 172 local learning rate = 0.01

>>> Round:  173 / Acc: 90.391% / Loss: 0.3219 / Grad Norm: 0.5042 / Grad Diff: 44.2773 / Time: 7.42s
======================================================================================================

round 173 local learning rate = 0.01

>>> Round:  174 / Acc: 90.421% / Loss: 0.3209 / Grad Norm: 0.4872 / Grad Diff: 43.9412 / Time: 7.35s
======================================================================================================

round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 90.452% / Loss: 0.3192 / Grad Norm: 0.4111 / Grad Diff: 43.3473 / Time: 7.38s
======================================================================================================

= Test = round: 175 / acc: 91.190% / loss: 0.2942 / Time: 0.68s
======================================================================================================

round 175 local learning rate = 0.01

>>> Round:  176 / Acc: 90.541% / Loss: 0.3182 / Grad Norm: 0.4554 / Grad Diff: 43.2193 / Time: 7.41s
======================================================================================================

round 176 local learning rate = 0.01

>>> Round:  177 / Acc: 90.522% / Loss: 0.3173 / Grad Norm: 0.4642 / Grad Diff: 42.7893 / Time: 7.44s
======================================================================================================

round 177 local learning rate = 0.01

>>> Round:  178 / Acc: 90.616% / Loss: 0.3157 / Grad Norm: 0.4285 / Grad Diff: 42.7612 / Time: 7.41s
======================================================================================================

round 178 local learning rate = 0.01

>>> Round:  179 / Acc: 90.642% / Loss: 0.3147 / Grad Norm: 0.4499 / Grad Diff: 42.5776 / Time: 7.44s
======================================================================================================

round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 90.686% / Loss: 0.3139 / Grad Norm: 0.4367 / Grad Diff: 41.9959 / Time: 8.75s
======================================================================================================

= Test = round: 180 / acc: 91.350% / loss: 0.2884 / Time: 0.63s
======================================================================================================

round 180 local learning rate = 0.01

>>> Round:  181 / Acc: 90.703% / Loss: 0.3122 / Grad Norm: 0.4304 / Grad Diff: 42.0844 / Time: 7.65s
======================================================================================================

round 181 local learning rate = 0.01

>>> Round:  182 / Acc: 90.718% / Loss: 0.3109 / Grad Norm: 0.4313 / Grad Diff: 41.9694 / Time: 7.45s
======================================================================================================

round 182 local learning rate = 0.01

>>> Round:  183 / Acc: 90.749% / Loss: 0.3101 / Grad Norm: 0.4641 / Grad Diff: 41.7274 / Time: 7.47s
======================================================================================================

round 183 local learning rate = 0.01

>>> Round:  184 / Acc: 90.790% / Loss: 0.3087 / Grad Norm: 0.3646 / Grad Diff: 40.9890 / Time: 7.44s
======================================================================================================

round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 90.838% / Loss: 0.3069 / Grad Norm: 0.3521 / Grad Diff: 41.3280 / Time: 7.50s
======================================================================================================

= Test = round: 185 / acc: 91.530% / loss: 0.2821 / Time: 0.61s
======================================================================================================

round 185 local learning rate = 0.01

>>> Round:  186 / Acc: 90.871% / Loss: 0.3064 / Grad Norm: 0.4121 / Grad Diff: 40.8661 / Time: 7.54s
======================================================================================================

round 186 local learning rate = 0.01

>>> Round:  187 / Acc: 90.893% / Loss: 0.3049 / Grad Norm: 0.3551 / Grad Diff: 40.7407 / Time: 7.51s
======================================================================================================

round 187 local learning rate = 0.01

>>> Round:  188 / Acc: 90.948% / Loss: 0.3038 / Grad Norm: 0.3725 / Grad Diff: 40.6661 / Time: 7.51s
======================================================================================================

round 188 local learning rate = 0.01

>>> Round:  189 / Acc: 90.941% / Loss: 0.3031 / Grad Norm: 0.4081 / Grad Diff: 40.1825 / Time: 7.52s
======================================================================================================

round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 91.000% / Loss: 0.3022 / Grad Norm: 0.4434 / Grad Diff: 40.0609 / Time: 7.37s
======================================================================================================

= Test = round: 190 / acc: 91.780% / loss: 0.2776 / Time: 0.64s
======================================================================================================

round 190 local learning rate = 0.01

>>> Round:  191 / Acc: 90.959% / Loss: 0.3008 / Grad Norm: 0.4164 / Grad Diff: 40.0434 / Time: 7.40s
======================================================================================================

round 191 local learning rate = 0.01

>>> Round:  192 / Acc: 91.046% / Loss: 0.2990 / Grad Norm: 0.3542 / Grad Diff: 39.8855 / Time: 7.69s
======================================================================================================

round 192 local learning rate = 0.01

>>> Round:  193 / Acc: 91.057% / Loss: 0.2986 / Grad Norm: 0.5091 / Grad Diff: 40.0853 / Time: 7.82s
======================================================================================================

round 193 local learning rate = 0.01

>>> Round:  194 / Acc: 91.074% / Loss: 0.2969 / Grad Norm: 0.4306 / Grad Diff: 39.9954 / Time: 7.64s
======================================================================================================

round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 91.140% / Loss: 0.2955 / Grad Norm: 0.3698 / Grad Diff: 39.7287 / Time: 7.59s
======================================================================================================

= Test = round: 195 / acc: 91.850% / loss: 0.2714 / Time: 0.60s
======================================================================================================

round 195 local learning rate = 0.01

>>> Round:  196 / Acc: 91.137% / Loss: 0.2946 / Grad Norm: 0.3676 / Grad Diff: 39.2916 / Time: 7.54s
======================================================================================================

round 196 local learning rate = 0.01

>>> Round:  197 / Acc: 91.201% / Loss: 0.2936 / Grad Norm: 0.3788 / Grad Diff: 39.0111 / Time: 7.34s
======================================================================================================

round 197 local learning rate = 0.01

>>> Round:  198 / Acc: 91.251% / Loss: 0.2933 / Grad Norm: 0.3903 / Grad Diff: 38.2423 / Time: 7.36s
======================================================================================================

round 198 local learning rate = 0.01

>>> Round:  199 / Acc: 91.284% / Loss: 0.2926 / Grad Norm: 0.4266 / Grad Diff: 38.0625 / Time: 7.40s
======================================================================================================

round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 91.321% / Loss: 0.2909 / Grad Norm: 0.3687 / Grad Diff: 38.1334 / Time: 7.36s
======================================================================================================

= Test = round: 200 / acc: 92.040% / loss: 0.2670 / Time: 0.59s
======================================================================================================

>>> Training model_target_only
Epoch: 001, Train_loss: 0.6258, Train_acc: 0.8127, Test_loss: 0.6346, Test_acc: 0.8114
Epoch: 006, Train_loss: 0.3571, Train_acc: 0.8834, Test_loss: 0.4376, Test_acc: 0.8579
Epoch: 011, Train_loss: 0.2573, Train_acc: 0.9144, Test_loss: 0.4198, Test_acc: 0.8700
Epoch: 016, Train_loss: 0.1884, Train_acc: 0.9381, Test_loss: 0.4695, Test_acc: 0.8679
Epoch: 021, Train_loss: 0.1459, Train_acc: 0.9506, Test_loss: 0.5568, Test_acc: 0.8687
Epoch: 026, Train_loss: 0.1113, Train_acc: 0.9622, Test_loss: 0.6195, Test_acc: 0.8646
Epoch: 031, Train_loss: 0.0898, Train_acc: 0.9707, Test_loss: 0.7386, Test_acc: 0.8642
Epoch: 036, Train_loss: 0.0699, Train_acc: 0.9764, Test_loss: 0.8334, Test_acc: 0.8648
Epoch: 041, Train_loss: 0.0716, Train_acc: 0.9763, Test_loss: 0.9490, Test_acc: 0.8617
Epoch: 046, Train_loss: 0.0589, Train_acc: 0.9806, Test_loss: 1.0548, Test_acc: 0.8623
Epoch: 051, Train_loss: 0.0567, Train_acc: 0.9804, Test_loss: 1.1337, Test_acc: 0.8593
Epoch: 056, Train_loss: 0.0525, Train_acc: 0.9818, Test_loss: 1.2163, Test_acc: 0.8589
Epoch: 061, Train_loss: 0.0538, Train_acc: 0.9824, Test_loss: 1.3410, Test_acc: 0.8581
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230917023307_model_target_only.pt.
Model saved at ./models/ft_checkpoints/20230917023307_model_target_only.pt.
>>> Fine-tuning done!
>>> Training model_ft
Epoch: 001, Train_loss: 1.1870, Train_acc: 0.6283, Test_loss: 1.1604, Test_acc: 0.6366
Epoch: 006, Train_loss: 0.9249, Train_acc: 0.7064, Test_loss: 0.9317, Test_acc: 0.6995
Epoch: 011, Train_loss: 0.8428, Train_acc: 0.7357, Test_loss: 0.8655, Test_acc: 0.7287
Epoch: 016, Train_loss: 0.7998, Train_acc: 0.7488, Test_loss: 0.8423, Test_acc: 0.7365
Epoch: 021, Train_loss: 0.7617, Train_acc: 0.7615, Test_loss: 0.8085, Test_acc: 0.7470
Epoch: 026, Train_loss: 0.7538, Train_acc: 0.7621, Test_loss: 0.8071, Test_acc: 0.7468
Epoch: 031, Train_loss: 0.7481, Train_acc: 0.7612, Test_loss: 0.8040, Test_acc: 0.7466
Epoch: 036, Train_loss: 0.7161, Train_acc: 0.7734, Test_loss: 0.7861, Test_acc: 0.7538
Epoch: 041, Train_loss: 0.7065, Train_acc: 0.7747, Test_loss: 0.7842, Test_acc: 0.7536
Epoch: 046, Train_loss: 0.6954, Train_acc: 0.7779, Test_loss: 0.7761, Test_acc: 0.7565
Epoch: 051, Train_loss: 0.6832, Train_acc: 0.7832, Test_loss: 0.7706, Test_acc: 0.7614
Epoch: 056, Train_loss: 0.6900, Train_acc: 0.7780, Test_loss: 0.7851, Test_acc: 0.7528
Epoch: 061, Train_loss: 0.6787, Train_acc: 0.7831, Test_loss: 0.7741, Test_acc: 0.7592
Epoch: 066, Train_loss: 0.6659, Train_acc: 0.7852, Test_loss: 0.7677, Test_acc: 0.7574
Epoch: 071, Train_loss: 0.6626, Train_acc: 0.7871, Test_loss: 0.7682, Test_acc: 0.7591
Epoch: 076, Train_loss: 0.6619, Train_acc: 0.7850, Test_loss: 0.7720, Test_acc: 0.7594
Epoch: 081, Train_loss: 0.6499, Train_acc: 0.7909, Test_loss: 0.7673, Test_acc: 0.7611
Epoch: 086, Train_loss: 0.6527, Train_acc: 0.7883, Test_loss: 0.7693, Test_acc: 0.7574
Epoch: 091, Train_loss: 0.6401, Train_acc: 0.7936, Test_loss: 0.7646, Test_acc: 0.7660
Epoch: 096, Train_loss: 0.6418, Train_acc: 0.7919, Test_loss: 0.7684, Test_acc: 0.7597
Epoch: 101, Train_loss: 0.6391, Train_acc: 0.7930, Test_loss: 0.7702, Test_acc: 0.7618
Epoch: 106, Train_loss: 0.6300, Train_acc: 0.7943, Test_loss: 0.7632, Test_acc: 0.7610
Epoch: 111, Train_loss: 0.6428, Train_acc: 0.7914, Test_loss: 0.7840, Test_acc: 0.7518
Epoch: 116, Train_loss: 0.6276, Train_acc: 0.7969, Test_loss: 0.7718, Test_acc: 0.7618
Epoch: 121, Train_loss: 0.6296, Train_acc: 0.7956, Test_loss: 0.7673, Test_acc: 0.7588
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230917023307_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230917023307_model_ft.pt.
>>> Fine-tuning done!
>>> Training model_random
Epoch: 001, Train_loss: 1.8433, Train_acc: 0.4121, Test_loss: 1.8443, Test_acc: 0.4114
Epoch: 006, Train_loss: 1.4149, Train_acc: 0.5371, Test_loss: 1.4211, Test_acc: 0.5316
Epoch: 011, Train_loss: 1.3050, Train_acc: 0.5741, Test_loss: 1.3116, Test_acc: 0.5679
Epoch: 016, Train_loss: 1.2308, Train_acc: 0.5995, Test_loss: 1.2395, Test_acc: 0.5928
Epoch: 021, Train_loss: 1.1781, Train_acc: 0.6156, Test_loss: 1.1887, Test_acc: 0.6087
Epoch: 026, Train_loss: 1.1401, Train_acc: 0.6280, Test_loss: 1.1549, Test_acc: 0.6202
Epoch: 031, Train_loss: 1.1059, Train_acc: 0.6378, Test_loss: 1.1239, Test_acc: 0.6280
Epoch: 036, Train_loss: 1.0856, Train_acc: 0.6448, Test_loss: 1.1087, Test_acc: 0.6307
Epoch: 041, Train_loss: 1.0592, Train_acc: 0.6526, Test_loss: 1.0884, Test_acc: 0.6387
Epoch: 046, Train_loss: 1.0442, Train_acc: 0.6566, Test_loss: 1.0768, Test_acc: 0.6419
Epoch: 051, Train_loss: 1.0253, Train_acc: 0.6622, Test_loss: 1.0644, Test_acc: 0.6488
Epoch: 056, Train_loss: 1.0175, Train_acc: 0.6643, Test_loss: 1.0575, Test_acc: 0.6494
Epoch: 061, Train_loss: 1.0060, Train_acc: 0.6685, Test_loss: 1.0529, Test_acc: 0.6543
Epoch: 066, Train_loss: 0.9961, Train_acc: 0.6715, Test_loss: 1.0469, Test_acc: 0.6561
Epoch: 071, Train_loss: 0.9870, Train_acc: 0.6758, Test_loss: 1.0413, Test_acc: 0.6567
Epoch: 076, Train_loss: 0.9740, Train_acc: 0.6825, Test_loss: 1.0347, Test_acc: 0.6605
Epoch: 081, Train_loss: 0.9677, Train_acc: 0.6803, Test_loss: 1.0282, Test_acc: 0.6630
Epoch: 086, Train_loss: 0.9651, Train_acc: 0.6823, Test_loss: 1.0310, Test_acc: 0.6641
Epoch: 091, Train_loss: 0.9567, Train_acc: 0.6862, Test_loss: 1.0258, Test_acc: 0.6643
Epoch: 096, Train_loss: 0.9593, Train_acc: 0.6842, Test_loss: 1.0329, Test_acc: 0.6630
Epoch: 101, Train_loss: 0.9426, Train_acc: 0.6900, Test_loss: 1.0213, Test_acc: 0.6670
Epoch: 106, Train_loss: 0.9379, Train_acc: 0.6910, Test_loss: 1.0224, Test_acc: 0.6640
Epoch: 111, Train_loss: 0.9349, Train_acc: 0.6928, Test_loss: 1.0221, Test_acc: 0.6660
Epoch: 116, Train_loss: 0.9312, Train_acc: 0.6932, Test_loss: 1.0197, Test_acc: 0.6686
Epoch: 121, Train_loss: 0.9295, Train_acc: 0.6970, Test_loss: 1.0211, Test_acc: 0.6688
Epoch: 126, Train_loss: 0.9254, Train_acc: 0.6968, Test_loss: 1.0207, Test_acc: 0.6689
Epoch: 131, Train_loss: 0.9198, Train_acc: 0.6984, Test_loss: 1.0195, Test_acc: 0.6684
Epoch: 136, Train_loss: 0.9179, Train_acc: 0.6988, Test_loss: 1.0213, Test_acc: 0.6691
Epoch: 141, Train_loss: 0.9138, Train_acc: 0.6995, Test_loss: 1.0171, Test_acc: 0.6698
Epoch: 146, Train_loss: 0.9134, Train_acc: 0.6991, Test_loss: 1.0197, Test_acc: 0.6653
Epoch: 151, Train_loss: 0.9097, Train_acc: 0.7008, Test_loss: 1.0211, Test_acc: 0.6695
Epoch: 156, Train_loss: 0.9085, Train_acc: 0.7009, Test_loss: 1.0197, Test_acc: 0.6697
Epoch: 161, Train_loss: 0.9040, Train_acc: 0.7027, Test_loss: 1.0206, Test_acc: 0.6705
Epoch: 166, Train_loss: 0.9032, Train_acc: 0.7030, Test_loss: 1.0168, Test_acc: 0.6727
Epoch: 171, Train_loss: 0.9000, Train_acc: 0.7057, Test_loss: 1.0163, Test_acc: 0.6679
Epoch: 176, Train_loss: 0.8959, Train_acc: 0.7052, Test_loss: 1.0182, Test_acc: 0.6724
Epoch: 181, Train_loss: 0.8992, Train_acc: 0.7043, Test_loss: 1.0211, Test_acc: 0.6699
Epoch: 186, Train_loss: 0.8921, Train_acc: 0.7073, Test_loss: 1.0206, Test_acc: 0.6689
Epoch: 191, Train_loss: 0.8922, Train_acc: 0.7070, Test_loss: 1.0259, Test_acc: 0.6673
Epoch: 196, Train_loss: 0.8915, Train_acc: 0.7072, Test_loss: 1.0222, Test_acc: 0.6713
Model saved at ./models/ft_checkpoints/20230917023307_model_random.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_target_only: [0.03982551281320263, 0.9869832714699751, 1.1987082485079354, 0.8624597266970336]
model_ft: [0.6231168070301517, 0.7969695428891036, 0.7612791904051189, 0.7670258860126653]
model_random: [0.8878536025349709, 0.7070558126133455, 1.0234127884480095, 0.6714809465614932]
model_source_only: [2.5309759496448425, 0.4280435924814834, 2.5612607147147717, 0.42973002999666704]
fl_test_acc_mean 0.9203
model_source_only_test_acc_mean 0.42973002999666704
model_ft_test_acc_mean 0.7670258860126653
model_target_only_test_acc_mean 0.8624597266970336
model_random_test_acc_mean 0.6714809465614932
