nohup: ignoring input
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 64
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 10
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : True
	       reg_J_coef : 0.005
	           repeat : 1
	             seed : 123
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230917000118
FL pretrained model will be saved at ./models/lenet_mnist_20230917000118.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 10.555% / Loss: 2.3004 / Grad Norm: 0.1764 / Grad Diff: 1.4798 / Time: 7.35s
======================================================================================================

= Test = round: 0 / acc: 10.410% / loss: 2.2989 / Time: 0.63s
======================================================================================================

round 0 local learning rate = 0.01

>>> Round:    1 / Acc: 10.526% / Loss: 2.2977 / Grad Norm: 0.1967 / Grad Diff: 1.8005 / Time: 7.34s
======================================================================================================

round 1 local learning rate = 0.01

>>> Round:    2 / Acc: 11.839% / Loss: 2.2943 / Grad Norm: 0.2214 / Grad Diff: 2.3453 / Time: 7.45s
======================================================================================================

round 2 local learning rate = 0.01

>>> Round:    3 / Acc: 13.703% / Loss: 2.2903 / Grad Norm: 0.2496 / Grad Diff: 3.3100 / Time: 7.40s
======================================================================================================

round 3 local learning rate = 0.01

>>> Round:    4 / Acc: 11.129% / Loss: 2.2856 / Grad Norm: 0.3024 / Grad Diff: 5.2536 / Time: 7.48s
======================================================================================================

round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 10.170% / Loss: 2.2808 / Grad Norm: 0.4212 / Grad Diff: 9.8218 / Time: 8.65s
======================================================================================================

= Test = round: 5 / acc: 10.590% / loss: 2.2791 / Time: 0.60s
======================================================================================================

round 5 local learning rate = 0.01

>>> Round:    6 / Acc: 11.526% / Loss: 2.2797 / Grad Norm: 0.7349 / Grad Diff: 21.7151 / Time: 7.48s
======================================================================================================

round 6 local learning rate = 0.01

>>> Round:    7 / Acc: 15.624% / Loss: 2.2716 / Grad Norm: 1.2569 / Grad Diff: 51.1136 / Time: 7.57s
======================================================================================================

round 7 local learning rate = 0.01

>>> Round:    8 / Acc: 18.118% / Loss: 2.2364 / Grad Norm: 1.6015 / Grad Diff: 103.6354 / Time: 7.47s
======================================================================================================

round 8 local learning rate = 0.01

>>> Round:    9 / Acc: 25.232% / Loss: 2.1771 / Grad Norm: 1.3881 / Grad Diff: 164.2670 / Time: 7.46s
======================================================================================================

round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 38.889% / Loss: 2.1265 / Grad Norm: 1.0671 / Grad Diff: 185.1117 / Time: 7.60s
======================================================================================================

= Test = round: 10 / acc: 38.750% / loss: 2.1216 / Time: 0.82s
======================================================================================================

round 10 local learning rate = 0.01

>>> Round:   11 / Acc: 50.697% / Loss: 2.0828 / Grad Norm: 1.0378 / Grad Diff: 191.4641 / Time: 8.28s
======================================================================================================

round 11 local learning rate = 0.01

>>> Round:   12 / Acc: 54.788% / Loss: 2.0374 / Grad Norm: 1.0797 / Grad Diff: 192.5704 / Time: 7.60s
======================================================================================================

round 12 local learning rate = 0.01

>>> Round:   13 / Acc: 61.792% / Loss: 1.9884 / Grad Norm: 1.1277 / Grad Diff: 192.3209 / Time: 7.48s
======================================================================================================

round 13 local learning rate = 0.01

>>> Round:   14 / Acc: 65.234% / Loss: 1.9333 / Grad Norm: 1.1539 / Grad Diff: 197.9193 / Time: 7.40s
======================================================================================================

round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 66.605% / Loss: 1.8756 / Grad Norm: 1.2106 / Grad Diff: 195.4565 / Time: 7.03s
======================================================================================================

= Test = round: 15 / acc: 68.110% / loss: 1.8621 / Time: 0.63s
======================================================================================================

round 15 local learning rate = 0.01

>>> Round:   16 / Acc: 68.338% / Loss: 1.8145 / Grad Norm: 1.3319 / Grad Diff: 193.1390 / Time: 7.64s
======================================================================================================

round 16 local learning rate = 0.01

>>> Round:   17 / Acc: 69.777% / Loss: 1.7466 / Grad Norm: 1.4162 / Grad Diff: 195.4191 / Time: 7.32s
======================================================================================================

round 17 local learning rate = 0.01

>>> Round:   18 / Acc: 69.282% / Loss: 1.6751 / Grad Norm: 1.4690 / Grad Diff: 198.7383 / Time: 7.43s
======================================================================================================

round 18 local learning rate = 0.01

>>> Round:   19 / Acc: 70.692% / Loss: 1.6040 / Grad Norm: 1.4767 / Grad Diff: 198.3834 / Time: 7.46s
======================================================================================================

round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 71.517% / Loss: 1.5327 / Grad Norm: 1.4711 / Grad Diff: 199.1736 / Time: 7.42s
======================================================================================================

= Test = round: 20 / acc: 73.410% / loss: 1.5083 / Time: 0.61s
======================================================================================================

round 20 local learning rate = 0.01

>>> Round:   21 / Acc: 72.087% / Loss: 1.4657 / Grad Norm: 1.5109 / Grad Diff: 196.2054 / Time: 7.38s
======================================================================================================

round 21 local learning rate = 0.01

>>> Round:   22 / Acc: 72.688% / Loss: 1.4008 / Grad Norm: 1.4869 / Grad Diff: 191.3831 / Time: 7.43s
======================================================================================================

round 22 local learning rate = 0.01

>>> Round:   23 / Acc: 72.899% / Loss: 1.3380 / Grad Norm: 1.5254 / Grad Diff: 189.1772 / Time: 6.91s
======================================================================================================

round 23 local learning rate = 0.01

>>> Round:   24 / Acc: 73.323% / Loss: 1.2784 / Grad Norm: 1.4957 / Grad Diff: 188.6832 / Time: 7.45s
======================================================================================================

round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 73.177% / Loss: 1.2254 / Grad Norm: 1.5418 / Grad Diff: 186.9304 / Time: 7.02s
======================================================================================================

= Test = round: 25 / acc: 74.840% / loss: 1.1925 / Time: 0.61s
======================================================================================================

round 25 local learning rate = 0.01

>>> Round:   26 / Acc: 73.734% / Loss: 1.1772 / Grad Norm: 1.4857 / Grad Diff: 180.3554 / Time: 7.57s
======================================================================================================

round 26 local learning rate = 0.01

>>> Round:   27 / Acc: 74.585% / Loss: 1.1318 / Grad Norm: 1.4331 / Grad Diff: 176.0376 / Time: 8.25s
======================================================================================================

round 27 local learning rate = 0.01

>>> Round:   28 / Acc: 74.884% / Loss: 1.0910 / Grad Norm: 1.4366 / Grad Diff: 170.7788 / Time: 8.62s
======================================================================================================

round 28 local learning rate = 0.01

>>> Round:   29 / Acc: 75.548% / Loss: 1.0521 / Grad Norm: 1.3575 / Grad Diff: 166.5535 / Time: 7.39s
======================================================================================================

round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 75.576% / Loss: 1.0178 / Grad Norm: 1.4018 / Grad Diff: 161.9735 / Time: 7.60s
======================================================================================================

= Test = round: 30 / acc: 77.480% / loss: 0.9791 / Time: 0.87s
======================================================================================================

round 30 local learning rate = 0.01

>>> Round:   31 / Acc: 76.151% / Loss: 0.9839 / Grad Norm: 1.3380 / Grad Diff: 158.9443 / Time: 9.17s
======================================================================================================

round 31 local learning rate = 0.01

>>> Round:   32 / Acc: 76.577% / Loss: 0.9537 / Grad Norm: 1.3035 / Grad Diff: 155.5749 / Time: 7.45s
======================================================================================================

round 32 local learning rate = 0.01

>>> Round:   33 / Acc: 77.022% / Loss: 0.9278 / Grad Norm: 1.2746 / Grad Diff: 149.5918 / Time: 7.69s
======================================================================================================

round 33 local learning rate = 0.01

>>> Round:   34 / Acc: 77.559% / Loss: 0.9021 / Grad Norm: 1.3526 / Grad Diff: 146.8008 / Time: 7.44s
======================================================================================================

round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 77.731% / Loss: 0.8789 / Grad Norm: 1.2674 / Grad Diff: 141.4262 / Time: 7.96s
======================================================================================================

= Test = round: 35 / acc: 79.140% / loss: 0.8394 / Time: 0.62s
======================================================================================================

round 35 local learning rate = 0.01

>>> Round:   36 / Acc: 78.332% / Loss: 0.8533 / Grad Norm: 1.1915 / Grad Diff: 141.3030 / Time: 7.41s
======================================================================================================

round 36 local learning rate = 0.01

>>> Round:   37 / Acc: 78.635% / Loss: 0.8332 / Grad Norm: 1.2374 / Grad Diff: 138.6593 / Time: 7.38s
======================================================================================================

round 37 local learning rate = 0.01

>>> Round:   38 / Acc: 78.911% / Loss: 0.8140 / Grad Norm: 1.2343 / Grad Diff: 135.6090 / Time: 7.36s
======================================================================================================

round 38 local learning rate = 0.01

>>> Round:   39 / Acc: 79.181% / Loss: 0.7954 / Grad Norm: 1.1599 / Grad Diff: 131.5913 / Time: 9.42s
======================================================================================================

round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 79.393% / Loss: 0.7812 / Grad Norm: 1.2458 / Grad Diff: 126.9494 / Time: 7.31s
======================================================================================================

= Test = round: 40 / acc: 81.200% / loss: 0.7407 / Time: 0.63s
======================================================================================================

round 40 local learning rate = 0.01

>>> Round:   41 / Acc: 79.941% / Loss: 0.7598 / Grad Norm: 1.1452 / Grad Diff: 128.7537 / Time: 7.50s
======================================================================================================

round 41 local learning rate = 0.01

>>> Round:   42 / Acc: 80.251% / Loss: 0.7434 / Grad Norm: 1.1230 / Grad Diff: 126.9915 / Time: 7.47s
======================================================================================================

round 42 local learning rate = 0.01

>>> Round:   43 / Acc: 80.491% / Loss: 0.7304 / Grad Norm: 1.0837 / Grad Diff: 123.5744 / Time: 7.46s
======================================================================================================

round 43 local learning rate = 0.01

>>> Round:   44 / Acc: 80.832% / Loss: 0.7152 / Grad Norm: 1.0075 / Grad Diff: 122.3630 / Time: 7.56s
======================================================================================================

round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 81.033% / Loss: 0.7052 / Grad Norm: 1.1175 / Grad Diff: 118.7072 / Time: 7.39s
======================================================================================================

= Test = round: 45 / acc: 82.460% / loss: 0.6663 / Time: 0.63s
======================================================================================================

round 45 local learning rate = 0.01

>>> Round:   46 / Acc: 81.279% / Loss: 0.6918 / Grad Norm: 1.1214 / Grad Diff: 118.2692 / Time: 7.28s
======================================================================================================

round 46 local learning rate = 0.01

>>> Round:   47 / Acc: 81.550% / Loss: 0.6812 / Grad Norm: 1.0007 / Grad Diff: 113.4906 / Time: 6.84s
======================================================================================================

round 47 local learning rate = 0.01

>>> Round:   48 / Acc: 81.771% / Loss: 0.6704 / Grad Norm: 1.0322 / Grad Diff: 111.7936 / Time: 7.33s
======================================================================================================

round 48 local learning rate = 0.01

>>> Round:   49 / Acc: 81.891% / Loss: 0.6598 / Grad Norm: 1.0347 / Grad Diff: 109.8781 / Time: 7.38s
======================================================================================================

round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 82.218% / Loss: 0.6470 / Grad Norm: 0.9403 / Grad Diff: 109.7369 / Time: 7.31s
======================================================================================================

= Test = round: 50 / acc: 83.800% / loss: 0.6084 / Time: 0.61s
======================================================================================================

round 50 local learning rate = 0.01

>>> Round:   51 / Acc: 82.589% / Loss: 0.6361 / Grad Norm: 0.8382 / Grad Diff: 108.0685 / Time: 6.91s
======================================================================================================

round 51 local learning rate = 0.01

>>> Round:   52 / Acc: 82.792% / Loss: 0.6282 / Grad Norm: 0.8516 / Grad Diff: 105.3390 / Time: 6.86s
======================================================================================================

round 52 local learning rate = 0.01

>>> Round:   53 / Acc: 82.923% / Loss: 0.6203 / Grad Norm: 0.9001 / Grad Diff: 103.6895 / Time: 6.89s
======================================================================================================

round 53 local learning rate = 0.01

>>> Round:   54 / Acc: 82.917% / Loss: 0.6140 / Grad Norm: 1.0460 / Grad Diff: 102.5515 / Time: 7.43s
======================================================================================================

round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 83.048% / Loss: 0.6054 / Grad Norm: 1.0596 / Grad Diff: 101.9615 / Time: 7.40s
======================================================================================================

= Test = round: 55 / acc: 84.540% / loss: 0.5687 / Time: 0.60s
======================================================================================================

round 55 local learning rate = 0.01

>>> Round:   56 / Acc: 83.354% / Loss: 0.5962 / Grad Norm: 0.9399 / Grad Diff: 99.9162 / Time: 7.51s
======================================================================================================

round 56 local learning rate = 0.01

>>> Round:   57 / Acc: 83.542% / Loss: 0.5886 / Grad Norm: 0.9353 / Grad Diff: 98.7112 / Time: 7.45s
======================================================================================================

round 57 local learning rate = 0.01

>>> Round:   58 / Acc: 83.814% / Loss: 0.5810 / Grad Norm: 0.8433 / Grad Diff: 96.5741 / Time: 7.44s
======================================================================================================

round 58 local learning rate = 0.01

>>> Round:   59 / Acc: 84.000% / Loss: 0.5745 / Grad Norm: 0.8273 / Grad Diff: 94.1241 / Time: 7.68s
======================================================================================================

round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 84.190% / Loss: 0.5686 / Grad Norm: 0.8091 / Grad Diff: 91.5181 / Time: 7.29s
======================================================================================================

= Test = round: 60 / acc: 85.630% / loss: 0.5327 / Time: 0.65s
======================================================================================================

round 60 local learning rate = 0.01

>>> Round:   61 / Acc: 84.349% / Loss: 0.5601 / Grad Norm: 0.7891 / Grad Diff: 91.8666 / Time: 7.43s
======================================================================================================

round 61 local learning rate = 0.01

>>> Round:   62 / Acc: 84.441% / Loss: 0.5541 / Grad Norm: 0.8440 / Grad Diff: 91.1812 / Time: 7.48s
======================================================================================================

round 62 local learning rate = 0.01

>>> Round:   63 / Acc: 84.555% / Loss: 0.5481 / Grad Norm: 0.8559 / Grad Diff: 89.9793 / Time: 7.36s
======================================================================================================

round 63 local learning rate = 0.01

>>> Round:   64 / Acc: 84.708% / Loss: 0.5438 / Grad Norm: 0.8246 / Grad Diff: 86.8114 / Time: 7.41s
======================================================================================================

round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 84.917% / Loss: 0.5369 / Grad Norm: 0.7652 / Grad Diff: 86.1263 / Time: 7.38s
======================================================================================================

= Test = round: 65 / acc: 86.150% / loss: 0.5023 / Time: 0.63s
======================================================================================================

round 65 local learning rate = 0.01

>>> Round:   66 / Acc: 84.972% / Loss: 0.5319 / Grad Norm: 0.7832 / Grad Diff: 84.4084 / Time: 7.60s
======================================================================================================

round 66 local learning rate = 0.01

>>> Round:   67 / Acc: 85.129% / Loss: 0.5264 / Grad Norm: 0.7560 / Grad Diff: 83.2209 / Time: 7.44s
======================================================================================================

round 67 local learning rate = 0.01

>>> Round:   68 / Acc: 85.303% / Loss: 0.5213 / Grad Norm: 0.8353 / Grad Diff: 83.2697 / Time: 7.36s
======================================================================================================

round 68 local learning rate = 0.01

>>> Round:   69 / Acc: 85.506% / Loss: 0.5157 / Grad Norm: 0.7231 / Grad Diff: 81.2376 / Time: 7.40s
======================================================================================================

round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 85.601% / Loss: 0.5106 / Grad Norm: 0.7105 / Grad Diff: 79.8696 / Time: 7.42s
======================================================================================================

= Test = round: 70 / acc: 86.950% / loss: 0.4763 / Time: 0.79s
======================================================================================================

round 70 local learning rate = 0.01

>>> Round:   71 / Acc: 85.603% / Loss: 0.5060 / Grad Norm: 0.7592 / Grad Diff: 79.4573 / Time: 9.29s
======================================================================================================

round 71 local learning rate = 0.01

>>> Round:   72 / Acc: 85.832% / Loss: 0.5001 / Grad Norm: 0.6449 / Grad Diff: 78.1631 / Time: 7.69s
======================================================================================================

round 72 local learning rate = 0.01

>>> Round:   73 / Acc: 85.941% / Loss: 0.4958 / Grad Norm: 0.6990 / Grad Diff: 77.8089 / Time: 7.75s
======================================================================================================

round 73 local learning rate = 0.01

>>> Round:   74 / Acc: 86.000% / Loss: 0.4933 / Grad Norm: 0.7784 / Grad Diff: 75.8775 / Time: 7.93s
======================================================================================================

round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 86.190% / Loss: 0.4862 / Grad Norm: 0.6790 / Grad Diff: 76.2871 / Time: 9.32s
======================================================================================================

= Test = round: 75 / acc: 87.490% / loss: 0.4526 / Time: 0.69s
======================================================================================================

round 75 local learning rate = 0.01

>>> Round:   76 / Acc: 86.292% / Loss: 0.4831 / Grad Norm: 0.6747 / Grad Diff: 74.1936 / Time: 8.97s
======================================================================================================

round 76 local learning rate = 0.01

>>> Round:   77 / Acc: 86.430% / Loss: 0.4788 / Grad Norm: 0.6516 / Grad Diff: 73.2968 / Time: 7.47s
======================================================================================================

round 77 local learning rate = 0.01

>>> Round:   78 / Acc: 86.482% / Loss: 0.4748 / Grad Norm: 0.6417 / Grad Diff: 72.4480 / Time: 7.43s
======================================================================================================

round 78 local learning rate = 0.01

>>> Round:   79 / Acc: 86.627% / Loss: 0.4693 / Grad Norm: 0.5737 / Grad Diff: 71.9534 / Time: 7.53s
======================================================================================================

round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 86.734% / Loss: 0.4653 / Grad Norm: 0.5931 / Grad Diff: 71.6271 / Time: 7.41s
======================================================================================================

= Test = round: 80 / acc: 87.970% / loss: 0.4328 / Time: 0.62s
======================================================================================================

round 80 local learning rate = 0.01

>>> Round:   81 / Acc: 86.786% / Loss: 0.4617 / Grad Norm: 0.5699 / Grad Diff: 70.5473 / Time: 7.40s
======================================================================================================

round 81 local learning rate = 0.01

>>> Round:   82 / Acc: 86.910% / Loss: 0.4600 / Grad Norm: 0.7304 / Grad Diff: 69.5714 / Time: 7.51s
======================================================================================================

round 82 local learning rate = 0.01

>>> Round:   83 / Acc: 87.002% / Loss: 0.4558 / Grad Norm: 0.6744 / Grad Diff: 69.0716 / Time: 7.28s
======================================================================================================

round 83 local learning rate = 0.01

>>> Round:   84 / Acc: 86.993% / Loss: 0.4521 / Grad Norm: 0.6602 / Grad Diff: 68.5698 / Time: 7.77s
======================================================================================================

round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 87.120% / Loss: 0.4485 / Grad Norm: 0.6585 / Grad Diff: 67.8875 / Time: 7.43s
======================================================================================================

= Test = round: 85 / acc: 88.390% / loss: 0.4163 / Time: 0.63s
======================================================================================================

round 85 local learning rate = 0.01

>>> Round:   86 / Acc: 87.332% / Loss: 0.4447 / Grad Norm: 0.6893 / Grad Diff: 67.8841 / Time: 7.31s
======================================================================================================

round 86 local learning rate = 0.01

>>> Round:   87 / Acc: 87.365% / Loss: 0.4422 / Grad Norm: 0.6327 / Grad Diff: 65.9920 / Time: 7.35s
======================================================================================================

round 87 local learning rate = 0.01

>>> Round:   88 / Acc: 87.487% / Loss: 0.4385 / Grad Norm: 0.6105 / Grad Diff: 65.3747 / Time: 7.47s
======================================================================================================

round 88 local learning rate = 0.01

>>> Round:   89 / Acc: 87.661% / Loss: 0.4345 / Grad Norm: 0.5509 / Grad Diff: 65.1039 / Time: 7.54s
======================================================================================================

round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 87.697% / Loss: 0.4315 / Grad Norm: 0.5520 / Grad Diff: 64.2964 / Time: 7.39s
======================================================================================================

= Test = round: 90 / acc: 88.950% / loss: 0.3997 / Time: 0.62s
======================================================================================================

round 90 local learning rate = 0.01

>>> Round:   91 / Acc: 87.795% / Loss: 0.4288 / Grad Norm: 0.6201 / Grad Diff: 64.4209 / Time: 7.33s
======================================================================================================

round 91 local learning rate = 0.01

>>> Round:   92 / Acc: 87.893% / Loss: 0.4257 / Grad Norm: 0.5955 / Grad Diff: 63.4294 / Time: 8.45s
======================================================================================================

round 92 local learning rate = 0.01

>>> Round:   93 / Acc: 87.954% / Loss: 0.4235 / Grad Norm: 0.5831 / Grad Diff: 62.2031 / Time: 7.67s
======================================================================================================

round 93 local learning rate = 0.01

>>> Round:   94 / Acc: 88.063% / Loss: 0.4210 / Grad Norm: 0.6005 / Grad Diff: 61.4879 / Time: 8.58s
======================================================================================================

round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 88.039% / Loss: 0.4196 / Grad Norm: 0.7174 / Grad Diff: 60.6843 / Time: 7.61s
======================================================================================================

= Test = round: 95 / acc: 89.130% / loss: 0.3888 / Time: 0.84s
======================================================================================================

round 95 local learning rate = 0.01

>>> Round:   96 / Acc: 88.231% / Loss: 0.4151 / Grad Norm: 0.5900 / Grad Diff: 60.3118 / Time: 7.69s
======================================================================================================

round 96 local learning rate = 0.01

>>> Round:   97 / Acc: 88.266% / Loss: 0.4120 / Grad Norm: 0.5700 / Grad Diff: 59.8301 / Time: 7.40s
======================================================================================================

round 97 local learning rate = 0.01

>>> Round:   98 / Acc: 88.314% / Loss: 0.4094 / Grad Norm: 0.6223 / Grad Diff: 59.7221 / Time: 7.42s
======================================================================================================

round 98 local learning rate = 0.01

>>> Round:   99 / Acc: 88.314% / Loss: 0.4071 / Grad Norm: 0.6636 / Grad Diff: 59.2600 / Time: 8.73s
======================================================================================================

round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 88.443% / Loss: 0.4041 / Grad Norm: 0.5878 / Grad Diff: 58.0671 / Time: 7.37s
======================================================================================================

= Test = round: 100 / acc: 89.650% / loss: 0.3734 / Time: 0.63s
======================================================================================================

round 100 local learning rate = 0.01

>>> Round:  101 / Acc: 88.506% / Loss: 0.4024 / Grad Norm: 0.6728 / Grad Diff: 57.8343 / Time: 7.68s
======================================================================================================

round 101 local learning rate = 0.01

>>> Round:  102 / Acc: 88.629% / Loss: 0.4002 / Grad Norm: 0.6659 / Grad Diff: 56.7794 / Time: 7.38s
======================================================================================================

round 102 local learning rate = 0.01

>>> Round:  103 / Acc: 88.690% / Loss: 0.3969 / Grad Norm: 0.5603 / Grad Diff: 55.8138 / Time: 7.08s
======================================================================================================

round 103 local learning rate = 0.01

>>> Round:  104 / Acc: 88.834% / Loss: 0.3939 / Grad Norm: 0.5443 / Grad Diff: 55.4890 / Time: 7.52s
======================================================================================================

round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 88.851% / Loss: 0.3912 / Grad Norm: 0.5372 / Grad Diff: 55.2730 / Time: 7.38s
======================================================================================================

= Test = round: 105 / acc: 90.060% / loss: 0.3610 / Time: 0.63s
======================================================================================================

round 105 local learning rate = 0.01

>>> Round:  106 / Acc: 88.921% / Loss: 0.3890 / Grad Norm: 0.5385 / Grad Diff: 54.7547 / Time: 7.45s
======================================================================================================

round 106 local learning rate = 0.01

>>> Round:  107 / Acc: 89.002% / Loss: 0.3866 / Grad Norm: 0.5520 / Grad Diff: 54.5091 / Time: 7.44s
======================================================================================================

round 107 local learning rate = 0.01

>>> Round:  108 / Acc: 89.041% / Loss: 0.3844 / Grad Norm: 0.5640 / Grad Diff: 54.0465 / Time: 7.48s
======================================================================================================

round 108 local learning rate = 0.01

>>> Round:  109 / Acc: 89.101% / Loss: 0.3820 / Grad Norm: 0.5687 / Grad Diff: 53.5495 / Time: 7.44s
======================================================================================================

round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 89.157% / Loss: 0.3797 / Grad Norm: 0.5549 / Grad Diff: 52.8907 / Time: 7.65s
======================================================================================================

= Test = round: 110 / acc: 90.350% / loss: 0.3504 / Time: 0.69s
======================================================================================================

round 110 local learning rate = 0.01

>>> Round:  111 / Acc: 89.262% / Loss: 0.3781 / Grad Norm: 0.5373 / Grad Diff: 51.8845 / Time: 7.04s
======================================================================================================

round 111 local learning rate = 0.01

>>> Round:  112 / Acc: 89.317% / Loss: 0.3757 / Grad Norm: 0.4831 / Grad Diff: 51.1163 / Time: 7.33s
======================================================================================================

round 112 local learning rate = 0.01

>>> Round:  113 / Acc: 89.391% / Loss: 0.3737 / Grad Norm: 0.4859 / Grad Diff: 50.6603 / Time: 8.15s
======================================================================================================

round 113 local learning rate = 0.01

>>> Round:  114 / Acc: 89.399% / Loss: 0.3709 / Grad Norm: 0.5048 / Grad Diff: 51.0616 / Time: 7.50s
======================================================================================================

round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 89.426% / Loss: 0.3692 / Grad Norm: 0.5347 / Grad Diff: 50.3493 / Time: 7.73s
======================================================================================================

= Test = round: 115 / acc: 90.670% / loss: 0.3398 / Time: 0.62s
======================================================================================================

round 115 local learning rate = 0.01

>>> Round:  116 / Acc: 89.552% / Loss: 0.3669 / Grad Norm: 0.4822 / Grad Diff: 49.7514 / Time: 7.35s
======================================================================================================

round 116 local learning rate = 0.01

>>> Round:  117 / Acc: 89.601% / Loss: 0.3650 / Grad Norm: 0.4868 / Grad Diff: 49.4498 / Time: 7.51s
======================================================================================================

round 117 local learning rate = 0.01

>>> Round:  118 / Acc: 89.659% / Loss: 0.3621 / Grad Norm: 0.4777 / Grad Diff: 49.4783 / Time: 7.39s
======================================================================================================

round 118 local learning rate = 0.01

>>> Round:  119 / Acc: 89.675% / Loss: 0.3596 / Grad Norm: 0.4464 / Grad Diff: 49.5160 / Time: 8.29s
======================================================================================================

round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 89.721% / Loss: 0.3574 / Grad Norm: 0.4440 / Grad Diff: 49.4912 / Time: 7.56s
======================================================================================================

= Test = round: 120 / acc: 90.940% / loss: 0.3292 / Time: 0.61s
======================================================================================================

round 120 local learning rate = 0.01

>>> Round:  121 / Acc: 89.731% / Loss: 0.3566 / Grad Norm: 0.5152 / Grad Diff: 48.7822 / Time: 8.53s
======================================================================================================

round 121 local learning rate = 0.01

>>> Round:  122 / Acc: 89.828% / Loss: 0.3546 / Grad Norm: 0.5433 / Grad Diff: 48.5435 / Time: 7.47s
======================================================================================================

round 122 local learning rate = 0.01

>>> Round:  123 / Acc: 89.869% / Loss: 0.3530 / Grad Norm: 0.5633 / Grad Diff: 48.0553 / Time: 7.32s
======================================================================================================

round 123 local learning rate = 0.01

>>> Round:  124 / Acc: 89.926% / Loss: 0.3508 / Grad Norm: 0.4878 / Grad Diff: 47.4978 / Time: 7.32s
======================================================================================================

round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 89.989% / Loss: 0.3492 / Grad Norm: 0.4638 / Grad Diff: 46.7590 / Time: 7.49s
======================================================================================================

= Test = round: 125 / acc: 91.120% / loss: 0.3214 / Time: 0.69s
======================================================================================================

round 125 local learning rate = 0.01

>>> Round:  126 / Acc: 90.028% / Loss: 0.3473 / Grad Norm: 0.4697 / Grad Diff: 46.5104 / Time: 7.60s
======================================================================================================

round 126 local learning rate = 0.01

>>> Round:  127 / Acc: 90.079% / Loss: 0.3454 / Grad Norm: 0.4396 / Grad Diff: 45.9665 / Time: 7.80s
======================================================================================================

round 127 local learning rate = 0.01

>>> Round:  128 / Acc: 90.103% / Loss: 0.3440 / Grad Norm: 0.4291 / Grad Diff: 45.4899 / Time: 7.84s
======================================================================================================

round 128 local learning rate = 0.01

>>> Round:  129 / Acc: 90.188% / Loss: 0.3425 / Grad Norm: 0.5022 / Grad Diff: 45.3189 / Time: 7.44s
======================================================================================================

round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 90.220% / Loss: 0.3406 / Grad Norm: 0.4764 / Grad Diff: 44.9917 / Time: 7.45s
======================================================================================================

= Test = round: 130 / acc: 91.370% / loss: 0.3135 / Time: 0.60s
======================================================================================================

round 130 local learning rate = 0.01

>>> Round:  131 / Acc: 90.253% / Loss: 0.3397 / Grad Norm: 0.4820 / Grad Diff: 44.2119 / Time: 8.89s
======================================================================================================

round 131 local learning rate = 0.01

>>> Round:  132 / Acc: 90.264% / Loss: 0.3376 / Grad Norm: 0.5095 / Grad Diff: 44.5990 / Time: 7.60s
======================================================================================================

round 132 local learning rate = 0.01

>>> Round:  133 / Acc: 90.319% / Loss: 0.3366 / Grad Norm: 0.5216 / Grad Diff: 43.6194 / Time: 7.58s
======================================================================================================

round 133 local learning rate = 0.01

>>> Round:  134 / Acc: 90.325% / Loss: 0.3347 / Grad Norm: 0.5357 / Grad Diff: 43.7169 / Time: 8.74s
======================================================================================================

round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 90.437% / Loss: 0.3328 / Grad Norm: 0.4578 / Grad Diff: 43.0270 / Time: 8.58s
======================================================================================================

= Test = round: 135 / acc: 91.490% / loss: 0.3068 / Time: 0.59s
======================================================================================================

round 135 local learning rate = 0.01

>>> Round:  136 / Acc: 90.482% / Loss: 0.3309 / Grad Norm: 0.4472 / Grad Diff: 42.7535 / Time: 6.96s
======================================================================================================

round 136 local learning rate = 0.01

>>> Round:  137 / Acc: 90.559% / Loss: 0.3291 / Grad Norm: 0.4358 / Grad Diff: 42.6716 / Time: 7.76s
======================================================================================================

round 137 local learning rate = 0.01

>>> Round:  138 / Acc: 90.561% / Loss: 0.3285 / Grad Norm: 0.4765 / Grad Diff: 41.9057 / Time: 7.49s
======================================================================================================

round 138 local learning rate = 0.01

>>> Round:  139 / Acc: 90.587% / Loss: 0.3265 / Grad Norm: 0.4533 / Grad Diff: 41.8642 / Time: 7.38s
======================================================================================================

round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 90.627% / Loss: 0.3249 / Grad Norm: 0.4797 / Grad Diff: 41.8301 / Time: 8.22s
======================================================================================================

= Test = round: 140 / acc: 91.730% / loss: 0.2991 / Time: 0.83s
======================================================================================================

round 140 local learning rate = 0.01

>>> Round:  141 / Acc: 90.692% / Loss: 0.3235 / Grad Norm: 0.4842 / Grad Diff: 41.4848 / Time: 9.49s
======================================================================================================

round 141 local learning rate = 0.01

>>> Round:  142 / Acc: 90.690% / Loss: 0.3212 / Grad Norm: 0.4714 / Grad Diff: 41.7810 / Time: 7.59s
======================================================================================================

round 142 local learning rate = 0.01

>>> Round:  143 / Acc: 90.744% / Loss: 0.3197 / Grad Norm: 0.4562 / Grad Diff: 41.2845 / Time: 6.87s
======================================================================================================

round 143 local learning rate = 0.01

>>> Round:  144 / Acc: 90.801% / Loss: 0.3184 / Grad Norm: 0.4512 / Grad Diff: 40.8635 / Time: 7.54s
======================================================================================================

round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 90.899% / Loss: 0.3168 / Grad Norm: 0.4145 / Grad Diff: 40.5346 / Time: 7.47s
======================================================================================================

= Test = round: 145 / acc: 91.760% / loss: 0.2919 / Time: 0.61s
======================================================================================================

round 145 local learning rate = 0.01

>>> Round:  146 / Acc: 90.915% / Loss: 0.3151 / Grad Norm: 0.4047 / Grad Diff: 40.4776 / Time: 7.48s
======================================================================================================

round 146 local learning rate = 0.01

>>> Round:  147 / Acc: 90.928% / Loss: 0.3137 / Grad Norm: 0.4544 / Grad Diff: 40.6354 / Time: 7.39s
======================================================================================================

round 147 local learning rate = 0.01

>>> Round:  148 / Acc: 90.996% / Loss: 0.3119 / Grad Norm: 0.4039 / Grad Diff: 40.2290 / Time: 6.86s
======================================================================================================

round 148 local learning rate = 0.01

>>> Round:  149 / Acc: 91.054% / Loss: 0.3105 / Grad Norm: 0.3786 / Grad Diff: 39.6647 / Time: 7.22s
======================================================================================================

round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 91.000% / Loss: 0.3095 / Grad Norm: 0.4689 / Grad Diff: 39.7045 / Time: 8.32s
======================================================================================================

= Test = round: 150 / acc: 92.120% / loss: 0.2850 / Time: 0.61s
======================================================================================================

round 150 local learning rate = 0.01

>>> Round:  151 / Acc: 91.089% / Loss: 0.3078 / Grad Norm: 0.4260 / Grad Diff: 39.2772 / Time: 7.40s
======================================================================================================

round 151 local learning rate = 0.01

>>> Round:  152 / Acc: 91.131% / Loss: 0.3062 / Grad Norm: 0.3961 / Grad Diff: 38.9230 / Time: 7.86s
======================================================================================================

round 152 local learning rate = 0.01

>>> Round:  153 / Acc: 91.120% / Loss: 0.3050 / Grad Norm: 0.4300 / Grad Diff: 38.9595 / Time: 6.96s
======================================================================================================

round 153 local learning rate = 0.01

>>> Round:  154 / Acc: 91.129% / Loss: 0.3038 / Grad Norm: 0.4687 / Grad Diff: 39.1885 / Time: 6.75s
======================================================================================================

round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 91.173% / Loss: 0.3024 / Grad Norm: 0.4012 / Grad Diff: 38.2371 / Time: 6.70s
======================================================================================================

= Test = round: 155 / acc: 92.280% / loss: 0.2784 / Time: 0.60s
======================================================================================================

round 155 local learning rate = 0.01

>>> Round:  156 / Acc: 91.242% / Loss: 0.3012 / Grad Norm: 0.4083 / Grad Diff: 38.1142 / Time: 6.71s
======================================================================================================

round 156 local learning rate = 0.01

>>> Round:  157 / Acc: 91.244% / Loss: 0.2997 / Grad Norm: 0.4051 / Grad Diff: 37.9386 / Time: 7.34s
======================================================================================================

round 157 local learning rate = 0.01

>>> Round:  158 / Acc: 91.303% / Loss: 0.2983 / Grad Norm: 0.4056 / Grad Diff: 37.7216 / Time: 7.29s
======================================================================================================

round 158 local learning rate = 0.01

>>> Round:  159 / Acc: 91.352% / Loss: 0.2969 / Grad Norm: 0.3918 / Grad Diff: 37.4842 / Time: 7.26s
======================================================================================================

round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 91.338% / Loss: 0.2959 / Grad Norm: 0.4015 / Grad Diff: 37.1617 / Time: 7.35s
======================================================================================================

= Test = round: 160 / acc: 92.450% / loss: 0.2719 / Time: 0.61s
======================================================================================================

round 160 local learning rate = 0.01

>>> Round:  161 / Acc: 91.399% / Loss: 0.2953 / Grad Norm: 0.4357 / Grad Diff: 36.7097 / Time: 8.59s
======================================================================================================

round 161 local learning rate = 0.01

>>> Round:  162 / Acc: 91.404% / Loss: 0.2937 / Grad Norm: 0.4154 / Grad Diff: 36.5658 / Time: 7.34s
======================================================================================================

round 162 local learning rate = 0.01

>>> Round:  163 / Acc: 91.400% / Loss: 0.2929 / Grad Norm: 0.4684 / Grad Diff: 36.3903 / Time: 7.39s
======================================================================================================

round 163 local learning rate = 0.01

>>> Round:  164 / Acc: 91.513% / Loss: 0.2910 / Grad Norm: 0.4015 / Grad Diff: 36.1661 / Time: 7.32s
======================================================================================================

round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 91.498% / Loss: 0.2899 / Grad Norm: 0.4263 / Grad Diff: 36.1133 / Time: 7.32s
======================================================================================================

= Test = round: 165 / acc: 92.550% / loss: 0.2665 / Time: 0.62s
======================================================================================================

round 165 local learning rate = 0.01

>>> Round:  166 / Acc: 91.554% / Loss: 0.2884 / Grad Norm: 0.3828 / Grad Diff: 35.9846 / Time: 7.37s
======================================================================================================

round 166 local learning rate = 0.01

>>> Round:  167 / Acc: 91.594% / Loss: 0.2871 / Grad Norm: 0.3493 / Grad Diff: 35.5386 / Time: 7.30s
======================================================================================================

round 167 local learning rate = 0.01

>>> Round:  168 / Acc: 91.609% / Loss: 0.2858 / Grad Norm: 0.3452 / Grad Diff: 35.3919 / Time: 7.44s
======================================================================================================

round 168 local learning rate = 0.01

>>> Round:  169 / Acc: 91.633% / Loss: 0.2846 / Grad Norm: 0.3673 / Grad Diff: 35.1820 / Time: 7.48s
======================================================================================================

round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 91.655% / Loss: 0.2837 / Grad Norm: 0.4051 / Grad Diff: 35.1858 / Time: 7.36s
======================================================================================================

= Test = round: 170 / acc: 92.640% / loss: 0.2608 / Time: 0.62s
======================================================================================================

round 170 local learning rate = 0.01

>>> Round:  171 / Acc: 91.708% / Loss: 0.2827 / Grad Norm: 0.4060 / Grad Diff: 34.8149 / Time: 7.31s
======================================================================================================

round 171 local learning rate = 0.01

>>> Round:  172 / Acc: 91.701% / Loss: 0.2817 / Grad Norm: 0.4154 / Grad Diff: 34.4565 / Time: 7.49s
======================================================================================================

round 172 local learning rate = 0.01

>>> Round:  173 / Acc: 91.723% / Loss: 0.2808 / Grad Norm: 0.4823 / Grad Diff: 34.5119 / Time: 7.41s
======================================================================================================

round 173 local learning rate = 0.01

>>> Round:  174 / Acc: 91.786% / Loss: 0.2788 / Grad Norm: 0.4047 / Grad Diff: 34.5117 / Time: 7.36s
======================================================================================================

round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 91.823% / Loss: 0.2777 / Grad Norm: 0.3590 / Grad Diff: 34.0277 / Time: 7.44s
======================================================================================================

= Test = round: 175 / acc: 92.810% / loss: 0.2558 / Time: 0.81s
======================================================================================================

round 175 local learning rate = 0.01

>>> Round:  176 / Acc: 91.834% / Loss: 0.2766 / Grad Norm: 0.3759 / Grad Diff: 34.0225 / Time: 7.49s
======================================================================================================

round 176 local learning rate = 0.01

>>> Round:  177 / Acc: 91.865% / Loss: 0.2762 / Grad Norm: 0.4317 / Grad Diff: 33.7839 / Time: 7.38s
======================================================================================================

round 177 local learning rate = 0.01

>>> Round:  178 / Acc: 91.871% / Loss: 0.2749 / Grad Norm: 0.4699 / Grad Diff: 33.9335 / Time: 7.83s
======================================================================================================

round 178 local learning rate = 0.01

>>> Round:  179 / Acc: 91.924% / Loss: 0.2736 / Grad Norm: 0.4070 / Grad Diff: 33.5257 / Time: 7.87s
======================================================================================================

round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 91.919% / Loss: 0.2732 / Grad Norm: 0.4442 / Grad Diff: 33.0293 / Time: 8.01s
======================================================================================================

= Test = round: 180 / acc: 92.830% / loss: 0.2512 / Time: 0.67s
======================================================================================================

round 180 local learning rate = 0.01

>>> Round:  181 / Acc: 91.987% / Loss: 0.2715 / Grad Norm: 0.3740 / Grad Diff: 32.9686 / Time: 7.91s
======================================================================================================

round 181 local learning rate = 0.01

>>> Round:  182 / Acc: 92.024% / Loss: 0.2698 / Grad Norm: 0.3430 / Grad Diff: 33.0996 / Time: 7.71s
======================================================================================================

round 182 local learning rate = 0.01

>>> Round:  183 / Acc: 92.013% / Loss: 0.2693 / Grad Norm: 0.4002 / Grad Diff: 33.0089 / Time: 8.55s
======================================================================================================

round 183 local learning rate = 0.01

>>> Round:  184 / Acc: 92.092% / Loss: 0.2678 / Grad Norm: 0.3361 / Grad Diff: 32.6858 / Time: 7.51s
======================================================================================================

round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 92.140% / Loss: 0.2670 / Grad Norm: 0.3775 / Grad Diff: 32.6111 / Time: 7.63s
======================================================================================================

= Test = round: 185 / acc: 93.070% / loss: 0.2458 / Time: 0.64s
======================================================================================================

round 185 local learning rate = 0.01

>>> Round:  186 / Acc: 92.142% / Loss: 0.2659 / Grad Norm: 0.4198 / Grad Diff: 32.9156 / Time: 7.45s
======================================================================================================

round 186 local learning rate = 0.01

>>> Round:  187 / Acc: 92.153% / Loss: 0.2647 / Grad Norm: 0.3515 / Grad Diff: 32.6657 / Time: 7.62s
======================================================================================================

round 187 local learning rate = 0.01

>>> Round:  188 / Acc: 92.220% / Loss: 0.2637 / Grad Norm: 0.3327 / Grad Diff: 32.2648 / Time: 7.38s
======================================================================================================

round 188 local learning rate = 0.01

>>> Round:  189 / Acc: 92.197% / Loss: 0.2635 / Grad Norm: 0.4007 / Grad Diff: 31.8101 / Time: 7.42s
======================================================================================================

round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 92.255% / Loss: 0.2624 / Grad Norm: 0.3990 / Grad Diff: 31.8004 / Time: 7.71s
======================================================================================================

= Test = round: 190 / acc: 93.140% / loss: 0.2418 / Time: 0.62s
======================================================================================================

round 190 local learning rate = 0.01

>>> Round:  191 / Acc: 92.273% / Loss: 0.2611 / Grad Norm: 0.3578 / Grad Diff: 31.4849 / Time: 7.76s
======================================================================================================

round 191 local learning rate = 0.01

>>> Round:  192 / Acc: 92.317% / Loss: 0.2603 / Grad Norm: 0.3840 / Grad Diff: 31.4158 / Time: 6.78s
======================================================================================================

round 192 local learning rate = 0.01

>>> Round:  193 / Acc: 92.315% / Loss: 0.2595 / Grad Norm: 0.4642 / Grad Diff: 31.6540 / Time: 7.36s
======================================================================================================

round 193 local learning rate = 0.01

>>> Round:  194 / Acc: 92.356% / Loss: 0.2582 / Grad Norm: 0.3865 / Grad Diff: 31.2333 / Time: 7.69s
======================================================================================================

round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 92.380% / Loss: 0.2566 / Grad Norm: 0.3258 / Grad Diff: 31.4382 / Time: 7.87s
======================================================================================================

= Test = round: 195 / acc: 93.150% / loss: 0.2362 / Time: 0.62s
======================================================================================================

round 195 local learning rate = 0.01

>>> Round:  196 / Acc: 92.419% / Loss: 0.2554 / Grad Norm: 0.3359 / Grad Diff: 31.4856 / Time: 7.60s
======================================================================================================

round 196 local learning rate = 0.01

>>> Round:  197 / Acc: 92.450% / Loss: 0.2549 / Grad Norm: 0.3578 / Grad Diff: 31.1596 / Time: 7.33s
======================================================================================================

round 197 local learning rate = 0.01

>>> Round:  198 / Acc: 92.465% / Loss: 0.2543 / Grad Norm: 0.3697 / Grad Diff: 30.7078 / Time: 7.57s
======================================================================================================

round 198 local learning rate = 0.01

>>> Round:  199 / Acc: 92.485% / Loss: 0.2536 / Grad Norm: 0.4043 / Grad Diff: 30.6612 / Time: 7.45s
======================================================================================================

round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 92.518% / Loss: 0.2524 / Grad Norm: 0.3662 / Grad Diff: 30.4165 / Time: 7.99s
======================================================================================================

= Test = round: 200 / acc: 93.200% / loss: 0.2321 / Time: 0.61s
======================================================================================================

>>> Training model_target_only
Epoch: 001, Train_loss: 0.6246, Train_acc: 0.8131, Test_loss: 0.6324, Test_acc: 0.8116
Epoch: 006, Train_loss: 0.3641, Train_acc: 0.8821, Test_loss: 0.4348, Test_acc: 0.8605
Epoch: 011, Train_loss: 0.2670, Train_acc: 0.9109, Test_loss: 0.4255, Test_acc: 0.8651
Epoch: 016, Train_loss: 0.2002, Train_acc: 0.9333, Test_loss: 0.4650, Test_acc: 0.8706
Epoch: 021, Train_loss: 0.1531, Train_acc: 0.9477, Test_loss: 0.5322, Test_acc: 0.8739
Epoch: 026, Train_loss: 0.1291, Train_acc: 0.9558, Test_loss: 0.5944, Test_acc: 0.8666
Epoch: 031, Train_loss: 0.1110, Train_acc: 0.9609, Test_loss: 0.6974, Test_acc: 0.8625
Epoch: 036, Train_loss: 0.0758, Train_acc: 0.9746, Test_loss: 0.8089, Test_acc: 0.8639
Epoch: 041, Train_loss: 0.0598, Train_acc: 0.9804, Test_loss: 0.9301, Test_acc: 0.8649
Epoch: 046, Train_loss: 0.0757, Train_acc: 0.9737, Test_loss: 1.0221, Test_acc: 0.8613
Epoch: 051, Train_loss: 0.0651, Train_acc: 0.9782, Test_loss: 1.1442, Test_acc: 0.8610
Epoch: 056, Train_loss: 0.0607, Train_acc: 0.9801, Test_loss: 1.2062, Test_acc: 0.8590
Epoch: 061, Train_loss: 0.0538, Train_acc: 0.9825, Test_loss: 1.3077, Test_acc: 0.8625
Epoch: 066, Train_loss: 0.0426, Train_acc: 0.9855, Test_loss: 1.2978, Test_acc: 0.8636
Epoch: 071, Train_loss: 0.0334, Train_acc: 0.9892, Test_loss: 1.4535, Test_acc: 0.8616
Epoch: 076, Train_loss: 0.0385, Train_acc: 0.9872, Test_loss: 1.4657, Test_acc: 0.8603
Epoch: 081, Train_loss: 0.0369, Train_acc: 0.9874, Test_loss: 1.5836, Test_acc: 0.8605
Epoch: 086, Train_loss: 0.0248, Train_acc: 0.9918, Test_loss: 1.6552, Test_acc: 0.8606
Epoch: 091, Train_loss: 0.0430, Train_acc: 0.9862, Test_loss: 1.7129, Test_acc: 0.8590
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230917000118_model_target_only.pt.
Model saved at ./models/ft_checkpoints/20230917000118_model_target_only.pt.
>>> Fine-tuning done!
>>> Training model_ft
Epoch: 001, Train_loss: 1.1472, Train_acc: 0.6501, Test_loss: 1.1258, Test_acc: 0.6531
Epoch: 006, Train_loss: 0.8878, Train_acc: 0.7185, Test_loss: 0.8755, Test_acc: 0.7214
Epoch: 011, Train_loss: 0.8180, Train_acc: 0.7409, Test_loss: 0.8273, Test_acc: 0.7406
Epoch: 016, Train_loss: 0.7808, Train_acc: 0.7504, Test_loss: 0.8021, Test_acc: 0.7510
Epoch: 021, Train_loss: 0.7482, Train_acc: 0.7621, Test_loss: 0.7802, Test_acc: 0.7549
Epoch: 026, Train_loss: 0.7410, Train_acc: 0.7632, Test_loss: 0.7795, Test_acc: 0.7564
Epoch: 031, Train_loss: 0.7252, Train_acc: 0.7666, Test_loss: 0.7686, Test_acc: 0.7585
Epoch: 036, Train_loss: 0.7072, Train_acc: 0.7732, Test_loss: 0.7595, Test_acc: 0.7605
Epoch: 041, Train_loss: 0.6866, Train_acc: 0.7812, Test_loss: 0.7505, Test_acc: 0.7636
Epoch: 046, Train_loss: 0.6914, Train_acc: 0.7763, Test_loss: 0.7593, Test_acc: 0.7597
Epoch: 051, Train_loss: 0.6775, Train_acc: 0.7812, Test_loss: 0.7599, Test_acc: 0.7650
Epoch: 056, Train_loss: 0.6586, Train_acc: 0.7857, Test_loss: 0.7389, Test_acc: 0.7674
Epoch: 061, Train_loss: 0.6577, Train_acc: 0.7860, Test_loss: 0.7457, Test_acc: 0.7676
Epoch: 066, Train_loss: 0.6461, Train_acc: 0.7912, Test_loss: 0.7453, Test_acc: 0.7686
Epoch: 071, Train_loss: 0.6372, Train_acc: 0.7938, Test_loss: 0.7388, Test_acc: 0.7668
Epoch: 076, Train_loss: 0.6370, Train_acc: 0.7924, Test_loss: 0.7420, Test_acc: 0.7690
Epoch: 081, Train_loss: 0.6252, Train_acc: 0.7965, Test_loss: 0.7435, Test_acc: 0.7690
Epoch: 086, Train_loss: 0.6395, Train_acc: 0.7937, Test_loss: 0.7588, Test_acc: 0.7656
Epoch: 091, Train_loss: 0.6386, Train_acc: 0.7923, Test_loss: 0.7516, Test_acc: 0.7639
Epoch: 096, Train_loss: 0.6274, Train_acc: 0.7929, Test_loss: 0.7547, Test_acc: 0.7618
Epoch: 101, Train_loss: 0.6103, Train_acc: 0.8012, Test_loss: 0.7394, Test_acc: 0.7701
Epoch: 106, Train_loss: 0.6178, Train_acc: 0.7965, Test_loss: 0.7526, Test_acc: 0.7647
Epoch: 111, Train_loss: 0.6176, Train_acc: 0.7985, Test_loss: 0.7479, Test_acc: 0.7694
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230917000118_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230917000118_model_ft.pt.
>>> Fine-tuning done!
>>> Training model_random
Epoch: 001, Train_loss: 1.8537, Train_acc: 0.4035, Test_loss: 1.8545, Test_acc: 0.3990
Epoch: 006, Train_loss: 1.4286, Train_acc: 0.5331, Test_loss: 1.4347, Test_acc: 0.5295
Epoch: 011, Train_loss: 1.3223, Train_acc: 0.5674, Test_loss: 1.3294, Test_acc: 0.5634
Epoch: 016, Train_loss: 1.2482, Train_acc: 0.5918, Test_loss: 1.2560, Test_acc: 0.5910
Epoch: 021, Train_loss: 1.1908, Train_acc: 0.6125, Test_loss: 1.1999, Test_acc: 0.6059
Epoch: 026, Train_loss: 1.1525, Train_acc: 0.6235, Test_loss: 1.1637, Test_acc: 0.6166
Epoch: 031, Train_loss: 1.1233, Train_acc: 0.6332, Test_loss: 1.1365, Test_acc: 0.6243
Epoch: 036, Train_loss: 1.0965, Train_acc: 0.6413, Test_loss: 1.1177, Test_acc: 0.6320
Epoch: 041, Train_loss: 1.0757, Train_acc: 0.6479, Test_loss: 1.1002, Test_acc: 0.6362
Epoch: 046, Train_loss: 1.0591, Train_acc: 0.6516, Test_loss: 1.0925, Test_acc: 0.6419
Epoch: 051, Train_loss: 1.0440, Train_acc: 0.6576, Test_loss: 1.0818, Test_acc: 0.6445
Epoch: 056, Train_loss: 1.0322, Train_acc: 0.6609, Test_loss: 1.0773, Test_acc: 0.6453
Epoch: 061, Train_loss: 1.0216, Train_acc: 0.6632, Test_loss: 1.0665, Test_acc: 0.6479
Epoch: 066, Train_loss: 1.0115, Train_acc: 0.6693, Test_loss: 1.0653, Test_acc: 0.6503
Epoch: 071, Train_loss: 1.0006, Train_acc: 0.6731, Test_loss: 1.0610, Test_acc: 0.6525
Epoch: 076, Train_loss: 0.9949, Train_acc: 0.6746, Test_loss: 1.0583, Test_acc: 0.6521
Epoch: 081, Train_loss: 0.9851, Train_acc: 0.6776, Test_loss: 1.0538, Test_acc: 0.6563
Epoch: 086, Train_loss: 0.9844, Train_acc: 0.6771, Test_loss: 1.0564, Test_acc: 0.6565
Epoch: 091, Train_loss: 0.9737, Train_acc: 0.6809, Test_loss: 1.0518, Test_acc: 0.6549
Epoch: 096, Train_loss: 0.9644, Train_acc: 0.6843, Test_loss: 1.0474, Test_acc: 0.6584
Epoch: 101, Train_loss: 0.9635, Train_acc: 0.6836, Test_loss: 1.0501, Test_acc: 0.6595
Epoch: 106, Train_loss: 0.9602, Train_acc: 0.6849, Test_loss: 1.0476, Test_acc: 0.6587
Epoch: 111, Train_loss: 0.9576, Train_acc: 0.6874, Test_loss: 1.0527, Test_acc: 0.6559
Epoch: 116, Train_loss: 0.9487, Train_acc: 0.6890, Test_loss: 1.0463, Test_acc: 0.6579
Epoch: 121, Train_loss: 0.9458, Train_acc: 0.6874, Test_loss: 1.0452, Test_acc: 0.6587
Epoch: 126, Train_loss: 0.9411, Train_acc: 0.6913, Test_loss: 1.0470, Test_acc: 0.6610
Epoch: 131, Train_loss: 0.9360, Train_acc: 0.6935, Test_loss: 1.0462, Test_acc: 0.6598
Epoch: 136, Train_loss: 0.9310, Train_acc: 0.6955, Test_loss: 1.0398, Test_acc: 0.6629
Epoch: 141, Train_loss: 0.9285, Train_acc: 0.6957, Test_loss: 1.0418, Test_acc: 0.6616
Epoch: 146, Train_loss: 0.9291, Train_acc: 0.6952, Test_loss: 1.0461, Test_acc: 0.6606
Epoch: 151, Train_loss: 0.9236, Train_acc: 0.6969, Test_loss: 1.0395, Test_acc: 0.6630
Epoch: 156, Train_loss: 0.9233, Train_acc: 0.6961, Test_loss: 1.0436, Test_acc: 0.6626
Epoch: 161, Train_loss: 0.9200, Train_acc: 0.6973, Test_loss: 1.0416, Test_acc: 0.6633
Epoch: 166, Train_loss: 0.9151, Train_acc: 0.6989, Test_loss: 1.0436, Test_acc: 0.6654
Epoch: 171, Train_loss: 0.9138, Train_acc: 0.6994, Test_loss: 1.0434, Test_acc: 0.6638
Epoch: 176, Train_loss: 0.9132, Train_acc: 0.7010, Test_loss: 1.0473, Test_acc: 0.6647
Epoch: 181, Train_loss: 0.9070, Train_acc: 0.7013, Test_loss: 1.0418, Test_acc: 0.6645
Epoch: 186, Train_loss: 0.9072, Train_acc: 0.7021, Test_loss: 1.0454, Test_acc: 0.6629
Epoch: 191, Train_loss: 0.9082, Train_acc: 0.7000, Test_loss: 1.0459, Test_acc: 0.6607
Epoch: 196, Train_loss: 0.9017, Train_acc: 0.7034, Test_loss: 1.0435, Test_acc: 0.6654
Model saved at ./models/ft_checkpoints/20230917000118_model_random.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_target_only: [0.02484623093321664, 0.9918475958034609, 1.6552398369029129, 0.8605710476613709]
model_ft: [0.6050988996282064, 0.8030372366570058, 0.7319653030336334, 0.7700255527163649]
model_random: [0.9002914571709149, 0.7028016474297046, 1.0480223689300725, 0.6620375513831797]
model_source_only: [2.3527649990354695, 0.4368061558278673, 2.3807545682745848, 0.43639595600488834]
fl_test_acc_mean 0.9319
model_source_only_test_acc_mean 0.43639595600488834
model_ft_test_acc_mean 0.7700255527163649
model_target_only_test_acc_mean 0.8605710476613709
model_random_test_acc_mean 0.6620375513831797
