nohup: ignoring input
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 13.2316427
	       batch_size : 64
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 10
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 200
	            ft_lr : 0.001
	            ft_wd : 0.0
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 10
	        noaverage : False
	             noft : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : True
	       reg_J_coef : 1e-05
	           repeat : 1
	             seed : 123
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 13.2316427.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl

************************************************************************************************************************

uid: 20230917045609
FL pretrained model will be saved at ./models/lenet_mnist_20230917045609.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 10.022% / Loss: 2.3030 / Grad Norm: 0.1424 / Grad Diff: 1.3673 / Time: 7.55s
======================================================================================================

= Test = round: 0 / acc: 11.370% / loss: 2.3015 / Time: 0.62s
======================================================================================================

round 0 local learning rate = 0.01

>>> Round:    1 / Acc: 11.694% / Loss: 2.3009 / Grad Norm: 0.1543 / Grad Diff: 1.5911 / Time: 7.70s
======================================================================================================

round 1 local learning rate = 0.01

>>> Round:    2 / Acc: 18.129% / Loss: 2.2981 / Grad Norm: 0.1705 / Grad Diff: 1.9379 / Time: 7.55s
======================================================================================================

round 2 local learning rate = 0.01

>>> Round:    3 / Acc: 23.548% / Loss: 2.2946 / Grad Norm: 0.1926 / Grad Diff: 2.5029 / Time: 8.04s
======================================================================================================

round 3 local learning rate = 0.01

>>> Round:    4 / Acc: 24.159% / Loss: 2.2902 / Grad Norm: 0.2265 / Grad Diff: 3.5149 / Time: 8.83s
======================================================================================================

round 4 local learning rate = 0.01

>>> Round:    5 / Acc: 17.482% / Loss: 2.2846 / Grad Norm: 0.2875 / Grad Diff: 5.6138 / Time: 7.23s
======================================================================================================

= Test = round: 5 / acc: 17.940% / loss: 2.2837 / Time: 0.61s
======================================================================================================

round 5 local learning rate = 0.01

>>> Round:    6 / Acc: 16.535% / Loss: 2.2781 / Grad Norm: 0.4010 / Grad Diff: 10.7451 / Time: 7.58s
======================================================================================================

round 6 local learning rate = 0.01

>>> Round:    7 / Acc: 17.633% / Loss: 2.2703 / Grad Norm: 0.6662 / Grad Diff: 25.0534 / Time: 7.44s
======================================================================================================

round 7 local learning rate = 0.01

>>> Round:    8 / Acc: 19.520% / Loss: 2.2487 / Grad Norm: 1.0145 / Grad Diff: 60.5478 / Time: 7.51s
======================================================================================================

round 8 local learning rate = 0.01

>>> Round:    9 / Acc: 24.411% / Loss: 2.2082 / Grad Norm: 1.1206 / Grad Diff: 120.4018 / Time: 8.80s
======================================================================================================

round 9 local learning rate = 0.01

>>> Round:   10 / Acc: 32.668% / Loss: 2.1699 / Grad Norm: 1.1059 / Grad Diff: 173.9518 / Time: 7.46s
======================================================================================================

= Test = round: 10 / acc: 33.390% / loss: 2.1689 / Time: 0.59s
======================================================================================================

round 10 local learning rate = 0.01

>>> Round:   11 / Acc: 48.323% / Loss: 2.1404 / Grad Norm: 1.1069 / Grad Diff: 185.7222 / Time: 7.82s
======================================================================================================

round 11 local learning rate = 0.01

>>> Round:   12 / Acc: 49.072% / Loss: 2.1132 / Grad Norm: 1.2701 / Grad Diff: 191.1119 / Time: 7.49s
======================================================================================================

round 12 local learning rate = 0.01

>>> Round:   13 / Acc: 55.168% / Loss: 2.0800 / Grad Norm: 1.2438 / Grad Diff: 190.5839 / Time: 7.08s
======================================================================================================

round 13 local learning rate = 0.01

>>> Round:   14 / Acc: 54.498% / Loss: 2.0473 / Grad Norm: 1.4443 / Grad Diff: 194.2603 / Time: 7.42s
======================================================================================================

round 14 local learning rate = 0.01

>>> Round:   15 / Acc: 58.347% / Loss: 2.0056 / Grad Norm: 1.4059 / Grad Diff: 194.4769 / Time: 7.62s
======================================================================================================

= Test = round: 15 / acc: 60.340% / loss: 1.9988 / Time: 0.62s
======================================================================================================

round 15 local learning rate = 0.01

>>> Round:   16 / Acc: 59.568% / Loss: 1.9642 / Grad Norm: 1.4503 / Grad Diff: 190.1279 / Time: 7.19s
======================================================================================================

round 16 local learning rate = 0.01

>>> Round:   17 / Acc: 63.232% / Loss: 1.9152 / Grad Norm: 1.5240 / Grad Diff: 195.6594 / Time: 7.76s
======================================================================================================

round 17 local learning rate = 0.01

>>> Round:   18 / Acc: 64.537% / Loss: 1.8641 / Grad Norm: 1.5779 / Grad Diff: 195.5930 / Time: 7.53s
======================================================================================================

round 18 local learning rate = 0.01

>>> Round:   19 / Acc: 65.683% / Loss: 1.8075 / Grad Norm: 1.6385 / Grad Diff: 198.7526 / Time: 6.92s
======================================================================================================

round 19 local learning rate = 0.01

>>> Round:   20 / Acc: 68.098% / Loss: 1.7443 / Grad Norm: 1.5359 / Grad Diff: 198.6998 / Time: 7.44s
======================================================================================================

= Test = round: 20 / acc: 70.410% / loss: 1.7300 / Time: 0.60s
======================================================================================================

round 20 local learning rate = 0.01

>>> Round:   21 / Acc: 69.199% / Loss: 1.6812 / Grad Norm: 1.4756 / Grad Diff: 195.4699 / Time: 7.47s
======================================================================================================

round 21 local learning rate = 0.01

>>> Round:   22 / Acc: 69.991% / Loss: 1.6203 / Grad Norm: 1.5484 / Grad Diff: 191.9477 / Time: 7.60s
======================================================================================================

round 22 local learning rate = 0.01

>>> Round:   23 / Acc: 70.148% / Loss: 1.5546 / Grad Norm: 1.5238 / Grad Diff: 190.9685 / Time: 7.51s
======================================================================================================

round 23 local learning rate = 0.01

>>> Round:   24 / Acc: 71.138% / Loss: 1.4896 / Grad Norm: 1.4956 / Grad Diff: 187.6272 / Time: 7.37s
======================================================================================================

round 24 local learning rate = 0.01

>>> Round:   25 / Acc: 72.266% / Loss: 1.4250 / Grad Norm: 1.4851 / Grad Diff: 186.9436 / Time: 7.88s
======================================================================================================

= Test = round: 25 / acc: 74.440% / loss: 1.4000 / Time: 0.63s
======================================================================================================

round 25 local learning rate = 0.01

>>> Round:   26 / Acc: 72.476% / Loss: 1.3620 / Grad Norm: 1.4521 / Grad Diff: 187.5382 / Time: 7.28s
======================================================================================================

round 26 local learning rate = 0.01

>>> Round:   27 / Acc: 73.138% / Loss: 1.3049 / Grad Norm: 1.4093 / Grad Diff: 184.1587 / Time: 10.08s
======================================================================================================

round 27 local learning rate = 0.01

>>> Round:   28 / Acc: 73.114% / Loss: 1.2526 / Grad Norm: 1.4268 / Grad Diff: 180.0030 / Time: 7.58s
======================================================================================================

round 28 local learning rate = 0.01

>>> Round:   29 / Acc: 73.823% / Loss: 1.2071 / Grad Norm: 1.4021 / Grad Diff: 170.6690 / Time: 8.15s
======================================================================================================

round 29 local learning rate = 0.01

>>> Round:   30 / Acc: 74.066% / Loss: 1.1561 / Grad Norm: 1.3929 / Grad Diff: 173.0240 / Time: 7.50s
======================================================================================================

= Test = round: 30 / acc: 75.760% / loss: 1.1223 / Time: 0.61s
======================================================================================================

round 30 local learning rate = 0.01

>>> Round:   31 / Acc: 74.576% / Loss: 1.1127 / Grad Norm: 1.3217 / Grad Diff: 170.1276 / Time: 7.61s
======================================================================================================

round 31 local learning rate = 0.01

>>> Round:   32 / Acc: 75.397% / Loss: 1.0719 / Grad Norm: 1.2589 / Grad Diff: 167.7317 / Time: 7.33s
======================================================================================================

round 32 local learning rate = 0.01

>>> Round:   33 / Acc: 75.437% / Loss: 1.0394 / Grad Norm: 1.3042 / Grad Diff: 160.6189 / Time: 7.53s
======================================================================================================

round 33 local learning rate = 0.01

>>> Round:   34 / Acc: 76.196% / Loss: 1.0048 / Grad Norm: 1.2800 / Grad Diff: 157.5660 / Time: 7.88s
======================================================================================================

round 34 local learning rate = 0.01

>>> Round:   35 / Acc: 76.565% / Loss: 0.9745 / Grad Norm: 1.2752 / Grad Diff: 154.1279 / Time: 7.67s
======================================================================================================

= Test = round: 35 / acc: 78.030% / loss: 0.9366 / Time: 0.65s
======================================================================================================

round 35 local learning rate = 0.01

>>> Round:   36 / Acc: 76.908% / Loss: 0.9457 / Grad Norm: 1.2473 / Grad Diff: 149.9648 / Time: 7.58s
======================================================================================================

round 36 local learning rate = 0.01

>>> Round:   37 / Acc: 77.400% / Loss: 0.9187 / Grad Norm: 1.2830 / Grad Diff: 146.5882 / Time: 7.49s
======================================================================================================

round 37 local learning rate = 0.01

>>> Round:   38 / Acc: 77.638% / Loss: 0.8952 / Grad Norm: 1.3192 / Grad Diff: 142.9266 / Time: 7.55s
======================================================================================================

round 38 local learning rate = 0.01

>>> Round:   39 / Acc: 77.790% / Loss: 0.8710 / Grad Norm: 1.2154 / Grad Diff: 138.8205 / Time: 7.51s
======================================================================================================

round 39 local learning rate = 0.01

>>> Round:   40 / Acc: 78.149% / Loss: 0.8490 / Grad Norm: 1.2593 / Grad Diff: 136.0678 / Time: 7.63s
======================================================================================================

= Test = round: 40 / acc: 79.680% / loss: 0.8100 / Time: 0.61s
======================================================================================================

round 40 local learning rate = 0.01

>>> Round:   41 / Acc: 78.679% / Loss: 0.8237 / Grad Norm: 1.1066 / Grad Diff: 135.3679 / Time: 7.49s
======================================================================================================

round 41 local learning rate = 0.01

>>> Round:   42 / Acc: 78.965% / Loss: 0.8064 / Grad Norm: 1.1258 / Grad Diff: 130.3764 / Time: 7.42s
======================================================================================================

round 42 local learning rate = 0.01

>>> Round:   43 / Acc: 79.306% / Loss: 0.7866 / Grad Norm: 1.0765 / Grad Diff: 128.9910 / Time: 7.52s
======================================================================================================

round 43 local learning rate = 0.01

>>> Round:   44 / Acc: 79.563% / Loss: 0.7674 / Grad Norm: 1.1166 / Grad Diff: 129.1401 / Time: 7.50s
======================================================================================================

round 44 local learning rate = 0.01

>>> Round:   45 / Acc: 79.867% / Loss: 0.7523 / Grad Norm: 1.0250 / Grad Diff: 124.6509 / Time: 7.33s
======================================================================================================

= Test = round: 45 / acc: 81.690% / loss: 0.7135 / Time: 0.63s
======================================================================================================

round 45 local learning rate = 0.01

>>> Round:   46 / Acc: 80.125% / Loss: 0.7389 / Grad Norm: 1.0849 / Grad Diff: 121.4530 / Time: 7.73s
======================================================================================================

round 46 local learning rate = 0.01

>>> Round:   47 / Acc: 80.411% / Loss: 0.7252 / Grad Norm: 1.0268 / Grad Diff: 117.5085 / Time: 7.48s
======================================================================================================

round 47 local learning rate = 0.01

>>> Round:   48 / Acc: 80.708% / Loss: 0.7096 / Grad Norm: 1.0049 / Grad Diff: 116.8166 / Time: 7.52s
======================================================================================================

round 48 local learning rate = 0.01

>>> Round:   49 / Acc: 80.945% / Loss: 0.6967 / Grad Norm: 0.9992 / Grad Diff: 115.2320 / Time: 7.49s
======================================================================================================

round 49 local learning rate = 0.01

>>> Round:   50 / Acc: 81.205% / Loss: 0.6820 / Grad Norm: 0.9176 / Grad Diff: 114.6281 / Time: 7.39s
======================================================================================================

= Test = round: 50 / acc: 82.730% / loss: 0.6443 / Time: 0.62s
======================================================================================================

round 50 local learning rate = 0.01

>>> Round:   51 / Acc: 81.423% / Loss: 0.6696 / Grad Norm: 0.9377 / Grad Diff: 114.3503 / Time: 7.41s
======================================================================================================

round 51 local learning rate = 0.01

>>> Round:   52 / Acc: 81.459% / Loss: 0.6623 / Grad Norm: 1.0630 / Grad Diff: 110.7505 / Time: 7.39s
======================================================================================================

round 52 local learning rate = 0.01

>>> Round:   53 / Acc: 81.718% / Loss: 0.6519 / Grad Norm: 0.9840 / Grad Diff: 108.4129 / Time: 7.36s
======================================================================================================

round 53 local learning rate = 0.01

>>> Round:   54 / Acc: 82.083% / Loss: 0.6404 / Grad Norm: 0.9360 / Grad Diff: 107.8801 / Time: 7.47s
======================================================================================================

round 54 local learning rate = 0.01

>>> Round:   55 / Acc: 82.367% / Loss: 0.6304 / Grad Norm: 0.8480 / Grad Diff: 105.5664 / Time: 8.71s
======================================================================================================

= Test = round: 55 / acc: 83.850% / loss: 0.5939 / Time: 0.84s
======================================================================================================

round 55 local learning rate = 0.01

>>> Round:   56 / Acc: 82.371% / Loss: 0.6225 / Grad Norm: 0.9721 / Grad Diff: 104.4496 / Time: 9.91s
======================================================================================================

round 56 local learning rate = 0.01

>>> Round:   57 / Acc: 82.651% / Loss: 0.6131 / Grad Norm: 0.8885 / Grad Diff: 102.9640 / Time: 10.05s
======================================================================================================

round 57 local learning rate = 0.01

>>> Round:   58 / Acc: 82.937% / Loss: 0.6040 / Grad Norm: 0.8101 / Grad Diff: 101.4349 / Time: 10.09s
======================================================================================================

round 58 local learning rate = 0.01

>>> Round:   59 / Acc: 83.101% / Loss: 0.5966 / Grad Norm: 0.8421 / Grad Diff: 99.7713 / Time: 9.29s
======================================================================================================

round 59 local learning rate = 0.01

>>> Round:   60 / Acc: 83.273% / Loss: 0.5902 / Grad Norm: 0.7857 / Grad Diff: 96.6686 / Time: 7.33s
======================================================================================================

= Test = round: 60 / acc: 84.870% / loss: 0.5546 / Time: 0.61s
======================================================================================================

round 60 local learning rate = 0.01

>>> Round:   61 / Acc: 83.378% / Loss: 0.5827 / Grad Norm: 0.8794 / Grad Diff: 96.5785 / Time: 7.58s
======================================================================================================

round 61 local learning rate = 0.01

>>> Round:   62 / Acc: 83.576% / Loss: 0.5752 / Grad Norm: 0.8272 / Grad Diff: 95.2580 / Time: 7.58s
======================================================================================================

round 62 local learning rate = 0.01

>>> Round:   63 / Acc: 83.777% / Loss: 0.5686 / Grad Norm: 0.8057 / Grad Diff: 93.3247 / Time: 7.42s
======================================================================================================

round 63 local learning rate = 0.01

>>> Round:   64 / Acc: 83.958% / Loss: 0.5630 / Grad Norm: 0.8374 / Grad Diff: 91.6783 / Time: 7.61s
======================================================================================================

round 64 local learning rate = 0.01

>>> Round:   65 / Acc: 84.183% / Loss: 0.5546 / Grad Norm: 0.6944 / Grad Diff: 90.8749 / Time: 7.47s
======================================================================================================

= Test = round: 65 / acc: 85.420% / loss: 0.5206 / Time: 0.61s
======================================================================================================

round 65 local learning rate = 0.01

>>> Round:   66 / Acc: 84.369% / Loss: 0.5480 / Grad Norm: 0.6519 / Grad Diff: 89.8733 / Time: 7.44s
======================================================================================================

round 66 local learning rate = 0.01

>>> Round:   67 / Acc: 84.463% / Loss: 0.5429 / Grad Norm: 0.7432 / Grad Diff: 89.2363 / Time: 7.47s
======================================================================================================

round 67 local learning rate = 0.01

>>> Round:   68 / Acc: 84.579% / Loss: 0.5378 / Grad Norm: 0.7993 / Grad Diff: 88.4944 / Time: 7.48s
======================================================================================================

round 68 local learning rate = 0.01

>>> Round:   69 / Acc: 84.753% / Loss: 0.5313 / Grad Norm: 0.7094 / Grad Diff: 87.4475 / Time: 7.55s
======================================================================================================

round 69 local learning rate = 0.01

>>> Round:   70 / Acc: 84.773% / Loss: 0.5266 / Grad Norm: 0.7793 / Grad Diff: 86.3919 / Time: 7.39s
======================================================================================================

= Test = round: 70 / acc: 86.090% / loss: 0.4936 / Time: 0.62s
======================================================================================================

round 70 local learning rate = 0.01

>>> Round:   71 / Acc: 84.945% / Loss: 0.5216 / Grad Norm: 0.7664 / Grad Diff: 84.9650 / Time: 7.42s
======================================================================================================

round 71 local learning rate = 0.01

>>> Round:   72 / Acc: 85.157% / Loss: 0.5162 / Grad Norm: 0.7078 / Grad Diff: 83.7840 / Time: 7.40s
======================================================================================================

round 72 local learning rate = 0.01

>>> Round:   73 / Acc: 85.244% / Loss: 0.5124 / Grad Norm: 0.7326 / Grad Diff: 82.0220 / Time: 7.79s
======================================================================================================

round 73 local learning rate = 0.01

>>> Round:   74 / Acc: 85.280% / Loss: 0.5094 / Grad Norm: 0.8063 / Grad Diff: 80.2888 / Time: 7.55s
======================================================================================================

round 74 local learning rate = 0.01

>>> Round:   75 / Acc: 85.594% / Loss: 0.5031 / Grad Norm: 0.6659 / Grad Diff: 79.1317 / Time: 6.93s
======================================================================================================

= Test = round: 75 / acc: 86.780% / loss: 0.4708 / Time: 0.60s
======================================================================================================

round 75 local learning rate = 0.01

>>> Round:   76 / Acc: 85.640% / Loss: 0.4989 / Grad Norm: 0.7197 / Grad Diff: 78.3339 / Time: 7.64s
======================================================================================================

round 76 local learning rate = 0.01

>>> Round:   77 / Acc: 85.926% / Loss: 0.4933 / Grad Norm: 0.6081 / Grad Diff: 77.4546 / Time: 7.72s
======================================================================================================

round 77 local learning rate = 0.01

>>> Round:   78 / Acc: 86.103% / Loss: 0.4883 / Grad Norm: 0.6028 / Grad Diff: 77.3235 / Time: 7.73s
======================================================================================================

round 78 local learning rate = 0.01

>>> Round:   79 / Acc: 86.074% / Loss: 0.4832 / Grad Norm: 0.5881 / Grad Diff: 76.9023 / Time: 8.55s
======================================================================================================

round 79 local learning rate = 0.01

>>> Round:   80 / Acc: 86.127% / Loss: 0.4793 / Grad Norm: 0.6794 / Grad Diff: 76.8247 / Time: 7.60s
======================================================================================================

= Test = round: 80 / acc: 87.230% / loss: 0.4485 / Time: 0.65s
======================================================================================================

round 80 local learning rate = 0.01

>>> Round:   81 / Acc: 86.288% / Loss: 0.4745 / Grad Norm: 0.5527 / Grad Diff: 75.5037 / Time: 7.19s
======================================================================================================

round 81 local learning rate = 0.01

>>> Round:   82 / Acc: 86.334% / Loss: 0.4725 / Grad Norm: 0.6794 / Grad Diff: 74.2861 / Time: 7.87s
======================================================================================================

round 82 local learning rate = 0.01

>>> Round:   83 / Acc: 86.498% / Loss: 0.4683 / Grad Norm: 0.5971 / Grad Diff: 73.3594 / Time: 7.55s
======================================================================================================

round 83 local learning rate = 0.01

>>> Round:   84 / Acc: 86.542% / Loss: 0.4640 / Grad Norm: 0.6514 / Grad Diff: 73.6000 / Time: 7.74s
======================================================================================================

round 84 local learning rate = 0.01

>>> Round:   85 / Acc: 86.649% / Loss: 0.4611 / Grad Norm: 0.6516 / Grad Diff: 72.3424 / Time: 7.71s
======================================================================================================

= Test = round: 85 / acc: 87.690% / loss: 0.4303 / Time: 0.62s
======================================================================================================

round 85 local learning rate = 0.01

>>> Round:   86 / Acc: 86.710% / Loss: 0.4575 / Grad Norm: 0.6921 / Grad Diff: 71.9623 / Time: 7.82s
======================================================================================================

round 86 local learning rate = 0.01

>>> Round:   87 / Acc: 86.830% / Loss: 0.4544 / Grad Norm: 0.5786 / Grad Diff: 69.9128 / Time: 7.67s
======================================================================================================

round 87 local learning rate = 0.01

>>> Round:   88 / Acc: 86.910% / Loss: 0.4512 / Grad Norm: 0.6122 / Grad Diff: 69.4272 / Time: 7.81s
======================================================================================================

round 88 local learning rate = 0.01

>>> Round:   89 / Acc: 87.022% / Loss: 0.4484 / Grad Norm: 0.5925 / Grad Diff: 68.0188 / Time: 7.43s
======================================================================================================

round 89 local learning rate = 0.01

>>> Round:   90 / Acc: 87.172% / Loss: 0.4441 / Grad Norm: 0.5853 / Grad Diff: 68.0866 / Time: 9.48s
======================================================================================================

= Test = round: 90 / acc: 88.260% / loss: 0.4147 / Time: 0.60s
======================================================================================================

round 90 local learning rate = 0.01

>>> Round:   91 / Acc: 87.256% / Loss: 0.4407 / Grad Norm: 0.5538 / Grad Diff: 67.3138 / Time: 7.49s
======================================================================================================

round 91 local learning rate = 0.01

>>> Round:   92 / Acc: 87.339% / Loss: 0.4383 / Grad Norm: 0.6152 / Grad Diff: 66.4941 / Time: 7.45s
======================================================================================================

round 92 local learning rate = 0.01

>>> Round:   93 / Acc: 87.445% / Loss: 0.4356 / Grad Norm: 0.5859 / Grad Diff: 65.3351 / Time: 8.37s
======================================================================================================

round 93 local learning rate = 0.01

>>> Round:   94 / Acc: 87.559% / Loss: 0.4323 / Grad Norm: 0.5701 / Grad Diff: 64.8906 / Time: 7.59s
======================================================================================================

round 94 local learning rate = 0.01

>>> Round:   95 / Acc: 87.574% / Loss: 0.4297 / Grad Norm: 0.6036 / Grad Diff: 64.0939 / Time: 7.81s
======================================================================================================

= Test = round: 95 / acc: 88.640% / loss: 0.4007 / Time: 0.61s
======================================================================================================

round 95 local learning rate = 0.01

>>> Round:   96 / Acc: 87.747% / Loss: 0.4259 / Grad Norm: 0.5843 / Grad Diff: 64.1331 / Time: 7.30s
======================================================================================================

round 96 local learning rate = 0.01

>>> Round:   97 / Acc: 87.755% / Loss: 0.4235 / Grad Norm: 0.6278 / Grad Diff: 63.4754 / Time: 7.46s
======================================================================================================

round 97 local learning rate = 0.01

>>> Round:   98 / Acc: 87.893% / Loss: 0.4204 / Grad Norm: 0.5977 / Grad Diff: 62.8896 / Time: 7.51s
======================================================================================================

round 98 local learning rate = 0.01

>>> Round:   99 / Acc: 87.930% / Loss: 0.4177 / Grad Norm: 0.5984 / Grad Diff: 62.1227 / Time: 7.44s
======================================================================================================

round 99 local learning rate = 0.01

>>> Round:  100 / Acc: 87.897% / Loss: 0.4162 / Grad Norm: 0.7043 / Grad Diff: 61.5796 / Time: 7.38s
======================================================================================================

= Test = round: 100 / acc: 89.060% / loss: 0.3878 / Time: 0.61s
======================================================================================================

round 100 local learning rate = 0.01

>>> Round:  101 / Acc: 88.059% / Loss: 0.4133 / Grad Norm: 0.6753 / Grad Diff: 60.8172 / Time: 7.07s
======================================================================================================

round 101 local learning rate = 0.01

>>> Round:  102 / Acc: 88.068% / Loss: 0.4115 / Grad Norm: 0.6744 / Grad Diff: 59.6109 / Time: 7.70s
======================================================================================================

round 102 local learning rate = 0.01

>>> Round:  103 / Acc: 88.138% / Loss: 0.4075 / Grad Norm: 0.5755 / Grad Diff: 59.0703 / Time: 7.47s
======================================================================================================

round 103 local learning rate = 0.01

>>> Round:  104 / Acc: 88.343% / Loss: 0.4034 / Grad Norm: 0.4932 / Grad Diff: 59.2148 / Time: 7.44s
======================================================================================================

round 104 local learning rate = 0.01

>>> Round:  105 / Acc: 88.380% / Loss: 0.4005 / Grad Norm: 0.4756 / Grad Diff: 58.8361 / Time: 7.47s
======================================================================================================

= Test = round: 105 / acc: 89.360% / loss: 0.3729 / Time: 0.64s
======================================================================================================

round 105 local learning rate = 0.01

>>> Round:  106 / Acc: 88.485% / Loss: 0.3982 / Grad Norm: 0.5423 / Grad Diff: 58.7455 / Time: 7.43s
======================================================================================================

round 106 local learning rate = 0.01

>>> Round:  107 / Acc: 88.554% / Loss: 0.3958 / Grad Norm: 0.5473 / Grad Diff: 58.3207 / Time: 7.48s
======================================================================================================

round 107 local learning rate = 0.01

>>> Round:  108 / Acc: 88.649% / Loss: 0.3933 / Grad Norm: 0.5138 / Grad Diff: 57.6637 / Time: 7.54s
======================================================================================================

round 108 local learning rate = 0.01

>>> Round:  109 / Acc: 88.712% / Loss: 0.3918 / Grad Norm: 0.5361 / Grad Diff: 56.5018 / Time: 7.54s
======================================================================================================

round 109 local learning rate = 0.01

>>> Round:  110 / Acc: 88.784% / Loss: 0.3892 / Grad Norm: 0.5003 / Grad Diff: 55.9174 / Time: 7.60s
======================================================================================================

= Test = round: 110 / acc: 89.800% / loss: 0.3620 / Time: 0.63s
======================================================================================================

round 110 local learning rate = 0.01

>>> Round:  111 / Acc: 88.845% / Loss: 0.3875 / Grad Norm: 0.5618 / Grad Diff: 55.3773 / Time: 7.62s
======================================================================================================

round 111 local learning rate = 0.01

>>> Round:  112 / Acc: 88.886% / Loss: 0.3847 / Grad Norm: 0.5106 / Grad Diff: 54.8387 / Time: 7.11s
======================================================================================================

round 112 local learning rate = 0.01

>>> Round:  113 / Acc: 88.952% / Loss: 0.3832 / Grad Norm: 0.5153 / Grad Diff: 53.7306 / Time: 8.24s
======================================================================================================

round 113 local learning rate = 0.01

>>> Round:  114 / Acc: 89.009% / Loss: 0.3806 / Grad Norm: 0.5334 / Grad Diff: 53.6912 / Time: 7.64s
======================================================================================================

round 114 local learning rate = 0.01

>>> Round:  115 / Acc: 89.033% / Loss: 0.3790 / Grad Norm: 0.5706 / Grad Diff: 52.9577 / Time: 7.56s
======================================================================================================

= Test = round: 115 / acc: 90.000% / loss: 0.3518 / Time: 0.63s
======================================================================================================

round 115 local learning rate = 0.01

>>> Round:  116 / Acc: 89.151% / Loss: 0.3768 / Grad Norm: 0.5767 / Grad Diff: 52.5012 / Time: 8.00s
======================================================================================================

round 116 local learning rate = 0.01

>>> Round:  117 / Acc: 89.232% / Loss: 0.3746 / Grad Norm: 0.5249 / Grad Diff: 51.8388 / Time: 8.98s
======================================================================================================

round 117 local learning rate = 0.01

>>> Round:  118 / Acc: 89.258% / Loss: 0.3728 / Grad Norm: 0.5624 / Grad Diff: 51.4399 / Time: 7.53s
======================================================================================================

round 118 local learning rate = 0.01

>>> Round:  119 / Acc: 89.369% / Loss: 0.3694 / Grad Norm: 0.4636 / Grad Diff: 51.2143 / Time: 7.46s
======================================================================================================

round 119 local learning rate = 0.01

>>> Round:  120 / Acc: 89.432% / Loss: 0.3669 / Grad Norm: 0.4915 / Grad Diff: 51.4145 / Time: 7.54s
======================================================================================================

= Test = round: 120 / acc: 90.360% / loss: 0.3405 / Time: 0.63s
======================================================================================================

round 120 local learning rate = 0.01

>>> Round:  121 / Acc: 89.399% / Loss: 0.3654 / Grad Norm: 0.5521 / Grad Diff: 51.0467 / Time: 7.75s
======================================================================================================

round 121 local learning rate = 0.01

>>> Round:  122 / Acc: 89.480% / Loss: 0.3630 / Grad Norm: 0.5254 / Grad Diff: 50.7333 / Time: 7.46s
======================================================================================================

round 122 local learning rate = 0.01

>>> Round:  123 / Acc: 89.568% / Loss: 0.3609 / Grad Norm: 0.5201 / Grad Diff: 50.3836 / Time: 7.44s
======================================================================================================

round 123 local learning rate = 0.01

>>> Round:  124 / Acc: 89.616% / Loss: 0.3592 / Grad Norm: 0.4672 / Grad Diff: 49.4649 / Time: 7.73s
======================================================================================================

round 124 local learning rate = 0.01

>>> Round:  125 / Acc: 89.655% / Loss: 0.3568 / Grad Norm: 0.4624 / Grad Diff: 49.4853 / Time: 7.50s
======================================================================================================

= Test = round: 125 / acc: 90.550% / loss: 0.3309 / Time: 0.65s
======================================================================================================

round 125 local learning rate = 0.01

>>> Round:  126 / Acc: 89.723% / Loss: 0.3550 / Grad Norm: 0.4933 / Grad Diff: 49.1439 / Time: 7.47s
======================================================================================================

round 126 local learning rate = 0.01

>>> Round:  127 / Acc: 89.788% / Loss: 0.3525 / Grad Norm: 0.4167 / Grad Diff: 48.7874 / Time: 7.48s
======================================================================================================

round 127 local learning rate = 0.01

>>> Round:  128 / Acc: 89.823% / Loss: 0.3507 / Grad Norm: 0.4123 / Grad Diff: 48.5097 / Time: 10.12s
======================================================================================================

round 128 local learning rate = 0.01

>>> Round:  129 / Acc: 89.871% / Loss: 0.3492 / Grad Norm: 0.4830 / Grad Diff: 48.3335 / Time: 7.52s
======================================================================================================

round 129 local learning rate = 0.01

>>> Round:  130 / Acc: 89.887% / Loss: 0.3474 / Grad Norm: 0.4442 / Grad Diff: 47.8331 / Time: 7.26s
======================================================================================================

= Test = round: 130 / acc: 90.810% / loss: 0.3217 / Time: 0.65s
======================================================================================================

round 130 local learning rate = 0.01

>>> Round:  131 / Acc: 89.924% / Loss: 0.3463 / Grad Norm: 0.4668 / Grad Diff: 47.2436 / Time: 7.71s
======================================================================================================

round 131 local learning rate = 0.01

>>> Round:  132 / Acc: 89.967% / Loss: 0.3443 / Grad Norm: 0.4557 / Grad Diff: 47.0141 / Time: 7.81s
======================================================================================================

round 132 local learning rate = 0.01

>>> Round:  133 / Acc: 90.020% / Loss: 0.3437 / Grad Norm: 0.4837 / Grad Diff: 45.9083 / Time: 7.63s
======================================================================================================

round 133 local learning rate = 0.01

>>> Round:  134 / Acc: 90.030% / Loss: 0.3420 / Grad Norm: 0.5141 / Grad Diff: 45.7990 / Time: 7.59s
======================================================================================================

round 134 local learning rate = 0.01

>>> Round:  135 / Acc: 90.140% / Loss: 0.3398 / Grad Norm: 0.4385 / Grad Diff: 45.2754 / Time: 7.20s
======================================================================================================

= Test = round: 135 / acc: 91.080% / loss: 0.3148 / Time: 0.63s
======================================================================================================

round 135 local learning rate = 0.01

>>> Round:  136 / Acc: 90.194% / Loss: 0.3379 / Grad Norm: 0.3930 / Grad Diff: 44.8329 / Time: 7.65s
======================================================================================================

round 136 local learning rate = 0.01

>>> Round:  137 / Acc: 90.260% / Loss: 0.3362 / Grad Norm: 0.4720 / Grad Diff: 45.1263 / Time: 7.48s
======================================================================================================

round 137 local learning rate = 0.01

>>> Round:  138 / Acc: 90.273% / Loss: 0.3352 / Grad Norm: 0.4780 / Grad Diff: 44.2832 / Time: 7.46s
======================================================================================================

round 138 local learning rate = 0.01

>>> Round:  139 / Acc: 90.279% / Loss: 0.3333 / Grad Norm: 0.4378 / Grad Diff: 43.8538 / Time: 8.54s
======================================================================================================

round 139 local learning rate = 0.01

>>> Round:  140 / Acc: 90.367% / Loss: 0.3313 / Grad Norm: 0.4343 / Grad Diff: 43.8638 / Time: 7.74s
======================================================================================================

= Test = round: 140 / acc: 91.250% / loss: 0.3064 / Time: 0.61s
======================================================================================================

round 140 local learning rate = 0.01

>>> Round:  141 / Acc: 90.399% / Loss: 0.3297 / Grad Norm: 0.4271 / Grad Diff: 43.6161 / Time: 7.53s
======================================================================================================

round 141 local learning rate = 0.01

>>> Round:  142 / Acc: 90.435% / Loss: 0.3281 / Grad Norm: 0.4622 / Grad Diff: 43.5934 / Time: 7.47s
======================================================================================================

round 142 local learning rate = 0.01

>>> Round:  143 / Acc: 90.478% / Loss: 0.3264 / Grad Norm: 0.4551 / Grad Diff: 43.3022 / Time: 7.43s
======================================================================================================

round 143 local learning rate = 0.01

>>> Round:  144 / Acc: 90.506% / Loss: 0.3249 / Grad Norm: 0.4270 / Grad Diff: 42.7620 / Time: 7.49s
======================================================================================================

round 144 local learning rate = 0.01

>>> Round:  145 / Acc: 90.574% / Loss: 0.3233 / Grad Norm: 0.4065 / Grad Diff: 42.3029 / Time: 7.42s
======================================================================================================

= Test = round: 145 / acc: 91.500% / loss: 0.2989 / Time: 0.63s
======================================================================================================

round 145 local learning rate = 0.01

>>> Round:  146 / Acc: 90.622% / Loss: 0.3216 / Grad Norm: 0.3637 / Grad Diff: 42.1188 / Time: 7.49s
======================================================================================================

round 146 local learning rate = 0.01

>>> Round:  147 / Acc: 90.664% / Loss: 0.3206 / Grad Norm: 0.4569 / Grad Diff: 42.0731 / Time: 7.41s
======================================================================================================

round 147 local learning rate = 0.01

>>> Round:  148 / Acc: 90.697% / Loss: 0.3185 / Grad Norm: 0.3805 / Grad Diff: 41.5849 / Time: 7.15s
======================================================================================================

round 148 local learning rate = 0.01

>>> Round:  149 / Acc: 90.769% / Loss: 0.3171 / Grad Norm: 0.3914 / Grad Diff: 41.2330 / Time: 7.45s
======================================================================================================

round 149 local learning rate = 0.01

>>> Round:  150 / Acc: 90.777% / Loss: 0.3155 / Grad Norm: 0.3784 / Grad Diff: 41.0115 / Time: 7.45s
======================================================================================================

= Test = round: 150 / acc: 91.710% / loss: 0.2913 / Time: 0.61s
======================================================================================================

round 150 local learning rate = 0.01

>>> Round:  151 / Acc: 90.834% / Loss: 0.3141 / Grad Norm: 0.3732 / Grad Diff: 40.8326 / Time: 7.51s
======================================================================================================

round 151 local learning rate = 0.01

>>> Round:  152 / Acc: 90.852% / Loss: 0.3137 / Grad Norm: 0.4215 / Grad Diff: 40.0114 / Time: 7.02s
======================================================================================================

round 152 local learning rate = 0.01

>>> Round:  153 / Acc: 90.891% / Loss: 0.3119 / Grad Norm: 0.4072 / Grad Diff: 40.0073 / Time: 7.58s
======================================================================================================

round 153 local learning rate = 0.01

>>> Round:  154 / Acc: 90.952% / Loss: 0.3101 / Grad Norm: 0.3892 / Grad Diff: 39.9664 / Time: 7.56s
======================================================================================================

round 154 local learning rate = 0.01

>>> Round:  155 / Acc: 90.987% / Loss: 0.3095 / Grad Norm: 0.4754 / Grad Diff: 39.6598 / Time: 7.51s
======================================================================================================

= Test = round: 155 / acc: 91.780% / loss: 0.2863 / Time: 0.61s
======================================================================================================

round 155 local learning rate = 0.01

>>> Round:  156 / Acc: 91.068% / Loss: 0.3077 / Grad Norm: 0.4444 / Grad Diff: 39.4197 / Time: 7.62s
======================================================================================================

round 156 local learning rate = 0.01

>>> Round:  157 / Acc: 91.120% / Loss: 0.3064 / Grad Norm: 0.4317 / Grad Diff: 39.1317 / Time: 7.75s
======================================================================================================

round 157 local learning rate = 0.01

>>> Round:  158 / Acc: 91.100% / Loss: 0.3058 / Grad Norm: 0.4747 / Grad Diff: 38.6424 / Time: 7.47s
======================================================================================================

round 158 local learning rate = 0.01

>>> Round:  159 / Acc: 91.172% / Loss: 0.3043 / Grad Norm: 0.4862 / Grad Diff: 38.4553 / Time: 7.25s
======================================================================================================

round 159 local learning rate = 0.01

>>> Round:  160 / Acc: 91.212% / Loss: 0.3027 / Grad Norm: 0.4017 / Grad Diff: 37.8691 / Time: 7.67s
======================================================================================================

= Test = round: 160 / acc: 92.000% / loss: 0.2793 / Time: 0.63s
======================================================================================================

round 160 local learning rate = 0.01

>>> Round:  161 / Acc: 91.220% / Loss: 0.3024 / Grad Norm: 0.4589 / Grad Diff: 37.2252 / Time: 8.70s
======================================================================================================

round 161 local learning rate = 0.01

>>> Round:  162 / Acc: 91.280% / Loss: 0.3001 / Grad Norm: 0.3853 / Grad Diff: 37.1952 / Time: 7.56s
======================================================================================================

round 162 local learning rate = 0.01

>>> Round:  163 / Acc: 91.330% / Loss: 0.2988 / Grad Norm: 0.4191 / Grad Diff: 37.1860 / Time: 7.55s
======================================================================================================

round 163 local learning rate = 0.01

>>> Round:  164 / Acc: 91.376% / Loss: 0.2972 / Grad Norm: 0.4053 / Grad Diff: 37.0641 / Time: 8.62s
======================================================================================================

round 164 local learning rate = 0.01

>>> Round:  165 / Acc: 91.371% / Loss: 0.2958 / Grad Norm: 0.4091 / Grad Diff: 36.9214 / Time: 7.28s
======================================================================================================

= Test = round: 165 / acc: 92.220% / loss: 0.2728 / Time: 0.62s
======================================================================================================

round 165 local learning rate = 0.01

>>> Round:  166 / Acc: 91.452% / Loss: 0.2942 / Grad Norm: 0.3615 / Grad Diff: 36.5950 / Time: 7.45s
======================================================================================================

round 166 local learning rate = 0.01

>>> Round:  167 / Acc: 91.437% / Loss: 0.2928 / Grad Norm: 0.3350 / Grad Diff: 36.3901 / Time: 6.83s
======================================================================================================

round 167 local learning rate = 0.01

>>> Round:  168 / Acc: 91.461% / Loss: 0.2921 / Grad Norm: 0.4209 / Grad Diff: 36.2479 / Time: 6.98s
======================================================================================================

round 168 local learning rate = 0.01

>>> Round:  169 / Acc: 91.535% / Loss: 0.2899 / Grad Norm: 0.3670 / Grad Diff: 36.3118 / Time: 7.79s
======================================================================================================

round 169 local learning rate = 0.01

>>> Round:  170 / Acc: 91.565% / Loss: 0.2895 / Grad Norm: 0.4405 / Grad Diff: 35.9878 / Time: 7.79s
======================================================================================================

= Test = round: 170 / acc: 92.170% / loss: 0.2666 / Time: 0.60s
======================================================================================================

round 170 local learning rate = 0.01

>>> Round:  171 / Acc: 91.561% / Loss: 0.2884 / Grad Norm: 0.4353 / Grad Diff: 35.5117 / Time: 7.54s
======================================================================================================

round 171 local learning rate = 0.01

>>> Round:  172 / Acc: 91.624% / Loss: 0.2875 / Grad Norm: 0.4751 / Grad Diff: 35.4448 / Time: 7.86s
======================================================================================================

round 172 local learning rate = 0.01

>>> Round:  173 / Acc: 91.625% / Loss: 0.2863 / Grad Norm: 0.4794 / Grad Diff: 35.2384 / Time: 7.79s
======================================================================================================

round 173 local learning rate = 0.01

>>> Round:  174 / Acc: 91.633% / Loss: 0.2847 / Grad Norm: 0.4503 / Grad Diff: 35.0768 / Time: 9.88s
======================================================================================================

round 174 local learning rate = 0.01

>>> Round:  175 / Acc: 91.710% / Loss: 0.2829 / Grad Norm: 0.3651 / Grad Diff: 34.7690 / Time: 7.55s
======================================================================================================

= Test = round: 175 / acc: 92.380% / loss: 0.2606 / Time: 0.64s
======================================================================================================

round 175 local learning rate = 0.01

>>> Round:  176 / Acc: 91.718% / Loss: 0.2817 / Grad Norm: 0.3884 / Grad Diff: 34.6618 / Time: 7.53s
======================================================================================================

round 176 local learning rate = 0.01

>>> Round:  177 / Acc: 91.699% / Loss: 0.2811 / Grad Norm: 0.4060 / Grad Diff: 34.2112 / Time: 7.60s
======================================================================================================

round 177 local learning rate = 0.01

>>> Round:  178 / Acc: 91.784% / Loss: 0.2797 / Grad Norm: 0.4063 / Grad Diff: 34.1773 / Time: 7.52s
======================================================================================================

round 178 local learning rate = 0.01

>>> Round:  179 / Acc: 91.839% / Loss: 0.2783 / Grad Norm: 0.3826 / Grad Diff: 34.0439 / Time: 7.82s
======================================================================================================

round 179 local learning rate = 0.01

>>> Round:  180 / Acc: 91.836% / Loss: 0.2771 / Grad Norm: 0.3736 / Grad Diff: 33.8480 / Time: 7.30s
======================================================================================================

= Test = round: 180 / acc: 92.530% / loss: 0.2547 / Time: 0.66s
======================================================================================================

round 180 local learning rate = 0.01

>>> Round:  181 / Acc: 91.889% / Loss: 0.2759 / Grad Norm: 0.3662 / Grad Diff: 33.6622 / Time: 8.15s
======================================================================================================

round 181 local learning rate = 0.01

>>> Round:  182 / Acc: 91.900% / Loss: 0.2749 / Grad Norm: 0.3916 / Grad Diff: 33.4460 / Time: 7.50s
======================================================================================================

round 182 local learning rate = 0.01

>>> Round:  183 / Acc: 91.926% / Loss: 0.2740 / Grad Norm: 0.3920 / Grad Diff: 33.1163 / Time: 8.03s
======================================================================================================

round 183 local learning rate = 0.01

>>> Round:  184 / Acc: 92.009% / Loss: 0.2726 / Grad Norm: 0.3272 / Grad Diff: 32.9435 / Time: 7.48s
======================================================================================================

round 184 local learning rate = 0.01

>>> Round:  185 / Acc: 92.076% / Loss: 0.2710 / Grad Norm: 0.3058 / Grad Diff: 32.9196 / Time: 7.27s
======================================================================================================

= Test = round: 185 / acc: 92.790% / loss: 0.2493 / Time: 0.61s
======================================================================================================

round 185 local learning rate = 0.01

>>> Round:  186 / Acc: 92.083% / Loss: 0.2702 / Grad Norm: 0.3248 / Grad Diff: 32.5945 / Time: 7.50s
======================================================================================================

round 186 local learning rate = 0.01

>>> Round:  187 / Acc: 92.151% / Loss: 0.2689 / Grad Norm: 0.3119 / Grad Diff: 32.6312 / Time: 7.39s
======================================================================================================

round 187 local learning rate = 0.01

>>> Round:  188 / Acc: 92.159% / Loss: 0.2680 / Grad Norm: 0.3090 / Grad Diff: 32.2810 / Time: 7.49s
======================================================================================================

round 188 local learning rate = 0.01

>>> Round:  189 / Acc: 92.168% / Loss: 0.2673 / Grad Norm: 0.3697 / Grad Diff: 31.9910 / Time: 7.55s
======================================================================================================

round 189 local learning rate = 0.01

>>> Round:  190 / Acc: 92.181% / Loss: 0.2665 / Grad Norm: 0.3960 / Grad Diff: 31.8570 / Time: 7.42s
======================================================================================================

= Test = round: 190 / acc: 92.900% / loss: 0.2452 / Time: 0.63s
======================================================================================================

round 190 local learning rate = 0.01

>>> Round:  191 / Acc: 92.216% / Loss: 0.2651 / Grad Norm: 0.3702 / Grad Diff: 31.6783 / Time: 7.55s
======================================================================================================

round 191 local learning rate = 0.01

>>> Round:  192 / Acc: 92.264% / Loss: 0.2639 / Grad Norm: 0.3588 / Grad Diff: 31.5368 / Time: 7.55s
======================================================================================================

round 192 local learning rate = 0.01

>>> Round:  193 / Acc: 92.214% / Loss: 0.2636 / Grad Norm: 0.5046 / Grad Diff: 32.0128 / Time: 7.46s
======================================================================================================

round 193 local learning rate = 0.01

>>> Round:  194 / Acc: 92.317% / Loss: 0.2615 / Grad Norm: 0.3577 / Grad Diff: 31.6004 / Time: 7.58s
======================================================================================================

round 194 local learning rate = 0.01

>>> Round:  195 / Acc: 92.338% / Loss: 0.2599 / Grad Norm: 0.3058 / Grad Diff: 31.6041 / Time: 7.28s
======================================================================================================

= Test = round: 195 / acc: 93.020% / loss: 0.2387 / Time: 0.62s
======================================================================================================

round 195 local learning rate = 0.01

>>> Round:  196 / Acc: 92.317% / Loss: 0.2599 / Grad Norm: 0.4330 / Grad Diff: 31.4028 / Time: 7.45s
======================================================================================================

round 196 local learning rate = 0.01

>>> Round:  197 / Acc: 92.352% / Loss: 0.2585 / Grad Norm: 0.3722 / Grad Diff: 31.0928 / Time: 7.45s
======================================================================================================

round 197 local learning rate = 0.01

>>> Round:  198 / Acc: 92.360% / Loss: 0.2584 / Grad Norm: 0.4191 / Grad Diff: 30.6124 / Time: 7.52s
======================================================================================================

round 198 local learning rate = 0.01

>>> Round:  199 / Acc: 92.419% / Loss: 0.2574 / Grad Norm: 0.3977 / Grad Diff: 30.4125 / Time: 9.56s
======================================================================================================

round 199 local learning rate = 0.01

>>> Round:  200 / Acc: 92.467% / Loss: 0.2561 / Grad Norm: 0.3455 / Grad Diff: 30.1726 / Time: 9.63s
======================================================================================================

= Test = round: 200 / acc: 93.160% / loss: 0.2353 / Time: 0.82s
======================================================================================================

>>> Training model_target_only
Epoch: 001, Train_loss: 0.6219, Train_acc: 0.8130, Test_loss: 0.6299, Test_acc: 0.8131
Epoch: 006, Train_loss: 0.3671, Train_acc: 0.8813, Test_loss: 0.4372, Test_acc: 0.8589
Epoch: 011, Train_loss: 0.2604, Train_acc: 0.9141, Test_loss: 0.4159, Test_acc: 0.8692
Epoch: 016, Train_loss: 0.1944, Train_acc: 0.9363, Test_loss: 0.4660, Test_acc: 0.8697
Epoch: 021, Train_loss: 0.1700, Train_acc: 0.9415, Test_loss: 0.5268, Test_acc: 0.8697
Epoch: 026, Train_loss: 0.1192, Train_acc: 0.9592, Test_loss: 0.6067, Test_acc: 0.8710
Epoch: 031, Train_loss: 0.0995, Train_acc: 0.9667, Test_loss: 0.7072, Test_acc: 0.8665
Epoch: 036, Train_loss: 0.0863, Train_acc: 0.9713, Test_loss: 0.7777, Test_acc: 0.8620
Epoch: 041, Train_loss: 0.0736, Train_acc: 0.9744, Test_loss: 0.8912, Test_acc: 0.8651
Epoch: 046, Train_loss: 0.0625, Train_acc: 0.9785, Test_loss: 0.9918, Test_acc: 0.8656
Epoch: 051, Train_loss: 0.0564, Train_acc: 0.9805, Test_loss: 1.1303, Test_acc: 0.8626
Epoch: 056, Train_loss: 0.0584, Train_acc: 0.9801, Test_loss: 1.1947, Test_acc: 0.8633
Epoch: 061, Train_loss: 0.0658, Train_acc: 0.9778, Test_loss: 1.2982, Test_acc: 0.8610
Epoch: 066, Train_loss: 0.0368, Train_acc: 0.9876, Test_loss: 1.3288, Test_acc: 0.8681
Epoch: 071, Train_loss: 0.0302, Train_acc: 0.9905, Test_loss: 1.4267, Test_acc: 0.8620
Epoch: 076, Train_loss: 0.0436, Train_acc: 0.9854, Test_loss: 1.5052, Test_acc: 0.8592
Epoch: 081, Train_loss: 0.0227, Train_acc: 0.9924, Test_loss: 1.5801, Test_acc: 0.8597
Epoch: 086, Train_loss: 0.0198, Train_acc: 0.9936, Test_loss: 1.6118, Test_acc: 0.8611
Epoch: 091, Train_loss: 0.0570, Train_acc: 0.9821, Test_loss: 1.7226, Test_acc: 0.8591
Epoch: 096, Train_loss: 0.0363, Train_acc: 0.9883, Test_loss: 1.6329, Test_acc: 0.8602
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230917045609_model_target_only.pt.
Model saved at ./models/ft_checkpoints/20230917045609_model_target_only.pt.
>>> Fine-tuning done!
>>> Training model_ft
Epoch: 001, Train_loss: 1.1553, Train_acc: 0.6421, Test_loss: 1.1411, Test_acc: 0.6458
Epoch: 006, Train_loss: 0.8790, Train_acc: 0.7239, Test_loss: 0.8864, Test_acc: 0.7250
Epoch: 011, Train_loss: 0.8091, Train_acc: 0.7460, Test_loss: 0.8348, Test_acc: 0.7367
Epoch: 016, Train_loss: 0.7774, Train_acc: 0.7542, Test_loss: 0.8181, Test_acc: 0.7425
Epoch: 021, Train_loss: 0.7440, Train_acc: 0.7659, Test_loss: 0.7942, Test_acc: 0.7527
Epoch: 026, Train_loss: 0.7213, Train_acc: 0.7718, Test_loss: 0.7773, Test_acc: 0.7545
Epoch: 031, Train_loss: 0.7141, Train_acc: 0.7731, Test_loss: 0.7869, Test_acc: 0.7539
Epoch: 036, Train_loss: 0.6992, Train_acc: 0.7773, Test_loss: 0.7736, Test_acc: 0.7586
Epoch: 041, Train_loss: 0.6954, Train_acc: 0.7757, Test_loss: 0.7735, Test_acc: 0.7578
Epoch: 046, Train_loss: 0.6715, Train_acc: 0.7842, Test_loss: 0.7595, Test_acc: 0.7642
Epoch: 051, Train_loss: 0.6710, Train_acc: 0.7850, Test_loss: 0.7668, Test_acc: 0.7591
Epoch: 056, Train_loss: 0.6629, Train_acc: 0.7872, Test_loss: 0.7625, Test_acc: 0.7612
Epoch: 061, Train_loss: 0.6449, Train_acc: 0.7917, Test_loss: 0.7497, Test_acc: 0.7637
Epoch: 066, Train_loss: 0.6552, Train_acc: 0.7883, Test_loss: 0.7653, Test_acc: 0.7576
Epoch: 071, Train_loss: 0.6535, Train_acc: 0.7895, Test_loss: 0.7689, Test_acc: 0.7600
Epoch: 076, Train_loss: 0.6384, Train_acc: 0.7941, Test_loss: 0.7621, Test_acc: 0.7622
Epoch: 081, Train_loss: 0.6418, Train_acc: 0.7911, Test_loss: 0.7743, Test_acc: 0.7606
Epoch: 086, Train_loss: 0.6392, Train_acc: 0.7931, Test_loss: 0.7739, Test_acc: 0.7635
Epoch: 091, Train_loss: 0.6292, Train_acc: 0.7960, Test_loss: 0.7664, Test_acc: 0.7655
Epoch: 096, Train_loss: 0.6275, Train_acc: 0.7970, Test_loss: 0.7619, Test_acc: 0.7658
Epoch: 101, Train_loss: 0.6149, Train_acc: 0.8010, Test_loss: 0.7568, Test_acc: 0.7669
Epoch: 106, Train_loss: 0.6204, Train_acc: 0.7990, Test_loss: 0.7673, Test_acc: 0.7651
Epoch: 111, Train_loss: 0.6271, Train_acc: 0.7970, Test_loss: 0.7740, Test_acc: 0.7601
Epoch: 116, Train_loss: 0.6130, Train_acc: 0.8003, Test_loss: 0.7643, Test_acc: 0.7634
Epoch: 121, Train_loss: 0.6069, Train_acc: 0.8017, Test_loss: 0.7631, Test_acc: 0.7621
Epoch: 126, Train_loss: 0.6152, Train_acc: 0.7977, Test_loss: 0.7735, Test_acc: 0.7618
Fine-tuning early stopped. Model saved at ./models/ft_checkpoints/20230917045609_model_ft.pt.
Model saved at ./models/ft_checkpoints/20230917045609_model_ft.pt.
>>> Fine-tuning done!
>>> Training model_random
Epoch: 001, Train_loss: 1.8502, Train_acc: 0.4109, Test_loss: 1.8512, Test_acc: 0.4065
Epoch: 006, Train_loss: 1.4297, Train_acc: 0.5306, Test_loss: 1.4358, Test_acc: 0.5243
Epoch: 011, Train_loss: 1.3142, Train_acc: 0.5716, Test_loss: 1.3199, Test_acc: 0.5682
Epoch: 016, Train_loss: 1.2414, Train_acc: 0.5950, Test_loss: 1.2481, Test_acc: 0.5952
Epoch: 021, Train_loss: 1.1897, Train_acc: 0.6120, Test_loss: 1.1980, Test_acc: 0.6054
Epoch: 026, Train_loss: 1.1523, Train_acc: 0.6242, Test_loss: 1.1643, Test_acc: 0.6148
Epoch: 031, Train_loss: 1.1210, Train_acc: 0.6323, Test_loss: 1.1396, Test_acc: 0.6226
Epoch: 036, Train_loss: 1.0918, Train_acc: 0.6429, Test_loss: 1.1158, Test_acc: 0.6330
Epoch: 041, Train_loss: 1.0729, Train_acc: 0.6475, Test_loss: 1.1009, Test_acc: 0.6364
Epoch: 046, Train_loss: 1.0582, Train_acc: 0.6518, Test_loss: 1.0914, Test_acc: 0.6394
Epoch: 051, Train_loss: 1.0428, Train_acc: 0.6575, Test_loss: 1.0799, Test_acc: 0.6446
Epoch: 056, Train_loss: 1.0375, Train_acc: 0.6570, Test_loss: 1.0822, Test_acc: 0.6435
Epoch: 061, Train_loss: 1.0176, Train_acc: 0.6656, Test_loss: 1.0668, Test_acc: 0.6503
Epoch: 066, Train_loss: 1.0069, Train_acc: 0.6673, Test_loss: 1.0620, Test_acc: 0.6488
Epoch: 071, Train_loss: 1.0001, Train_acc: 0.6698, Test_loss: 1.0600, Test_acc: 0.6516
Epoch: 076, Train_loss: 0.9888, Train_acc: 0.6733, Test_loss: 1.0509, Test_acc: 0.6556
Epoch: 081, Train_loss: 0.9846, Train_acc: 0.6768, Test_loss: 1.0509, Test_acc: 0.6567
Epoch: 086, Train_loss: 0.9762, Train_acc: 0.6778, Test_loss: 1.0465, Test_acc: 0.6565
Epoch: 091, Train_loss: 0.9726, Train_acc: 0.6783, Test_loss: 1.0463, Test_acc: 0.6577
Epoch: 096, Train_loss: 0.9643, Train_acc: 0.6813, Test_loss: 1.0432, Test_acc: 0.6583
Epoch: 101, Train_loss: 0.9614, Train_acc: 0.6828, Test_loss: 1.0397, Test_acc: 0.6610
Epoch: 106, Train_loss: 0.9557, Train_acc: 0.6820, Test_loss: 1.0379, Test_acc: 0.6608
Epoch: 111, Train_loss: 0.9536, Train_acc: 0.6849, Test_loss: 1.0422, Test_acc: 0.6573
Epoch: 116, Train_loss: 0.9481, Train_acc: 0.6850, Test_loss: 1.0380, Test_acc: 0.6608
Epoch: 121, Train_loss: 0.9416, Train_acc: 0.6897, Test_loss: 1.0343, Test_acc: 0.6608
Epoch: 126, Train_loss: 0.9383, Train_acc: 0.6889, Test_loss: 1.0344, Test_acc: 0.6621
Epoch: 131, Train_loss: 0.9330, Train_acc: 0.6919, Test_loss: 1.0299, Test_acc: 0.6656
Epoch: 136, Train_loss: 0.9325, Train_acc: 0.6917, Test_loss: 1.0356, Test_acc: 0.6634
Epoch: 141, Train_loss: 0.9329, Train_acc: 0.6917, Test_loss: 1.0331, Test_acc: 0.6669
Epoch: 146, Train_loss: 0.9257, Train_acc: 0.6933, Test_loss: 1.0345, Test_acc: 0.6657
Epoch: 151, Train_loss: 0.9221, Train_acc: 0.6949, Test_loss: 1.0329, Test_acc: 0.6654
Epoch: 156, Train_loss: 0.9218, Train_acc: 0.6962, Test_loss: 1.0328, Test_acc: 0.6655
Epoch: 161, Train_loss: 0.9196, Train_acc: 0.6955, Test_loss: 1.0369, Test_acc: 0.6663
Epoch: 166, Train_loss: 0.9167, Train_acc: 0.6969, Test_loss: 1.0335, Test_acc: 0.6678
Epoch: 171, Train_loss: 0.9115, Train_acc: 0.6993, Test_loss: 1.0325, Test_acc: 0.6683
Epoch: 176, Train_loss: 0.9107, Train_acc: 0.6994, Test_loss: 1.0311, Test_acc: 0.6728
Epoch: 181, Train_loss: 0.9088, Train_acc: 0.6998, Test_loss: 1.0338, Test_acc: 0.6676
Epoch: 186, Train_loss: 0.9103, Train_acc: 0.6981, Test_loss: 1.0345, Test_acc: 0.6668
Epoch: 191, Train_loss: 0.9054, Train_acc: 0.6999, Test_loss: 1.0344, Test_acc: 0.6704
Epoch: 196, Train_loss: 0.9083, Train_acc: 0.7006, Test_loss: 1.0419, Test_acc: 0.6650
Model saved at ./models/ft_checkpoints/20230917045609_model_random.pt.
>>> Fine-tuning done!
>>> Evaluating model_source_only
model_target_only: [0.019281110330838784, 0.9941017948848324, 1.6203807819394214, 0.8636818131318742]
model_ft: [0.6016191123928071, 0.8045117879357977, 0.7620455254622134, 0.7639151205421619]
model_random: [0.8993989312283676, 0.7035812952322842, 1.0314473561042812, 0.6709254527274747]
model_source_only: [2.501022761442813, 0.43375536007864274, 2.5414115615506105, 0.43217420286634817]
fl_test_acc_mean 0.9317
model_source_only_test_acc_mean 0.43217420286634817
model_ft_test_acc_mean 0.7639151205421619
model_target_only_test_acc_mean 0.8636818131318742
model_random_test_acc_mean 0.6709254527274747
