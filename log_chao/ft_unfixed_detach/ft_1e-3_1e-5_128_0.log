nohup: ignoring input
uid: 20230914141035
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 51871.0
	       batch_size : 64
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 20
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 100
	            ft_lr : 0.001
	            ft_wd : 1e-05
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 1
	               lr : 0.01
	            model : lenet
	           n_init : 5
	        noaverage : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 300
	           opt_lr : False
	            reg_J : False
	       reg_J_coef : 0.0
	             seed : 0
	               wd : 0.0001
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 51871.0.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl
FL pretrained model will be saved at ./models/lenet_mnist_20230914141035.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 7.980% / Loss: 12.2713 / Grad Norm: 126.3923 / Grad Diff: 60879.6881 / Time: 6.85s
======================================================================================================

= Test = round: 0 / acc: 9.170% / loss: 12.0287 / Time: 0.61s
======================================================================================================

round 0 local learning rate = 0.01

>>> Round:    1 / Acc: 13.766% / Loss: 2.2806 / Grad Norm: 1.5771 / Grad Diff: 38.4122 / Time: 6.87s
======================================================================================================

round 1 local learning rate = 0.01

>>> Round:    2 / Acc: 27.380% / Loss: 2.0752 / Grad Norm: 2.8354 / Grad Diff: 125.0684 / Time: 6.75s
======================================================================================================

round 2 local learning rate = 0.005

>>> Round:    3 / Acc: 39.821% / Loss: 1.8089 / Grad Norm: 4.8902 / Grad Diff: 480.7100 / Time: 6.64s
======================================================================================================

round 3 local learning rate = 0.0033333333333333335

>>> Round:    4 / Acc: 45.550% / Loss: 1.6330 / Grad Norm: 6.2098 / Grad Diff: 818.0597 / Time: 6.63s
======================================================================================================

round 4 local learning rate = 0.0025

>>> Round:    5 / Acc: 50.146% / Loss: 1.4916 / Grad Norm: 6.1199 / Grad Diff: 1019.9869 / Time: 6.90s
======================================================================================================

= Test = round: 5 / acc: 51.620% / loss: 1.4567 / Time: 0.60s
======================================================================================================

round 5 local learning rate = 0.002

>>> Round:    6 / Acc: 53.550% / Loss: 1.3851 / Grad Norm: 5.8588 / Grad Diff: 1134.3414 / Time: 6.71s
======================================================================================================

round 6 local learning rate = 0.0016666666666666668

>>> Round:    7 / Acc: 56.518% / Loss: 1.3015 / Grad Norm: 5.3983 / Grad Diff: 1229.3728 / Time: 6.88s
======================================================================================================

round 7 local learning rate = 0.0014285714285714286

>>> Round:    8 / Acc: 58.705% / Loss: 1.2378 / Grad Norm: 5.3040 / Grad Diff: 1299.8612 / Time: 6.98s
======================================================================================================

round 8 local learning rate = 0.00125

>>> Round:    9 / Acc: 60.448% / Loss: 1.1846 / Grad Norm: 5.1078 / Grad Diff: 1373.5012 / Time: 6.75s
======================================================================================================

round 9 local learning rate = 0.0011111111111111111

>>> Round:   10 / Acc: 61.948% / Loss: 1.1412 / Grad Norm: 5.1003 / Grad Diff: 1430.0853 / Time: 6.76s
======================================================================================================

= Test = round: 10 / acc: 63.560% / loss: 1.0936 / Time: 0.57s
======================================================================================================

round 10 local learning rate = 0.001

>>> Round:   11 / Acc: 63.218% / Loss: 1.1023 / Grad Norm: 4.8834 / Grad Diff: 1475.3995 / Time: 7.03s
======================================================================================================

round 11 local learning rate = 0.0009090909090909091

>>> Round:   12 / Acc: 64.306% / Loss: 1.0686 / Grad Norm: 4.5779 / Grad Diff: 1515.4319 / Time: 6.93s
======================================================================================================

round 12 local learning rate = 0.0008333333333333334

>>> Round:   13 / Acc: 65.255% / Loss: 1.0407 / Grad Norm: 4.6295 / Grad Diff: 1552.3046 / Time: 6.99s
======================================================================================================

round 13 local learning rate = 0.0007692307692307692

>>> Round:   14 / Acc: 66.066% / Loss: 1.0164 / Grad Norm: 4.7098 / Grad Diff: 1598.5345 / Time: 6.86s
======================================================================================================

round 14 local learning rate = 0.0007142857142857143

>>> Round:   15 / Acc: 66.806% / Loss: 0.9927 / Grad Norm: 4.4851 / Grad Diff: 1625.8824 / Time: 6.69s
======================================================================================================

= Test = round: 15 / acc: 68.350% / loss: 0.9440 / Time: 0.56s
======================================================================================================

round 15 local learning rate = 0.0006666666666666666

>>> Round:   16 / Acc: 67.461% / Loss: 0.9731 / Grad Norm: 4.5699 / Grad Diff: 1662.7506 / Time: 6.77s
======================================================================================================

round 16 local learning rate = 0.000625

>>> Round:   17 / Acc: 68.017% / Loss: 0.9545 / Grad Norm: 4.4924 / Grad Diff: 1696.8466 / Time: 6.65s
======================================================================================================

round 17 local learning rate = 0.0005882352941176471

>>> Round:   18 / Acc: 68.616% / Loss: 0.9364 / Grad Norm: 4.1393 / Grad Diff: 1719.9962 / Time: 6.95s
======================================================================================================

round 18 local learning rate = 0.0005555555555555556

>>> Round:   19 / Acc: 69.122% / Loss: 0.9217 / Grad Norm: 4.2482 / Grad Diff: 1753.7965 / Time: 7.04s
======================================================================================================

round 19 local learning rate = 0.0005263157894736842

>>> Round:   20 / Acc: 69.559% / Loss: 0.9074 / Grad Norm: 4.1887 / Grad Diff: 1786.5135 / Time: 6.90s
======================================================================================================

= Test = round: 20 / acc: 71.140% / loss: 0.8593 / Time: 0.57s
======================================================================================================

round 20 local learning rate = 0.0005

>>> Round:   21 / Acc: 70.063% / Loss: 0.8940 / Grad Norm: 4.0910 / Grad Diff: 1817.2385 / Time: 6.89s
======================================================================================================

round 21 local learning rate = 0.0004761904761904762

>>> Round:   22 / Acc: 70.467% / Loss: 0.8814 / Grad Norm: 3.9796 / Grad Diff: 1840.8110 / Time: 6.92s
======================================================================================================

round 22 local learning rate = 0.00045454545454545455

>>> Round:   23 / Acc: 70.828% / Loss: 0.8696 / Grad Norm: 3.7961 / Grad Diff: 1863.5152 / Time: 6.66s
======================================================================================================

round 23 local learning rate = 0.0004347826086956522

>>> Round:   24 / Acc: 71.170% / Loss: 0.8592 / Grad Norm: 3.9516 / Grad Diff: 1892.9826 / Time: 6.70s
======================================================================================================

round 24 local learning rate = 0.0004166666666666667

>>> Round:   25 / Acc: 71.542% / Loss: 0.8488 / Grad Norm: 3.9228 / Grad Diff: 1913.1063 / Time: 6.79s
======================================================================================================

= Test = round: 25 / acc: 73.070% / loss: 0.8009 / Time: 0.57s
======================================================================================================

round 25 local learning rate = 0.0004

>>> Round:   26 / Acc: 71.878% / Loss: 0.8393 / Grad Norm: 3.7856 / Grad Diff: 1936.7514 / Time: 6.71s
======================================================================================================

round 26 local learning rate = 0.0003846153846153846

>>> Round:   27 / Acc: 72.131% / Loss: 0.8303 / Grad Norm: 3.8477 / Grad Diff: 1955.4596 / Time: 6.77s
======================================================================================================

round 27 local learning rate = 0.00037037037037037035

>>> Round:   28 / Acc: 72.410% / Loss: 0.8216 / Grad Norm: 3.7810 / Grad Diff: 1976.7804 / Time: 6.71s
======================================================================================================

round 28 local learning rate = 0.00035714285714285714

>>> Round:   29 / Acc: 72.661% / Loss: 0.8136 / Grad Norm: 3.7847 / Grad Diff: 2001.2914 / Time: 6.77s
======================================================================================================

round 29 local learning rate = 0.0003448275862068966

>>> Round:   30 / Acc: 72.904% / Loss: 0.8061 / Grad Norm: 3.8218 / Grad Diff: 2026.6321 / Time: 6.43s
======================================================================================================

= Test = round: 30 / acc: 74.400% / loss: 0.7592 / Time: 0.56s
======================================================================================================

round 30 local learning rate = 0.0003333333333333333

>>> Round:   31 / Acc: 73.201% / Loss: 0.7987 / Grad Norm: 3.7464 / Grad Diff: 2042.4317 / Time: 6.93s
======================================================================================================

round 31 local learning rate = 0.0003225806451612903

>>> Round:   32 / Acc: 73.446% / Loss: 0.7919 / Grad Norm: 3.7974 / Grad Diff: 2067.8626 / Time: 6.66s
======================================================================================================

round 32 local learning rate = 0.0003125

>>> Round:   33 / Acc: 73.661% / Loss: 0.7850 / Grad Norm: 3.7171 / Grad Diff: 2087.9713 / Time: 7.03s
======================================================================================================

round 33 local learning rate = 0.00030303030303030303

>>> Round:   34 / Acc: 73.923% / Loss: 0.7783 / Grad Norm: 3.6434 / Grad Diff: 2104.0846 / Time: 6.80s
======================================================================================================

round 34 local learning rate = 0.00029411764705882356

>>> Round:   35 / Acc: 74.127% / Loss: 0.7722 / Grad Norm: 3.6579 / Grad Diff: 2122.0747 / Time: 6.76s
======================================================================================================

= Test = round: 35 / acc: 75.620% / loss: 0.7261 / Time: 0.57s
======================================================================================================

round 35 local learning rate = 0.00028571428571428574

>>> Round:   36 / Acc: 74.328% / Loss: 0.7667 / Grad Norm: 3.7896 / Grad Diff: 2142.7146 / Time: 6.67s
======================================================================================================

round 36 local learning rate = 0.0002777777777777778

>>> Round:   37 / Acc: 74.511% / Loss: 0.7607 / Grad Norm: 3.6779 / Grad Diff: 2161.9615 / Time: 6.73s
======================================================================================================

round 37 local learning rate = 0.0002702702702702703

>>> Round:   38 / Acc: 74.696% / Loss: 0.7549 / Grad Norm: 3.5190 / Grad Diff: 2178.5947 / Time: 6.80s
======================================================================================================

round 38 local learning rate = 0.0002631578947368421

>>> Round:   39 / Acc: 74.852% / Loss: 0.7496 / Grad Norm: 3.4746 / Grad Diff: 2192.3885 / Time: 7.00s
======================================================================================================

round 39 local learning rate = 0.0002564102564102564

>>> Round:   40 / Acc: 75.022% / Loss: 0.7445 / Grad Norm: 3.4078 / Grad Diff: 2208.8940 / Time: 7.25s
======================================================================================================

= Test = round: 40 / acc: 76.490% / loss: 0.6988 / Time: 0.59s
======================================================================================================

round 40 local learning rate = 0.00025

>>> Round:   41 / Acc: 75.144% / Loss: 0.7402 / Grad Norm: 3.6518 / Grad Diff: 2231.6284 / Time: 6.78s
======================================================================================================

round 41 local learning rate = 0.00024390243902439024

>>> Round:   42 / Acc: 75.245% / Loss: 0.7355 / Grad Norm: 3.7006 / Grad Diff: 2247.9922 / Time: 6.68s
======================================================================================================

round 42 local learning rate = 0.0002380952380952381

>>> Round:   43 / Acc: 75.443% / Loss: 0.7311 / Grad Norm: 3.8267 / Grad Diff: 2264.3256 / Time: 6.91s
======================================================================================================

round 43 local learning rate = 0.00023255813953488373

>>> Round:   44 / Acc: 75.559% / Loss: 0.7258 / Grad Norm: 3.4428 / Grad Diff: 2273.9777 / Time: 6.90s
======================================================================================================

round 44 local learning rate = 0.00022727272727272727

>>> Round:   45 / Acc: 75.688% / Loss: 0.7215 / Grad Norm: 3.4670 / Grad Diff: 2290.6575 / Time: 6.98s
======================================================================================================

= Test = round: 45 / acc: 77.020% / loss: 0.6763 / Time: 0.61s
======================================================================================================

round 45 local learning rate = 0.00022222222222222223

>>> Round:   46 / Acc: 75.821% / Loss: 0.7174 / Grad Norm: 3.5160 / Grad Diff: 2304.3340 / Time: 6.83s
======================================================================================================

round 46 local learning rate = 0.0002173913043478261

>>> Round:   47 / Acc: 75.980% / Loss: 0.7134 / Grad Norm: 3.5346 / Grad Diff: 2318.8839 / Time: 6.60s
======================================================================================================

round 47 local learning rate = 0.0002127659574468085

>>> Round:   48 / Acc: 76.096% / Loss: 0.7093 / Grad Norm: 3.4996 / Grad Diff: 2332.7440 / Time: 6.85s
======================================================================================================

round 48 local learning rate = 0.00020833333333333335

>>> Round:   49 / Acc: 76.238% / Loss: 0.7056 / Grad Norm: 3.5837 / Grad Diff: 2347.1393 / Time: 7.06s
======================================================================================================

round 49 local learning rate = 0.00020408163265306123

>>> Round:   50 / Acc: 76.356% / Loss: 0.7016 / Grad Norm: 3.4240 / Grad Diff: 2357.2427 / Time: 6.82s
======================================================================================================

= Test = round: 50 / acc: 77.520% / loss: 0.6567 / Time: 0.64s
======================================================================================================

round 50 local learning rate = 0.0002

>>> Round:   51 / Acc: 76.498% / Loss: 0.6978 / Grad Norm: 3.3000 / Grad Diff: 2369.6750 / Time: 6.85s
======================================================================================================

round 51 local learning rate = 0.000196078431372549

>>> Round:   52 / Acc: 76.629% / Loss: 0.6947 / Grad Norm: 3.4642 / Grad Diff: 2383.6360 / Time: 6.73s
======================================================================================================

round 52 local learning rate = 0.0001923076923076923

>>> Round:   53 / Acc: 76.731% / Loss: 0.6910 / Grad Norm: 3.3390 / Grad Diff: 2395.0765 / Time: 6.98s
======================================================================================================

round 53 local learning rate = 0.00018867924528301886

>>> Round:   54 / Acc: 76.856% / Loss: 0.6878 / Grad Norm: 3.3996 / Grad Diff: 2407.7164 / Time: 6.55s
======================================================================================================

round 54 local learning rate = 0.00018518518518518518

>>> Round:   55 / Acc: 76.978% / Loss: 0.6844 / Grad Norm: 3.3707 / Grad Diff: 2420.9411 / Time: 6.74s
======================================================================================================

= Test = round: 55 / acc: 78.170% / loss: 0.6398 / Time: 0.61s
======================================================================================================

round 55 local learning rate = 0.00018181818181818183

>>> Round:   56 / Acc: 77.063% / Loss: 0.6814 / Grad Norm: 3.4820 / Grad Diff: 2434.6625 / Time: 6.77s
======================================================================================================

round 56 local learning rate = 0.00017857142857142857

>>> Round:   57 / Acc: 77.161% / Loss: 0.6783 / Grad Norm: 3.5152 / Grad Diff: 2447.9157 / Time: 6.68s
======================================================================================================

round 57 local learning rate = 0.00017543859649122808

>>> Round:   58 / Acc: 77.271% / Loss: 0.6755 / Grad Norm: 3.6505 / Grad Diff: 2460.0788 / Time: 6.58s
======================================================================================================

round 58 local learning rate = 0.0001724137931034483

>>> Round:   59 / Acc: 77.360% / Loss: 0.6726 / Grad Norm: 3.7266 / Grad Diff: 2474.0563 / Time: 6.77s
======================================================================================================

round 59 local learning rate = 0.00016949152542372882

>>> Round:   60 / Acc: 77.478% / Loss: 0.6696 / Grad Norm: 3.6613 / Grad Diff: 2484.5851 / Time: 6.93s
======================================================================================================

= Test = round: 60 / acc: 78.730% / loss: 0.6251 / Time: 0.62s
======================================================================================================

round 60 local learning rate = 0.00016666666666666666

>>> Round:   61 / Acc: 77.544% / Loss: 0.6666 / Grad Norm: 3.5941 / Grad Diff: 2496.8595 / Time: 6.97s
======================================================================================================

round 61 local learning rate = 0.0001639344262295082

>>> Round:   62 / Acc: 77.659% / Loss: 0.6635 / Grad Norm: 3.3669 / Grad Diff: 2504.0452 / Time: 6.96s
======================================================================================================

round 62 local learning rate = 0.00016129032258064516

>>> Round:   63 / Acc: 77.782% / Loss: 0.6606 / Grad Norm: 3.3012 / Grad Diff: 2513.9289 / Time: 6.57s
======================================================================================================

round 63 local learning rate = 0.00015873015873015873

>>> Round:   64 / Acc: 77.841% / Loss: 0.6583 / Grad Norm: 3.5328 / Grad Diff: 2526.9742 / Time: 6.75s
======================================================================================================

round 64 local learning rate = 0.00015625

>>> Round:   65 / Acc: 77.939% / Loss: 0.6556 / Grad Norm: 3.5056 / Grad Diff: 2538.4649 / Time: 6.51s
======================================================================================================

= Test = round: 65 / acc: 79.100% / loss: 0.6115 / Time: 0.54s
======================================================================================================

round 65 local learning rate = 0.00015384615384615385

>>> Round:   66 / Acc: 78.028% / Loss: 0.6530 / Grad Norm: 3.4675 / Grad Diff: 2548.4220 / Time: 6.84s
======================================================================================================

round 66 local learning rate = 0.00015151515151515152

>>> Round:   67 / Acc: 78.159% / Loss: 0.6501 / Grad Norm: 3.2287 / Grad Diff: 2554.5244 / Time: 6.88s
======================================================================================================

round 67 local learning rate = 0.00014925373134328358

>>> Round:   68 / Acc: 78.197% / Loss: 0.6480 / Grad Norm: 3.4960 / Grad Diff: 2574.2445 / Time: 6.80s
======================================================================================================

round 68 local learning rate = 0.00014705882352941178

>>> Round:   69 / Acc: 78.282% / Loss: 0.6454 / Grad Norm: 3.4253 / Grad Diff: 2583.8014 / Time: 6.98s
======================================================================================================

round 69 local learning rate = 0.00014492753623188405

>>> Round:   70 / Acc: 78.336% / Loss: 0.6429 / Grad Norm: 3.3676 / Grad Diff: 2589.5666 / Time: 6.80s
======================================================================================================

= Test = round: 70 / acc: 79.460% / loss: 0.5991 / Time: 0.58s
======================================================================================================

round 70 local learning rate = 0.00014285714285714287

>>> Round:   71 / Acc: 78.421% / Loss: 0.6406 / Grad Norm: 3.3668 / Grad Diff: 2602.8824 / Time: 6.81s
======================================================================================================

round 71 local learning rate = 0.00014084507042253522

>>> Round:   72 / Acc: 78.470% / Loss: 0.6386 / Grad Norm: 3.5049 / Grad Diff: 2612.7091 / Time: 6.97s
======================================================================================================

round 72 local learning rate = 0.0001388888888888889

>>> Round:   73 / Acc: 78.528% / Loss: 0.6363 / Grad Norm: 3.5482 / Grad Diff: 2623.6729 / Time: 6.72s
======================================================================================================

round 73 local learning rate = 0.000136986301369863

>>> Round:   74 / Acc: 78.618% / Loss: 0.6342 / Grad Norm: 3.6066 / Grad Diff: 2632.5452 / Time: 6.90s
======================================================================================================

round 74 local learning rate = 0.00013513513513513514

>>> Round:   75 / Acc: 78.666% / Loss: 0.6317 / Grad Norm: 3.4541 / Grad Diff: 2639.5211 / Time: 6.79s
======================================================================================================

= Test = round: 75 / acc: 79.840% / loss: 0.5881 / Time: 0.61s
======================================================================================================

round 75 local learning rate = 0.00013333333333333334

>>> Round:   76 / Acc: 78.734% / Loss: 0.6298 / Grad Norm: 3.6258 / Grad Diff: 2649.5218 / Time: 6.92s
======================================================================================================

round 76 local learning rate = 0.00013157894736842105

>>> Round:   77 / Acc: 78.836% / Loss: 0.6275 / Grad Norm: 3.5504 / Grad Diff: 2656.3191 / Time: 7.07s
======================================================================================================

round 77 local learning rate = 0.00012987012987012987

>>> Round:   78 / Acc: 78.882% / Loss: 0.6255 / Grad Norm: 3.5981 / Grad Diff: 2665.8469 / Time: 6.60s
======================================================================================================

round 78 local learning rate = 0.0001282051282051282

>>> Round:   79 / Acc: 78.974% / Loss: 0.6235 / Grad Norm: 3.5764 / Grad Diff: 2673.5254 / Time: 6.75s
======================================================================================================

round 79 local learning rate = 0.00012658227848101267

>>> Round:   80 / Acc: 79.063% / Loss: 0.6213 / Grad Norm: 3.4855 / Grad Diff: 2681.1187 / Time: 6.95s
======================================================================================================

= Test = round: 80 / acc: 80.230% / loss: 0.5778 / Time: 0.63s
======================================================================================================

round 80 local learning rate = 0.000125

>>> Round:   81 / Acc: 79.122% / Loss: 0.6193 / Grad Norm: 3.5433 / Grad Diff: 2688.5127 / Time: 6.78s
======================================================================================================

round 81 local learning rate = 0.0001234567901234568

>>> Round:   82 / Acc: 79.185% / Loss: 0.6174 / Grad Norm: 3.5843 / Grad Diff: 2698.0361 / Time: 6.84s
======================================================================================================

round 82 local learning rate = 0.00012195121951219512

>>> Round:   83 / Acc: 79.255% / Loss: 0.6152 / Grad Norm: 3.4991 / Grad Diff: 2707.1190 / Time: 6.81s
======================================================================================================

round 83 local learning rate = 0.00012048192771084338

>>> Round:   84 / Acc: 79.323% / Loss: 0.6137 / Grad Norm: 3.6795 / Grad Diff: 2716.2576 / Time: 6.90s
======================================================================================================

round 84 local learning rate = 0.00011904761904761905

>>> Round:   85 / Acc: 79.408% / Loss: 0.6113 / Grad Norm: 3.4727 / Grad Diff: 2718.5729 / Time: 6.86s
======================================================================================================

= Test = round: 85 / acc: 80.550% / loss: 0.5683 / Time: 0.58s
======================================================================================================

round 85 local learning rate = 0.00011764705882352942

>>> Round:   86 / Acc: 79.500% / Loss: 0.6096 / Grad Norm: 3.5281 / Grad Diff: 2727.7876 / Time: 6.90s
======================================================================================================

round 86 local learning rate = 0.00011627906976744187

>>> Round:   87 / Acc: 79.546% / Loss: 0.6079 / Grad Norm: 3.6616 / Grad Diff: 2739.9817 / Time: 6.90s
======================================================================================================

round 87 local learning rate = 0.00011494252873563218

>>> Round:   88 / Acc: 79.609% / Loss: 0.6060 / Grad Norm: 3.5961 / Grad Diff: 2745.2447 / Time: 6.72s
======================================================================================================

round 88 local learning rate = 0.00011363636363636364

>>> Round:   89 / Acc: 79.648% / Loss: 0.6043 / Grad Norm: 3.6916 / Grad Diff: 2754.0789 / Time: 6.97s
======================================================================================================

round 89 local learning rate = 0.00011235955056179776

>>> Round:   90 / Acc: 79.694% / Loss: 0.6024 / Grad Norm: 3.6249 / Grad Diff: 2758.4865 / Time: 6.65s
======================================================================================================

= Test = round: 90 / acc: 80.970% / loss: 0.5596 / Time: 0.58s
======================================================================================================

round 90 local learning rate = 0.00011111111111111112

>>> Round:   91 / Acc: 79.779% / Loss: 0.6007 / Grad Norm: 3.5879 / Grad Diff: 2763.3472 / Time: 6.62s
======================================================================================================

round 91 local learning rate = 0.00010989010989010989

>>> Round:   92 / Acc: 79.823% / Loss: 0.5989 / Grad Norm: 3.5801 / Grad Diff: 2769.6958 / Time: 6.52s
======================================================================================================

round 92 local learning rate = 0.00010869565217391305

>>> Round:   93 / Acc: 79.900% / Loss: 0.5972 / Grad Norm: 3.5106 / Grad Diff: 2776.1485 / Time: 6.80s
======================================================================================================

round 93 local learning rate = 0.00010752688172043011

>>> Round:   94 / Acc: 79.950% / Loss: 0.5957 / Grad Norm: 3.6004 / Grad Diff: 2783.6643 / Time: 6.75s
======================================================================================================

round 94 local learning rate = 0.00010638297872340425

>>> Round:   95 / Acc: 80.026% / Loss: 0.5941 / Grad Norm: 3.6413 / Grad Diff: 2789.4127 / Time: 6.62s
======================================================================================================

= Test = round: 95 / acc: 81.340% / loss: 0.5516 / Time: 0.58s
======================================================================================================

round 95 local learning rate = 0.00010526315789473685
Traceback (most recent call last):
  File "main_mnist_mnist_m.py", line 332, in <module>
    main()
  File "main_mnist_mnist_m.py", line 277, in main
    trainer.train()
  File "/data/shared/chao/transfer_fl/TranferableFL/src/trainers/fedavgtl.py", line 78, in train
    solns, stats, local_grads = self.local_train(round_i, selected_clients, last_round_avg_local_grad_norm=last_round_avg_local_grad_norm)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/trainers/base.py", line 112, in local_train
    soln, stat, local_grad = c.local_train(last_round_avg_local_grad_norm=last_round_avg_local_grad_norm)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/client.py", line 67, in local_train
    local_solution, worker_stats, local_grad = self.worker.local_train(self.train_dataloader, last_round_avg_local_grad_norm=last_round_avg_local_grad_norm, **kwargs)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/worker.py", line 233, in local_train
    local_grad = self.get_flat_grads(train_dataloader).detach()
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/worker.py", line 77, in get_flat_grads
    pred = self.model(x)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/model.py", line 46, in forward
    out = F.relu(self.fc1(out))
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/nn/functional.py", line 1846, in linear
    if has_torch_function_variadic(input, weight, bias):
KeyboardInterrupt
