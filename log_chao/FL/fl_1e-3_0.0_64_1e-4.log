nohup: ignoring input
uid: 20230914213058
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 0.0
	       batch_size : 64
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 20
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 2
	            ft_lr : 0.01
	            ft_wd : 0.0
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 2
	               lr : 0.001
	            model : lenet
	           n_init : 5
	        noaverage : False
	             noft : True
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : True
	       reg_J_coef : 0.0001
	             seed : 0
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 11.809215545654297.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl
FL pretrained model will be saved at ./models/lenet_mnist_20230914213058.pt
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 7.173% / Loss: 2.3059 / Grad Norm: 0.1884 / Grad Diff: 1.7943 / Time: 7.44s
======================================================================================================

= Test = round: 0 / acc: 7.430% / loss: 2.3028 / Time: 0.62s
======================================================================================================

round 0 local learning rate = 0.001

>>> Round:    1 / Acc: 7.304% / Loss: 2.3056 / Grad Norm: 0.1884 / Grad Diff: 1.7968 / Time: 7.52s
======================================================================================================

round 1 local learning rate = 0.001

>>> Round:    2 / Acc: 7.424% / Loss: 2.3052 / Grad Norm: 0.1884 / Grad Diff: 1.7992 / Time: 7.40s
======================================================================================================

round 2 local learning rate = 0.0005

>>> Round:    3 / Acc: 7.493% / Loss: 2.3051 / Grad Norm: 0.1883 / Grad Diff: 1.7993 / Time: 7.52s
======================================================================================================

round 3 local learning rate = 0.0003333333333333333

>>> Round:    4 / Acc: 7.537% / Loss: 2.3049 / Grad Norm: 0.1883 / Grad Diff: 1.7991 / Time: 7.52s
======================================================================================================

round 4 local learning rate = 0.00025

>>> Round:    5 / Acc: 7.565% / Loss: 2.3049 / Grad Norm: 0.1882 / Grad Diff: 1.7988 / Time: 7.57s
======================================================================================================

= Test = round: 5 / acc: 7.690% / loss: 2.3017 / Time: 0.64s
======================================================================================================

round 5 local learning rate = 0.0002

>>> Round:    6 / Acc: 7.594% / Loss: 2.3048 / Grad Norm: 0.1881 / Grad Diff: 1.7987 / Time: 7.48s
======================================================================================================

round 6 local learning rate = 0.00016666666666666666

>>> Round:    7 / Acc: 7.618% / Loss: 2.3047 / Grad Norm: 0.1881 / Grad Diff: 1.7986 / Time: 7.68s
======================================================================================================

round 7 local learning rate = 0.00014285714285714287

>>> Round:    8 / Acc: 7.651% / Loss: 2.3047 / Grad Norm: 0.1881 / Grad Diff: 1.7985 / Time: 7.52s
======================================================================================================

round 8 local learning rate = 0.000125

>>> Round:    9 / Acc: 7.662% / Loss: 2.3046 / Grad Norm: 0.1880 / Grad Diff: 1.7983 / Time: 7.51s
======================================================================================================

round 9 local learning rate = 0.00011111111111111112

>>> Round:   10 / Acc: 7.677% / Loss: 2.3046 / Grad Norm: 0.1880 / Grad Diff: 1.7982 / Time: 7.46s
======================================================================================================

= Test = round: 10 / acc: 7.720% / loss: 2.3014 / Time: 0.63s
======================================================================================================

round 10 local learning rate = 0.0001

>>> Round:   11 / Acc: 7.692% / Loss: 2.3046 / Grad Norm: 0.1880 / Grad Diff: 1.7981 / Time: 7.55s
======================================================================================================

round 11 local learning rate = 9.090909090909092e-05

>>> Round:   12 / Acc: 7.707% / Loss: 2.3045 / Grad Norm: 0.1879 / Grad Diff: 1.7979 / Time: 7.44s
======================================================================================================

round 12 local learning rate = 8.333333333333333e-05

>>> Round:   13 / Acc: 7.725% / Loss: 2.3045 / Grad Norm: 0.1879 / Grad Diff: 1.7978 / Time: 7.62s
======================================================================================================

round 13 local learning rate = 7.692307692307693e-05

>>> Round:   14 / Acc: 7.745% / Loss: 2.3045 / Grad Norm: 0.1879 / Grad Diff: 1.7978 / Time: 7.51s
======================================================================================================

round 14 local learning rate = 7.142857142857143e-05

>>> Round:   15 / Acc: 7.740% / Loss: 2.3044 / Grad Norm: 0.1878 / Grad Diff: 1.7976 / Time: 7.59s
======================================================================================================

= Test = round: 15 / acc: 7.760% / loss: 2.3013 / Time: 0.63s
======================================================================================================

round 15 local learning rate = 6.666666666666667e-05

>>> Round:   16 / Acc: 7.745% / Loss: 2.3044 / Grad Norm: 0.1878 / Grad Diff: 1.7975 / Time: 7.47s
======================================================================================================

round 16 local learning rate = 6.25e-05

>>> Round:   17 / Acc: 7.756% / Loss: 2.3044 / Grad Norm: 0.1878 / Grad Diff: 1.7974 / Time: 7.42s
======================================================================================================

round 17 local learning rate = 5.882352941176471e-05

>>> Round:   18 / Acc: 7.760% / Loss: 2.3044 / Grad Norm: 0.1878 / Grad Diff: 1.7973 / Time: 7.45s
======================================================================================================

round 18 local learning rate = 5.555555555555556e-05

>>> Round:   19 / Acc: 7.760% / Loss: 2.3044 / Grad Norm: 0.1877 / Grad Diff: 1.7972 / Time: 7.42s
======================================================================================================

round 19 local learning rate = 5.2631578947368424e-05

>>> Round:   20 / Acc: 7.768% / Loss: 2.3043 / Grad Norm: 0.1877 / Grad Diff: 1.7971 / Time: 7.50s
======================================================================================================

= Test = round: 20 / acc: 7.800% / loss: 2.3012 / Time: 0.63s
======================================================================================================

round 20 local learning rate = 5e-05

>>> Round:   21 / Acc: 7.773% / Loss: 2.3043 / Grad Norm: 0.1877 / Grad Diff: 1.7970 / Time: 7.70s
======================================================================================================

round 21 local learning rate = 4.761904761904762e-05

>>> Round:   22 / Acc: 7.780% / Loss: 2.3043 / Grad Norm: 0.1877 / Grad Diff: 1.7969 / Time: 7.58s
======================================================================================================

round 22 local learning rate = 4.545454545454546e-05

>>> Round:   23 / Acc: 7.786% / Loss: 2.3043 / Grad Norm: 0.1877 / Grad Diff: 1.7969 / Time: 6.83s
======================================================================================================

round 23 local learning rate = 4.347826086956522e-05

>>> Round:   24 / Acc: 7.790% / Loss: 2.3043 / Grad Norm: 0.1877 / Grad Diff: 1.7969 / Time: 6.87s
======================================================================================================

round 24 local learning rate = 4.1666666666666665e-05

>>> Round:   25 / Acc: 7.793% / Loss: 2.3043 / Grad Norm: 0.1877 / Grad Diff: 1.7969 / Time: 7.33s
======================================================================================================

= Test = round: 25 / acc: 7.880% / loss: 2.3011 / Time: 0.62s
======================================================================================================

round 25 local learning rate = 4e-05

>>> Round:   26 / Acc: 7.804% / Loss: 2.3042 / Grad Norm: 0.1877 / Grad Diff: 1.7968 / Time: 7.32s
======================================================================================================

round 26 local learning rate = 3.846153846153846e-05

>>> Round:   27 / Acc: 7.815% / Loss: 2.3042 / Grad Norm: 0.1877 / Grad Diff: 1.7968 / Time: 7.68s
======================================================================================================

round 27 local learning rate = 3.7037037037037037e-05

>>> Round:   28 / Acc: 7.819% / Loss: 2.3042 / Grad Norm: 0.1876 / Grad Diff: 1.7968 / Time: 7.51s
======================================================================================================

round 28 local learning rate = 3.571428571428572e-05

>>> Round:   29 / Acc: 7.825% / Loss: 2.3042 / Grad Norm: 0.1876 / Grad Diff: 1.7967 / Time: 7.06s
======================================================================================================

round 29 local learning rate = 3.4482758620689657e-05

>>> Round:   30 / Acc: 7.823% / Loss: 2.3042 / Grad Norm: 0.1876 / Grad Diff: 1.7966 / Time: 7.40s
======================================================================================================

= Test = round: 30 / acc: 7.910% / loss: 2.3010 / Time: 0.63s
======================================================================================================

round 30 local learning rate = 3.3333333333333335e-05

>>> Round:   31 / Acc: 7.825% / Loss: 2.3042 / Grad Norm: 0.1876 / Grad Diff: 1.7966 / Time: 7.60s
======================================================================================================

round 31 local learning rate = 3.2258064516129034e-05

>>> Round:   32 / Acc: 7.832% / Loss: 2.3042 / Grad Norm: 0.1876 / Grad Diff: 1.7966 / Time: 7.59s
======================================================================================================

round 32 local learning rate = 3.125e-05

>>> Round:   33 / Acc: 7.836% / Loss: 2.3042 / Grad Norm: 0.1876 / Grad Diff: 1.7965 / Time: 7.64s
======================================================================================================

round 33 local learning rate = 3.0303030303030302e-05

>>> Round:   34 / Acc: 7.843% / Loss: 2.3041 / Grad Norm: 0.1876 / Grad Diff: 1.7965 / Time: 7.55s
======================================================================================================

round 34 local learning rate = 2.9411764705882354e-05

>>> Round:   35 / Acc: 7.852% / Loss: 2.3041 / Grad Norm: 0.1876 / Grad Diff: 1.7964 / Time: 7.38s
======================================================================================================

= Test = round: 35 / acc: 7.950% / loss: 2.3010 / Time: 0.63s
======================================================================================================

round 35 local learning rate = 2.857142857142857e-05

>>> Round:   36 / Acc: 7.860% / Loss: 2.3041 / Grad Norm: 0.1876 / Grad Diff: 1.7964 / Time: 7.62s
======================================================================================================

round 36 local learning rate = 2.777777777777778e-05

>>> Round:   37 / Acc: 7.863% / Loss: 2.3041 / Grad Norm: 0.1876 / Grad Diff: 1.7964 / Time: 7.58s
======================================================================================================

round 37 local learning rate = 2.7027027027027027e-05

>>> Round:   38 / Acc: 7.865% / Loss: 2.3041 / Grad Norm: 0.1875 / Grad Diff: 1.7964 / Time: 7.66s
======================================================================================================

round 38 local learning rate = 2.6315789473684212e-05

>>> Round:   39 / Acc: 7.871% / Loss: 2.3041 / Grad Norm: 0.1875 / Grad Diff: 1.7963 / Time: 7.67s
======================================================================================================

round 39 local learning rate = 2.5641025641025643e-05

>>> Round:   40 / Acc: 7.871% / Loss: 2.3041 / Grad Norm: 0.1875 / Grad Diff: 1.7963 / Time: 7.67s
======================================================================================================

= Test = round: 40 / acc: 7.950% / loss: 2.3009 / Time: 0.64s
======================================================================================================

round 40 local learning rate = 2.5e-05

>>> Round:   41 / Acc: 7.875% / Loss: 2.3041 / Grad Norm: 0.1875 / Grad Diff: 1.7963 / Time: 7.63s
======================================================================================================

round 41 local learning rate = 2.4390243902439026e-05

>>> Round:   42 / Acc: 7.882% / Loss: 2.3041 / Grad Norm: 0.1875 / Grad Diff: 1.7962 / Time: 7.78s
======================================================================================================

round 42 local learning rate = 2.380952380952381e-05

>>> Round:   43 / Acc: 7.882% / Loss: 2.3041 / Grad Norm: 0.1875 / Grad Diff: 1.7962 / Time: 7.61s
======================================================================================================

round 43 local learning rate = 2.3255813953488374e-05

>>> Round:   44 / Acc: 7.889% / Loss: 2.3041 / Grad Norm: 0.1875 / Grad Diff: 1.7962 / Time: 7.69s
======================================================================================================

round 44 local learning rate = 2.272727272727273e-05

>>> Round:   45 / Acc: 7.889% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7962 / Time: 7.83s
======================================================================================================

= Test = round: 45 / acc: 7.950% / loss: 2.3009 / Time: 0.66s
======================================================================================================

round 45 local learning rate = 2.2222222222222223e-05

>>> Round:   46 / Acc: 7.897% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7962 / Time: 7.65s
======================================================================================================

round 46 local learning rate = 2.173913043478261e-05

>>> Round:   47 / Acc: 7.900% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7962 / Time: 7.53s
======================================================================================================

round 47 local learning rate = 2.1276595744680852e-05

>>> Round:   48 / Acc: 7.897% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7962 / Time: 7.30s
======================================================================================================

round 48 local learning rate = 2.0833333333333333e-05

>>> Round:   49 / Acc: 7.899% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7961 / Time: 7.63s
======================================================================================================

round 49 local learning rate = 2.0408163265306123e-05

>>> Round:   50 / Acc: 7.900% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7961 / Time: 7.61s
======================================================================================================

= Test = round: 50 / acc: 7.960% / loss: 2.3009 / Time: 0.64s
======================================================================================================

round 50 local learning rate = 2e-05

>>> Round:   51 / Acc: 7.908% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7961 / Time: 7.67s
======================================================================================================

round 51 local learning rate = 1.9607843137254903e-05

>>> Round:   52 / Acc: 7.908% / Loss: 2.3040 / Grad Norm: 0.1875 / Grad Diff: 1.7960 / Time: 7.77s
======================================================================================================

round 52 local learning rate = 1.923076923076923e-05

>>> Round:   53 / Acc: 7.906% / Loss: 2.3040 / Grad Norm: 0.1874 / Grad Diff: 1.7960 / Time: 7.55s
======================================================================================================

round 53 local learning rate = 1.8867924528301888e-05

>>> Round:   54 / Acc: 7.906% / Loss: 2.3040 / Grad Norm: 0.1874 / Grad Diff: 1.7960 / Time: 7.59s
======================================================================================================

round 54 local learning rate = 1.8518518518518518e-05

>>> Round:   55 / Acc: 7.908% / Loss: 2.3040 / Grad Norm: 0.1874 / Grad Diff: 1.7959 / Time: 7.59s
======================================================================================================

= Test = round: 55 / acc: 7.960% / loss: 2.3008 / Time: 0.65s
======================================================================================================

round 55 local learning rate = 1.8181818181818182e-05

>>> Round:   56 / Acc: 7.906% / Loss: 2.3040 / Grad Norm: 0.1874 / Grad Diff: 1.7959 / Time: 7.74s
======================================================================================================

round 56 local learning rate = 1.785714285714286e-05

>>> Round:   57 / Acc: 7.908% / Loss: 2.3040 / Grad Norm: 0.1874 / Grad Diff: 1.7959 / Time: 7.61s
======================================================================================================

round 57 local learning rate = 1.7543859649122806e-05

>>> Round:   58 / Acc: 7.910% / Loss: 2.3040 / Grad Norm: 0.1874 / Grad Diff: 1.7959 / Time: 7.78s
======================================================================================================

round 58 local learning rate = 1.7241379310344828e-05

>>> Round:   59 / Acc: 7.917% / Loss: 2.3040 / Grad Norm: 0.1874 / Grad Diff: 1.7959 / Time: 7.78s
======================================================================================================

round 59 local learning rate = 1.694915254237288e-05

>>> Round:   60 / Acc: 7.915% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7958 / Time: 7.66s
======================================================================================================

= Test = round: 60 / acc: 7.990% / loss: 2.3008 / Time: 0.62s
======================================================================================================

round 60 local learning rate = 1.6666666666666667e-05

>>> Round:   61 / Acc: 7.913% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7958 / Time: 7.56s
======================================================================================================

round 61 local learning rate = 1.639344262295082e-05

>>> Round:   62 / Acc: 7.913% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7958 / Time: 7.75s
======================================================================================================

round 62 local learning rate = 1.6129032258064517e-05

>>> Round:   63 / Acc: 7.913% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7958 / Time: 7.66s
======================================================================================================

round 63 local learning rate = 1.5873015873015872e-05

>>> Round:   64 / Acc: 7.913% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7957 / Time: 7.52s
======================================================================================================

round 64 local learning rate = 1.5625e-05

>>> Round:   65 / Acc: 7.919% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7957 / Time: 7.57s
======================================================================================================

= Test = round: 65 / acc: 7.980% / loss: 2.3008 / Time: 0.62s
======================================================================================================

round 65 local learning rate = 1.5384615384615384e-05

>>> Round:   66 / Acc: 7.919% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7956 / Time: 7.37s
======================================================================================================

round 66 local learning rate = 1.5151515151515151e-05

>>> Round:   67 / Acc: 7.924% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7956 / Time: 7.40s
======================================================================================================

round 67 local learning rate = 1.4925373134328359e-05

>>> Round:   68 / Acc: 7.928% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7956 / Time: 7.42s
======================================================================================================

round 68 local learning rate = 1.4705882352941177e-05

>>> Round:   69 / Acc: 7.930% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7956 / Time: 7.49s
======================================================================================================

round 69 local learning rate = 1.4492753623188407e-05

>>> Round:   70 / Acc: 7.932% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7955 / Time: 7.42s
======================================================================================================

= Test = round: 70 / acc: 7.990% / loss: 2.3008 / Time: 0.62s
======================================================================================================

round 70 local learning rate = 1.4285714285714285e-05

>>> Round:   71 / Acc: 7.935% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7955 / Time: 7.64s
======================================================================================================

round 71 local learning rate = 1.4084507042253522e-05

>>> Round:   72 / Acc: 7.939% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7955 / Time: 7.86s
======================================================================================================

round 72 local learning rate = 1.388888888888889e-05

>>> Round:   73 / Acc: 7.941% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7954 / Time: 7.67s
======================================================================================================

round 73 local learning rate = 1.3698630136986302e-05

>>> Round:   74 / Acc: 7.937% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7954 / Time: 7.34s
======================================================================================================

round 74 local learning rate = 1.3513513513513513e-05

>>> Round:   75 / Acc: 7.937% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7954 / Time: 7.74s
======================================================================================================

= Test = round: 75 / acc: 7.990% / loss: 2.3007 / Time: 0.62s
======================================================================================================

round 75 local learning rate = 1.3333333333333333e-05

>>> Round:   76 / Acc: 7.932% / Loss: 2.3039 / Grad Norm: 0.1874 / Grad Diff: 1.7954 / Time: 7.36s
======================================================================================================

round 76 local learning rate = 1.3157894736842106e-05

>>> Round:   77 / Acc: 7.934% / Loss: 2.3039 / Grad Norm: 0.1873 / Grad Diff: 1.7954 / Time: 7.56s
======================================================================================================

round 77 local learning rate = 1.2987012987012988e-05

>>> Round:   78 / Acc: 7.934% / Loss: 2.3039 / Grad Norm: 0.1873 / Grad Diff: 1.7953 / Time: 7.49s
======================================================================================================

round 78 local learning rate = 1.2820512820512822e-05

>>> Round:   79 / Acc: 7.937% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7953 / Time: 7.42s
======================================================================================================

round 79 local learning rate = 1.2658227848101267e-05

>>> Round:   80 / Acc: 7.939% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7953 / Time: 7.53s
======================================================================================================

= Test = round: 80 / acc: 8.010% / loss: 2.3007 / Time: 0.63s
======================================================================================================

round 80 local learning rate = 1.25e-05

>>> Round:   81 / Acc: 7.943% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7953 / Time: 7.46s
======================================================================================================

round 81 local learning rate = 1.234567901234568e-05

>>> Round:   82 / Acc: 7.946% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7953 / Time: 7.52s
======================================================================================================

round 82 local learning rate = 1.2195121951219513e-05

>>> Round:   83 / Acc: 7.945% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.52s
======================================================================================================

round 83 local learning rate = 1.2048192771084337e-05

>>> Round:   84 / Acc: 7.945% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.43s
======================================================================================================

round 84 local learning rate = 1.1904761904761905e-05

>>> Round:   85 / Acc: 7.945% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.50s
======================================================================================================

= Test = round: 85 / acc: 8.010% / loss: 2.3007 / Time: 0.62s
======================================================================================================

round 85 local learning rate = 1.1764705882352942e-05

>>> Round:   86 / Acc: 7.948% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.51s
======================================================================================================

round 86 local learning rate = 1.1627906976744187e-05

>>> Round:   87 / Acc: 7.948% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.45s
======================================================================================================

round 87 local learning rate = 1.1494252873563218e-05

>>> Round:   88 / Acc: 7.950% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.46s
======================================================================================================

round 88 local learning rate = 1.1363636363636365e-05

>>> Round:   89 / Acc: 7.950% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.43s
======================================================================================================

round 89 local learning rate = 1.1235955056179776e-05

>>> Round:   90 / Acc: 7.954% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.41s
======================================================================================================

= Test = round: 90 / acc: 8.020% / loss: 2.3007 / Time: 0.64s
======================================================================================================

round 90 local learning rate = 1.1111111111111112e-05

>>> Round:   91 / Acc: 7.954% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.46s
======================================================================================================

round 91 local learning rate = 1.0989010989010989e-05

>>> Round:   92 / Acc: 7.958% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7952 / Time: 7.46s
======================================================================================================

round 92 local learning rate = 1.0869565217391305e-05

>>> Round:   93 / Acc: 7.959% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7951 / Time: 7.35s
======================================================================================================

round 93 local learning rate = 1.0752688172043012e-05

>>> Round:   94 / Acc: 7.959% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7951 / Time: 7.47s
======================================================================================================

round 94 local learning rate = 1.0638297872340426e-05

>>> Round:   95 / Acc: 7.959% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7951 / Time: 7.43s
======================================================================================================

= Test = round: 95 / acc: 8.020% / loss: 2.3006 / Time: 0.64s
======================================================================================================

round 95 local learning rate = 1.0526315789473684e-05

>>> Round:   96 / Acc: 7.959% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 6.76s
======================================================================================================

round 96 local learning rate = 1.0416666666666666e-05

>>> Round:   97 / Acc: 7.959% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.37s
======================================================================================================

round 97 local learning rate = 1.0309278350515464e-05

>>> Round:   98 / Acc: 7.959% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 6.84s
======================================================================================================

round 98 local learning rate = 1.0204081632653061e-05

>>> Round:   99 / Acc: 7.958% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.12s
======================================================================================================

round 99 local learning rate = 1.0101010101010101e-05

>>> Round:  100 / Acc: 7.959% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.48s
======================================================================================================

= Test = round: 100 / acc: 8.030% / loss: 2.3006 / Time: 0.62s
======================================================================================================

round 100 local learning rate = 1e-05

>>> Round:  101 / Acc: 7.963% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.47s
======================================================================================================

round 101 local learning rate = 9.900990099009901e-06

>>> Round:  102 / Acc: 7.965% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.44s
======================================================================================================

round 102 local learning rate = 9.803921568627451e-06

>>> Round:  103 / Acc: 7.965% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.44s
======================================================================================================

round 103 local learning rate = 9.70873786407767e-06

>>> Round:  104 / Acc: 7.967% / Loss: 2.3038 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.44s
======================================================================================================

round 104 local learning rate = 9.615384615384616e-06

>>> Round:  105 / Acc: 7.967% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7950 / Time: 7.45s
======================================================================================================

= Test = round: 105 / acc: 8.050% / loss: 2.3006 / Time: 0.63s
======================================================================================================

round 105 local learning rate = 9.523809523809525e-06

>>> Round:  106 / Acc: 7.967% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7949 / Time: 7.48s
======================================================================================================

round 106 local learning rate = 9.433962264150944e-06

>>> Round:  107 / Acc: 7.965% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7949 / Time: 7.62s
======================================================================================================

round 107 local learning rate = 9.345794392523365e-06

>>> Round:  108 / Acc: 7.969% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7949 / Time: 6.90s
======================================================================================================

round 108 local learning rate = 9.259259259259259e-06

>>> Round:  109 / Acc: 7.969% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7949 / Time: 7.56s
======================================================================================================

round 109 local learning rate = 9.174311926605506e-06

>>> Round:  110 / Acc: 7.969% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7949 / Time: 7.49s
======================================================================================================

= Test = round: 110 / acc: 8.060% / loss: 2.3006 / Time: 0.62s
======================================================================================================

round 110 local learning rate = 9.090909090909091e-06

>>> Round:  111 / Acc: 7.972% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7949 / Time: 7.44s
======================================================================================================

round 111 local learning rate = 9.00900900900901e-06

>>> Round:  112 / Acc: 7.974% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7949 / Time: 7.58s
======================================================================================================

round 112 local learning rate = 8.92857142857143e-06

>>> Round:  113 / Acc: 7.978% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.59s
======================================================================================================

round 113 local learning rate = 8.849557522123894e-06

>>> Round:  114 / Acc: 7.978% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.35s
======================================================================================================

round 114 local learning rate = 8.771929824561403e-06

>>> Round:  115 / Acc: 7.976% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.50s
======================================================================================================

= Test = round: 115 / acc: 8.080% / loss: 2.3006 / Time: 0.64s
======================================================================================================

round 115 local learning rate = 8.695652173913044e-06

>>> Round:  116 / Acc: 7.976% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.52s
======================================================================================================

round 116 local learning rate = 8.620689655172414e-06

>>> Round:  117 / Acc: 7.980% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.51s
======================================================================================================

round 117 local learning rate = 8.547008547008548e-06

>>> Round:  118 / Acc: 7.982% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.52s
======================================================================================================

round 118 local learning rate = 8.47457627118644e-06

>>> Round:  119 / Acc: 7.983% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.37s
======================================================================================================

round 119 local learning rate = 8.403361344537815e-06

>>> Round:  120 / Acc: 7.983% / Loss: 2.3037 / Grad Norm: 0.1873 / Grad Diff: 1.7948 / Time: 7.50s
======================================================================================================

= Test = round: 120 / acc: 8.080% / loss: 2.3006 / Time: 0.66s
======================================================================================================

round 120 local learning rate = 8.333333333333334e-06

>>> Round:  121 / Acc: 7.985% / Loss: 2.3037 / Grad Norm: 0.1872 / Grad Diff: 1.7948 / Time: 7.52s
======================================================================================================

round 121 local learning rate = 8.264462809917356e-06

>>> Round:  122 / Acc: 7.987% / Loss: 2.3037 / Grad Norm: 0.1872 / Grad Diff: 1.7948 / Time: 7.54s
======================================================================================================

round 122 local learning rate = 8.19672131147541e-06

>>> Round:  123 / Acc: 7.987% / Loss: 2.3037 / Grad Norm: 0.1872 / Grad Diff: 1.7948 / Time: 7.45s
======================================================================================================

round 123 local learning rate = 8.130081300813009e-06

>>> Round:  124 / Acc: 7.987% / Loss: 2.3037 / Grad Norm: 0.1872 / Grad Diff: 1.7947 / Time: 7.55s
======================================================================================================

round 124 local learning rate = 8.064516129032258e-06
Traceback (most recent call last):
  File "main_mnist_mnist_m.py", line 337, in <module>
    main()
  File "main_mnist_mnist_m.py", line 281, in main
    trainer.train()
  File "/data/shared/chao/transfer_fl/TranferableFL/src/trainers/fedavgtl.py", line 44, in train
    _, local_grads_norm_square = self.test_latest_model_on_traindata(round_i)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/trainers/base.py", line 158, in test_latest_model_on_traindata
    stats_from_train_data = self.local_test(use_eval_data=False)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/trainers/base.py", line 216, in local_test
    tot_correct, num_sample, loss = c.local_test(use_eval_data=use_eval_data)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/client.py", line 89, in local_test
    tot_correct, loss = self.worker.local_test(dataloader)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/worker.py", line 164, in local_test
    for x, y in test_dataloader:
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 521, in __next__
    data = self._next_data()
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/utils/data/dataloader.py", line 561, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/data/shared/chao/transfer_fl/TranferableFL/src/utils/worker_utils.py", line 126, in __getitem__
    data = self.transform(data)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torchvision/transforms/transforms.py", line 61, in __call__
    img = t(img)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torchvision/transforms/transforms.py", line 226, in forward
    return F.normalize(tensor, self.mean, self.std, self.inplace)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torchvision/transforms/functional.py", line 343, in normalize
    mean = torch.as_tensor(mean, dtype=dtype, device=tensor.device)
KeyboardInterrupt
