nohup: ignoring input
Using device: cuda:0
>>> Arguments:
	             algo : fedavgtl
	            alpha : 51871.0
	       batch_size : 32
	clients_per_round : 100
	          dataset : mnist_all_data_1_equal_niid
	           device : cuda:0
	              dis : 
	   early_stopping : 20
	       eval_every : 5
	    ft_batch_size : 128
	       ft_dataset : mnist-m
	        ft_epochs : 2
	            ft_lr : 0.01
	            ft_wd : 0.0
	              gpu : True
	      input_shape : (1, 28, 28)
	           last_k : 2
	               lr : 0.05
	            model : lenet
	           n_init : 5
	        noaverage : False
	          noprint : False
	        num_class : 10
	        num_epoch : 1
	        num_round : 200
	           opt_lr : False
	            reg_J : True
	       reg_J_coef : 0.01
	             seed : 0
	               wd : 0.0001
>>> Read data from:
     ./data/mnist/data/all_data_1.pkl
>>> The estimate of constant alpha is 51871.0.
>>> Read data from:
     ./data/mnist/data/train/all_data_1_equal_niid.pkl
     ./data/mnist/data/test/all_data_1_equal_niid.pkl
>>> Use gpu on device cuda:0
>>> Model statistic per layer
LeNet_MNIST(
  286.12 KMac, 100.000% MACs, 
  (conv1): Conv2d(89.856 KMac, 31.405% MACs, 1, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(154.624 KMac, 54.042% MACs, 6, 16, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(30.72 KMac, 10.737% MACs, in_features=256, out_features=120, bias=True)
  (fc2): Linear(10.08 KMac, 3.523% MACs, in_features=120, out_features=84, bias=True)
  (fc3): Linear(840.0 Mac, 0.294% MACs, in_features=84, out_features=10, bias=True)
)
>>> Activate a worker for training
>>> Initialize 100 clients in total
>>> Weigh updates by simple average
>>> Select 100 clients per round 


>>> Round:    0 / Acc: 6.644% / Loss: 8.7746 / Grad Norm: 116.0369 / Grad Diff: 30226.3976 / Time: 7.80s
======================================================================================================

= Test = round: 0 / acc: 6.140% / loss: 8.8092 / Time: 0.66s
======================================================================================================

round 0 local learning rate = 0.05

>>> Round:    1 / Acc: 10.002% / Loss: 2.3036 / Grad Norm: 0.0567 / Grad Diff: 0.5674 / Time: 7.94s
======================================================================================================

round 1 local learning rate = 0.05

>>> Round:    2 / Acc: 10.002% / Loss: 2.3007 / Grad Norm: 0.0852 / Grad Diff: 0.7191 / Time: 7.86s
======================================================================================================

round 2 local learning rate = 0.025

>>> Round:    3 / Acc: 9.998% / Loss: 2.2977 / Grad Norm: 0.1026 / Grad Diff: 0.9306 / Time: 8.01s
======================================================================================================

round 3 local learning rate = 0.016666666666666666

>>> Round:    4 / Acc: 10.004% / Loss: 2.2950 / Grad Norm: 0.1189 / Grad Diff: 1.1907 / Time: 8.02s
======================================================================================================

round 4 local learning rate = 0.0125

>>> Round:    5 / Acc: 10.002% / Loss: 2.2923 / Grad Norm: 0.1343 / Grad Diff: 1.4947 / Time: 7.94s
======================================================================================================

= Test = round: 5 / acc: 11.360% / loss: 2.2895 / Time: 0.61s
======================================================================================================

round 5 local learning rate = 0.01

>>> Round:    6 / Acc: 10.000% / Loss: 2.2897 / Grad Norm: 0.1513 / Grad Diff: 1.8288 / Time: 8.02s
======================================================================================================

round 6 local learning rate = 0.008333333333333333

>>> Round:    7 / Acc: 10.000% / Loss: 2.2871 / Grad Norm: 0.1662 / Grad Diff: 2.1802 / Time: 8.38s
======================================================================================================

round 7 local learning rate = 0.0071428571428571435

>>> Round:    8 / Acc: 10.000% / Loss: 2.2844 / Grad Norm: 0.1799 / Grad Diff: 2.5448 / Time: 7.64s
======================================================================================================

round 8 local learning rate = 0.00625

>>> Round:    9 / Acc: 10.002% / Loss: 2.2818 / Grad Norm: 0.1920 / Grad Diff: 2.9261 / Time: 7.70s
======================================================================================================

round 9 local learning rate = 0.005555555555555556

>>> Round:   10 / Acc: 10.002% / Loss: 2.2791 / Grad Norm: 0.2033 / Grad Diff: 3.3252 / Time: 7.94s
======================================================================================================

= Test = round: 10 / acc: 11.360% / loss: 2.2752 / Time: 0.63s
======================================================================================================

round 10 local learning rate = 0.005

>>> Round:   11 / Acc: 10.002% / Loss: 2.2766 / Grad Norm: 0.2136 / Grad Diff: 3.7336 / Time: 7.88s
======================================================================================================

round 11 local learning rate = 0.004545454545454546

>>> Round:   12 / Acc: 10.002% / Loss: 2.2741 / Grad Norm: 0.2232 / Grad Diff: 4.1413 / Time: 7.86s
======================================================================================================

round 12 local learning rate = 0.004166666666666667

>>> Round:   13 / Acc: 10.015% / Loss: 2.2717 / Grad Norm: 0.2334 / Grad Diff: 4.5603 / Time: 7.87s
======================================================================================================

round 13 local learning rate = 0.0038461538461538464

>>> Round:   14 / Acc: 10.031% / Loss: 2.2693 / Grad Norm: 0.2429 / Grad Diff: 4.9655 / Time: 9.77s
======================================================================================================

round 14 local learning rate = 0.0035714285714285718

>>> Round:   15 / Acc: 10.061% / Loss: 2.2670 / Grad Norm: 0.2519 / Grad Diff: 5.3585 / Time: 8.75s
======================================================================================================

= Test = round: 15 / acc: 11.490% / loss: 2.2615 / Time: 0.82s
======================================================================================================

round 15 local learning rate = 0.0033333333333333335

>>> Round:   16 / Acc: 10.096% / Loss: 2.2647 / Grad Norm: 0.2604 / Grad Diff: 5.7506 / Time: 7.75s
======================================================================================================

round 16 local learning rate = 0.003125

>>> Round:   17 / Acc: 10.170% / Loss: 2.2625 / Grad Norm: 0.2683 / Grad Diff: 6.1262 / Time: 8.87s
======================================================================================================

round 17 local learning rate = 0.0029411764705882353

>>> Round:   18 / Acc: 10.262% / Loss: 2.2602 / Grad Norm: 0.2758 / Grad Diff: 6.4974 / Time: 7.50s
======================================================================================================

round 18 local learning rate = 0.002777777777777778

>>> Round:   19 / Acc: 10.327% / Loss: 2.2580 / Grad Norm: 0.2826 / Grad Diff: 6.8572 / Time: 7.75s
======================================================================================================

round 19 local learning rate = 0.002631578947368421

>>> Round:   20 / Acc: 10.424% / Loss: 2.2559 / Grad Norm: 0.2899 / Grad Diff: 7.2286 / Time: 7.87s
======================================================================================================

= Test = round: 20 / acc: 11.950% / loss: 2.2491 / Time: 0.63s
======================================================================================================

round 20 local learning rate = 0.0025

>>> Round:   21 / Acc: 10.535% / Loss: 2.2538 / Grad Norm: 0.2959 / Grad Diff: 7.5686 / Time: 7.68s
======================================================================================================

round 21 local learning rate = 0.002380952380952381

>>> Round:   22 / Acc: 10.642% / Loss: 2.2517 / Grad Norm: 0.3016 / Grad Diff: 7.9130 / Time: 7.67s
======================================================================================================

round 22 local learning rate = 0.002272727272727273

>>> Round:   23 / Acc: 10.732% / Loss: 2.2496 / Grad Norm: 0.3068 / Grad Diff: 8.2450 / Time: 7.71s
======================================================================================================

round 23 local learning rate = 0.002173913043478261

>>> Round:   24 / Acc: 10.808% / Loss: 2.2475 / Grad Norm: 0.3117 / Grad Diff: 8.5670 / Time: 7.52s
======================================================================================================

round 24 local learning rate = 0.0020833333333333333

>>> Round:   25 / Acc: 10.911% / Loss: 2.2455 / Grad Norm: 0.3173 / Grad Diff: 8.8988 / Time: 7.83s
======================================================================================================

= Test = round: 25 / acc: 12.350% / loss: 2.2376 / Time: 0.82s
======================================================================================================

round 25 local learning rate = 0.002

>>> Round:   26 / Acc: 11.024% / Loss: 2.2434 / Grad Norm: 0.3219 / Grad Diff: 9.2063 / Time: 7.75s
======================================================================================================

round 26 local learning rate = 0.0019230769230769232

>>> Round:   27 / Acc: 11.107% / Loss: 2.2414 / Grad Norm: 0.3264 / Grad Diff: 9.5117 / Time: 7.71s
======================================================================================================

round 27 local learning rate = 0.001851851851851852

>>> Round:   28 / Acc: 11.194% / Loss: 2.2395 / Grad Norm: 0.3311 / Grad Diff: 9.8150 / Time: 7.68s
======================================================================================================

round 28 local learning rate = 0.0017857142857142859

>>> Round:   29 / Acc: 11.325% / Loss: 2.2375 / Grad Norm: 0.3359 / Grad Diff: 10.1207 / Time: 7.50s
======================================================================================================

round 29 local learning rate = 0.001724137931034483

>>> Round:   30 / Acc: 11.461% / Loss: 2.2356 / Grad Norm: 0.3400 / Grad Diff: 10.4090 / Time: 7.49s
======================================================================================================

= Test = round: 30 / acc: 12.980% / loss: 2.2268 / Time: 0.62s
======================================================================================================

round 30 local learning rate = 0.0016666666666666668

>>> Round:   31 / Acc: 11.576% / Loss: 2.2336 / Grad Norm: 0.3440 / Grad Diff: 10.6972 / Time: 7.86s
======================================================================================================

round 31 local learning rate = 0.0016129032258064516

>>> Round:   32 / Acc: 11.622% / Loss: 2.2316 / Grad Norm: 0.3470 / Grad Diff: 10.9745 / Time: 7.60s
======================================================================================================

round 32 local learning rate = 0.0015625

>>> Round:   33 / Acc: 11.779% / Loss: 2.2298 / Grad Norm: 0.3515 / Grad Diff: 11.2647 / Time: 7.90s
======================================================================================================

round 33 local learning rate = 0.0015151515151515152

>>> Round:   34 / Acc: 11.911% / Loss: 2.2279 / Grad Norm: 0.3554 / Grad Diff: 11.5415 / Time: 7.59s
======================================================================================================

round 34 local learning rate = 0.0014705882352941176

>>> Round:   35 / Acc: 12.011% / Loss: 2.2260 / Grad Norm: 0.3589 / Grad Diff: 11.8140 / Time: 8.42s
======================================================================================================

= Test = round: 35 / acc: 13.450% / loss: 2.2164 / Time: 0.65s
======================================================================================================

round 35 local learning rate = 0.0014285714285714286

>>> Round:   36 / Acc: 12.127% / Loss: 2.2241 / Grad Norm: 0.3621 / Grad Diff: 12.0726 / Time: 7.74s
======================================================================================================

round 36 local learning rate = 0.001388888888888889

>>> Round:   37 / Acc: 12.253% / Loss: 2.2223 / Grad Norm: 0.3654 / Grad Diff: 12.3386 / Time: 7.93s
======================================================================================================

round 37 local learning rate = 0.0013513513513513514

>>> Round:   38 / Acc: 12.365% / Loss: 2.2204 / Grad Norm: 0.3687 / Grad Diff: 12.6013 / Time: 7.73s
======================================================================================================

round 38 local learning rate = 0.0013157894736842105

>>> Round:   39 / Acc: 12.504% / Loss: 2.2186 / Grad Norm: 0.3722 / Grad Diff: 12.8659 / Time: 7.61s
======================================================================================================

round 39 local learning rate = 0.001282051282051282

>>> Round:   40 / Acc: 12.592% / Loss: 2.2168 / Grad Norm: 0.3755 / Grad Diff: 13.1277 / Time: 7.68s
======================================================================================================

= Test = round: 40 / acc: 14.280% / loss: 2.2066 / Time: 0.62s
======================================================================================================

round 40 local learning rate = 0.00125

>>> Round:   41 / Acc: 12.723% / Loss: 2.2150 / Grad Norm: 0.3786 / Grad Diff: 13.3773 / Time: 8.81s
======================================================================================================

round 41 local learning rate = 0.0012195121951219512

>>> Round:   42 / Acc: 12.836% / Loss: 2.2132 / Grad Norm: 0.3816 / Grad Diff: 13.6263 / Time: 7.78s
======================================================================================================

round 42 local learning rate = 0.0011904761904761906

>>> Round:   43 / Acc: 12.958% / Loss: 2.2115 / Grad Norm: 0.3844 / Grad Diff: 13.8682 / Time: 7.35s
======================================================================================================

round 43 local learning rate = 0.0011627906976744186

>>> Round:   44 / Acc: 13.063% / Loss: 2.2097 / Grad Norm: 0.3873 / Grad Diff: 14.1102 / Time: 8.17s
======================================================================================================

round 44 local learning rate = 0.0011363636363636365

>>> Round:   45 / Acc: 13.218% / Loss: 2.2079 / Grad Norm: 0.3907 / Grad Diff: 14.3569 / Time: 7.63s
======================================================================================================

= Test = round: 45 / acc: 14.950% / loss: 2.1973 / Time: 0.64s
======================================================================================================

round 45 local learning rate = 0.0011111111111111111

>>> Round:   46 / Acc: 13.319% / Loss: 2.2062 / Grad Norm: 0.3933 / Grad Diff: 14.5959 / Time: 9.43s
======================================================================================================

round 46 local learning rate = 0.0010869565217391304

>>> Round:   47 / Acc: 13.421% / Loss: 2.2045 / Grad Norm: 0.3962 / Grad Diff: 14.8386 / Time: 7.94s
======================================================================================================

round 47 local learning rate = 0.0010638297872340426

>>> Round:   48 / Acc: 13.622% / Loss: 2.2027 / Grad Norm: 0.3989 / Grad Diff: 15.0739 / Time: 7.68s
======================================================================================================

round 48 local learning rate = 0.0010416666666666667

>>> Round:   49 / Acc: 13.777% / Loss: 2.2010 / Grad Norm: 0.4018 / Grad Diff: 15.3095 / Time: 7.88s
======================================================================================================

round 49 local learning rate = 0.0010204081632653062

>>> Round:   50 / Acc: 13.935% / Loss: 2.1993 / Grad Norm: 0.4044 / Grad Diff: 15.5394 / Time: 7.70s
======================================================================================================

= Test = round: 50 / acc: 15.830% / loss: 2.1882 / Time: 0.62s
======================================================================================================

round 50 local learning rate = 0.001

>>> Round:   51 / Acc: 14.050% / Loss: 2.1976 / Grad Norm: 0.4069 / Grad Diff: 15.7709 / Time: 7.99s
======================================================================================================

round 51 local learning rate = 0.000980392156862745

>>> Round:   52 / Acc: 14.334% / Loss: 2.1960 / Grad Norm: 0.4096 / Grad Diff: 16.0035 / Time: 7.34s
======================================================================================================

round 52 local learning rate = 0.0009615384615384616

>>> Round:   53 / Acc: 14.459% / Loss: 2.1943 / Grad Norm: 0.4121 / Grad Diff: 16.2361 / Time: 7.95s
======================================================================================================

round 53 local learning rate = 0.0009433962264150943

>>> Round:   54 / Acc: 14.600% / Loss: 2.1926 / Grad Norm: 0.4145 / Grad Diff: 16.4611 / Time: 7.68s
======================================================================================================

round 54 local learning rate = 0.000925925925925926

>>> Round:   55 / Acc: 14.742% / Loss: 2.1910 / Grad Norm: 0.4168 / Grad Diff: 16.6830 / Time: 7.51s
======================================================================================================

= Test = round: 55 / acc: 16.700% / loss: 2.1794 / Time: 0.63s
======================================================================================================

round 55 local learning rate = 0.0009090909090909091

>>> Round:   56 / Acc: 14.937% / Loss: 2.1893 / Grad Norm: 0.4190 / Grad Diff: 16.9023 / Time: 7.60s
======================================================================================================

round 56 local learning rate = 0.0008928571428571429

>>> Round:   57 / Acc: 15.100% / Loss: 2.1877 / Grad Norm: 0.4213 / Grad Diff: 17.1212 / Time: 8.22s
======================================================================================================

round 57 local learning rate = 0.0008771929824561404

>>> Round:   58 / Acc: 15.262% / Loss: 2.1861 / Grad Norm: 0.4235 / Grad Diff: 17.3371 / Time: 7.65s
======================================================================================================

round 58 local learning rate = 0.0008620689655172415

>>> Round:   59 / Acc: 15.382% / Loss: 2.1845 / Grad Norm: 0.4256 / Grad Diff: 17.5552 / Time: 7.55s
======================================================================================================

round 59 local learning rate = 0.0008474576271186442

>>> Round:   60 / Acc: 15.528% / Loss: 2.1829 / Grad Norm: 0.4282 / Grad Diff: 17.7735 / Time: 7.89s
======================================================================================================

= Test = round: 60 / acc: 17.650% / loss: 2.1710 / Time: 0.78s
======================================================================================================

round 60 local learning rate = 0.0008333333333333334

>>> Round:   61 / Acc: 15.736% / Loss: 2.1813 / Grad Norm: 0.4306 / Grad Diff: 17.9924 / Time: 7.88s
======================================================================================================

round 61 local learning rate = 0.000819672131147541

>>> Round:   62 / Acc: 15.862% / Loss: 2.1797 / Grad Norm: 0.4329 / Grad Diff: 18.2095 / Time: 9.52s
======================================================================================================

round 62 local learning rate = 0.0008064516129032258

>>> Round:   63 / Acc: 16.035% / Loss: 2.1782 / Grad Norm: 0.4356 / Grad Diff: 18.4299 / Time: 8.90s
======================================================================================================

round 63 local learning rate = 0.0007936507936507937

>>> Round:   64 / Acc: 16.164% / Loss: 2.1766 / Grad Norm: 0.4374 / Grad Diff: 18.6361 / Time: 7.61s
======================================================================================================

round 64 local learning rate = 0.00078125

>>> Round:   65 / Acc: 16.293% / Loss: 2.1750 / Grad Norm: 0.4393 / Grad Diff: 18.8428 / Time: 7.61s
======================================================================================================

= Test = round: 65 / acc: 18.420% / loss: 2.1627 / Time: 0.61s
======================================================================================================

round 65 local learning rate = 0.0007692307692307692

>>> Round:   66 / Acc: 16.423% / Loss: 2.1735 / Grad Norm: 0.4415 / Grad Diff: 19.0503 / Time: 7.67s
======================================================================================================

round 66 local learning rate = 0.0007575757575757576

>>> Round:   67 / Acc: 16.563% / Loss: 2.1719 / Grad Norm: 0.4438 / Grad Diff: 19.2626 / Time: 8.84s
======================================================================================================

round 67 local learning rate = 0.0007462686567164179

>>> Round:   68 / Acc: 16.718% / Loss: 2.1704 / Grad Norm: 0.4458 / Grad Diff: 19.4674 / Time: 7.96s
======================================================================================================

round 68 local learning rate = 0.0007352941176470588

>>> Round:   69 / Acc: 16.902% / Loss: 2.1689 / Grad Norm: 0.4482 / Grad Diff: 19.6761 / Time: 9.23s
======================================================================================================

round 69 local learning rate = 0.0007246376811594203

>>> Round:   70 / Acc: 17.057% / Loss: 2.1673 / Grad Norm: 0.4503 / Grad Diff: 19.8792 / Time: 7.85s
======================================================================================================

= Test = round: 70 / acc: 19.090% / loss: 2.1547 / Time: 0.61s
======================================================================================================

round 70 local learning rate = 0.0007142857142857143

>>> Round:   71 / Acc: 17.194% / Loss: 2.1658 / Grad Norm: 0.4525 / Grad Diff: 20.0843 / Time: 7.93s
======================================================================================================

round 71 local learning rate = 0.0007042253521126761

>>> Round:   72 / Acc: 17.319% / Loss: 2.1643 / Grad Norm: 0.4544 / Grad Diff: 20.2903 / Time: 7.12s
======================================================================================================

round 72 local learning rate = 0.0006944444444444445

>>> Round:   73 / Acc: 17.458% / Loss: 2.1628 / Grad Norm: 0.4563 / Grad Diff: 20.4876 / Time: 7.43s
======================================================================================================

round 73 local learning rate = 0.0006849315068493151

>>> Round:   74 / Acc: 17.659% / Loss: 2.1613 / Grad Norm: 0.4585 / Grad Diff: 20.6906 / Time: 7.70s
======================================================================================================

round 74 local learning rate = 0.0006756756756756757

>>> Round:   75 / Acc: 17.788% / Loss: 2.1598 / Grad Norm: 0.4600 / Grad Diff: 20.8860 / Time: 7.67s
======================================================================================================

= Test = round: 75 / acc: 19.810% / loss: 2.1469 / Time: 0.64s
======================================================================================================

round 75 local learning rate = 0.0006666666666666668

>>> Round:   76 / Acc: 17.917% / Loss: 2.1583 / Grad Norm: 0.4621 / Grad Diff: 21.0898 / Time: 7.81s
======================================================================================================

round 76 local learning rate = 0.0006578947368421052

>>> Round:   77 / Acc: 18.057% / Loss: 2.1568 / Grad Norm: 0.4640 / Grad Diff: 21.2890 / Time: 7.74s
======================================================================================================

round 77 local learning rate = 0.0006493506493506494

>>> Round:   78 / Acc: 18.188% / Loss: 2.1554 / Grad Norm: 0.4658 / Grad Diff: 21.4857 / Time: 7.54s
======================================================================================================

round 78 local learning rate = 0.000641025641025641

>>> Round:   79 / Acc: 18.389% / Loss: 2.1539 / Grad Norm: 0.4677 / Grad Diff: 21.6831 / Time: 7.91s
======================================================================================================

round 79 local learning rate = 0.0006329113924050633

>>> Round:   80 / Acc: 18.526% / Loss: 2.1525 / Grad Norm: 0.4697 / Grad Diff: 21.8835 / Time: 8.74s
======================================================================================================

= Test = round: 80 / acc: 20.550% / loss: 2.1392 / Time: 0.67s
======================================================================================================

round 80 local learning rate = 0.000625

>>> Round:   81 / Acc: 18.616% / Loss: 2.1510 / Grad Norm: 0.4714 / Grad Diff: 22.0754 / Time: 7.78s
======================================================================================================

round 81 local learning rate = 0.0006172839506172839

>>> Round:   82 / Acc: 18.786% / Loss: 2.1495 / Grad Norm: 0.4731 / Grad Diff: 22.2672 / Time: 9.37s
======================================================================================================

round 82 local learning rate = 0.0006097560975609756

>>> Round:   83 / Acc: 18.899% / Loss: 2.1481 / Grad Norm: 0.4747 / Grad Diff: 22.4577 / Time: 7.72s
======================================================================================================

round 83 local learning rate = 0.0006024096385542169

>>> Round:   84 / Acc: 18.994% / Loss: 2.1467 / Grad Norm: 0.4767 / Grad Diff: 22.6579 / Time: 7.91s
======================================================================================================

round 84 local learning rate = 0.0005952380952380953

>>> Round:   85 / Acc: 19.146% / Loss: 2.1452 / Grad Norm: 0.4785 / Grad Diff: 22.8489 / Time: 7.83s
======================================================================================================

= Test = round: 85 / acc: 21.150% / loss: 2.1316 / Time: 0.69s
======================================================================================================

round 85 local learning rate = 0.0005882352941176471

>>> Round:   86 / Acc: 19.306% / Loss: 2.1438 / Grad Norm: 0.4804 / Grad Diff: 23.0396 / Time: 7.91s
======================================================================================================

round 86 local learning rate = 0.0005813953488372093

>>> Round:   87 / Acc: 19.424% / Loss: 2.1424 / Grad Norm: 0.4821 / Grad Diff: 23.2278 / Time: 7.84s
======================================================================================================

round 87 local learning rate = 0.0005747126436781609

>>> Round:   88 / Acc: 19.555% / Loss: 2.1410 / Grad Norm: 0.4840 / Grad Diff: 23.4209 / Time: 7.98s
======================================================================================================

round 88 local learning rate = 0.0005681818181818183

>>> Round:   89 / Acc: 19.705% / Loss: 2.1396 / Grad Norm: 0.4859 / Grad Diff: 23.6144 / Time: 7.64s
======================================================================================================

round 89 local learning rate = 0.0005617977528089888

>>> Round:   90 / Acc: 19.797% / Loss: 2.1382 / Grad Norm: 0.4878 / Grad Diff: 23.8033 / Time: 8.34s
======================================================================================================

= Test = round: 90 / acc: 21.850% / loss: 2.1242 / Time: 0.68s
======================================================================================================

round 90 local learning rate = 0.0005555555555555556

>>> Round:   91 / Acc: 19.963% / Loss: 2.1368 / Grad Norm: 0.4898 / Grad Diff: 23.9955 / Time: 7.96s
======================================================================================================

round 91 local learning rate = 0.0005494505494505495

>>> Round:   92 / Acc: 20.070% / Loss: 2.1354 / Grad Norm: 0.4912 / Grad Diff: 24.1767 / Time: 9.04s
======================================================================================================

round 92 local learning rate = 0.0005434782608695652

>>> Round:   93 / Acc: 20.208% / Loss: 2.1340 / Grad Norm: 0.4931 / Grad Diff: 24.3683 / Time: 8.35s
======================================================================================================

round 93 local learning rate = 0.0005376344086021505

>>> Round:   94 / Acc: 20.373% / Loss: 2.1326 / Grad Norm: 0.4950 / Grad Diff: 24.5560 / Time: 8.26s
======================================================================================================

round 94 local learning rate = 0.0005319148936170213

>>> Round:   95 / Acc: 20.522% / Loss: 2.1313 / Grad Norm: 0.4969 / Grad Diff: 24.7490 / Time: 7.83s
======================================================================================================

= Test = round: 95 / acc: 22.520% / loss: 2.1170 / Time: 0.62s
======================================================================================================

round 95 local learning rate = 0.0005263157894736842

>>> Round:   96 / Acc: 20.625% / Loss: 2.1299 / Grad Norm: 0.4987 / Grad Diff: 24.9365 / Time: 7.73s
======================================================================================================

round 96 local learning rate = 0.0005208333333333333

>>> Round:   97 / Acc: 20.764% / Loss: 2.1285 / Grad Norm: 0.5006 / Grad Diff: 25.1255 / Time: 7.72s
======================================================================================================

round 97 local learning rate = 0.0005154639175257732

>>> Round:   98 / Acc: 20.910% / Loss: 2.1272 / Grad Norm: 0.5009 / Grad Diff: 25.3102 / Time: 8.22s
======================================================================================================

round 98 local learning rate = 0.0005102040816326531

>>> Round:   99 / Acc: 21.070% / Loss: 2.1258 / Grad Norm: 0.5027 / Grad Diff: 25.4932 / Time: 7.82s
======================================================================================================

round 99 local learning rate = 0.000505050505050505

>>> Round:  100 / Acc: 21.221% / Loss: 2.1245 / Grad Norm: 0.5044 / Grad Diff: 25.6745 / Time: 8.05s
======================================================================================================

= Test = round: 100 / acc: 23.270% / loss: 2.1099 / Time: 0.63s
======================================================================================================

round 100 local learning rate = 0.0005

>>> Round:  101 / Acc: 21.360% / Loss: 2.1231 / Grad Norm: 0.5062 / Grad Diff: 25.8587 / Time: 7.83s
======================================================================================================

round 101 local learning rate = 0.0004950495049504951

>>> Round:  102 / Acc: 21.544% / Loss: 2.1218 / Grad Norm: 0.5082 / Grad Diff: 26.0453 / Time: 7.92s
======================================================================================================

round 102 local learning rate = 0.0004901960784313725

>>> Round:  103 / Acc: 21.716% / Loss: 2.1205 / Grad Norm: 0.5098 / Grad Diff: 26.2260 / Time: 7.76s
======================================================================================================

round 103 local learning rate = 0.00048543689320388353

>>> Round:  104 / Acc: 21.862% / Loss: 2.1191 / Grad Norm: 0.5115 / Grad Diff: 26.4095 / Time: 8.46s
======================================================================================================

round 104 local learning rate = 0.0004807692307692308

>>> Round:  105 / Acc: 22.031% / Loss: 2.1178 / Grad Norm: 0.5132 / Grad Diff: 26.5918 / Time: 9.28s
======================================================================================================

= Test = round: 105 / acc: 24.140% / loss: 2.1030 / Time: 0.66s
======================================================================================================

round 105 local learning rate = 0.0004761904761904762

>>> Round:  106 / Acc: 22.153% / Loss: 2.1165 / Grad Norm: 0.5150 / Grad Diff: 26.7770 / Time: 7.92s
======================================================================================================

round 106 local learning rate = 0.0004716981132075472

>>> Round:  107 / Acc: 22.351% / Loss: 2.1152 / Grad Norm: 0.5168 / Grad Diff: 26.9571 / Time: 7.86s
======================================================================================================

round 107 local learning rate = 0.00046728971962616824

>>> Round:  108 / Acc: 22.552% / Loss: 2.1138 / Grad Norm: 0.5183 / Grad Diff: 27.1337 / Time: 8.63s
======================================================================================================

round 108 local learning rate = 0.000462962962962963

>>> Round:  109 / Acc: 22.681% / Loss: 2.1125 / Grad Norm: 0.5200 / Grad Diff: 27.3152 / Time: 7.66s
======================================================================================================

round 109 local learning rate = 0.00045871559633027525

>>> Round:  110 / Acc: 22.819% / Loss: 2.1112 / Grad Norm: 0.5218 / Grad Diff: 27.4959 / Time: 7.79s
======================================================================================================

= Test = round: 110 / acc: 24.880% / loss: 2.0961 / Time: 0.62s
======================================================================================================

round 110 local learning rate = 0.00045454545454545455

>>> Round:  111 / Acc: 23.004% / Loss: 2.1099 / Grad Norm: 0.5235 / Grad Diff: 27.6756 / Time: 7.67s
======================================================================================================

round 111 local learning rate = 0.00045045045045045046

>>> Round:  112 / Acc: 23.177% / Loss: 2.1086 / Grad Norm: 0.5250 / Grad Diff: 27.8499 / Time: 7.63s
======================================================================================================

round 112 local learning rate = 0.00044642857142857147

>>> Round:  113 / Acc: 23.310% / Loss: 2.1073 / Grad Norm: 0.5265 / Grad Diff: 28.0246 / Time: 7.62s
======================================================================================================

round 113 local learning rate = 0.00044247787610619474

>>> Round:  114 / Acc: 23.423% / Loss: 2.1060 / Grad Norm: 0.5280 / Grad Diff: 28.1989 / Time: 8.57s
======================================================================================================

round 114 local learning rate = 0.0004385964912280702

>>> Round:  115 / Acc: 23.561% / Loss: 2.1048 / Grad Norm: 0.5298 / Grad Diff: 28.3747 / Time: 7.87s
======================================================================================================

= Test = round: 115 / acc: 25.580% / loss: 2.0894 / Time: 0.65s
======================================================================================================

round 115 local learning rate = 0.0004347826086956522

>>> Round:  116 / Acc: 23.673% / Loss: 2.1035 / Grad Norm: 0.5315 / Grad Diff: 28.5568 / Time: 7.11s
======================================================================================================

round 116 local learning rate = 0.00043103448275862074

>>> Round:  117 / Acc: 23.797% / Loss: 2.1022 / Grad Norm: 0.5333 / Grad Diff: 28.7393 / Time: 7.96s
======================================================================================================

round 117 local learning rate = 0.00042735042735042735

>>> Round:  118 / Acc: 23.956% / Loss: 2.1009 / Grad Norm: 0.5349 / Grad Diff: 28.9186 / Time: 7.61s
======================================================================================================

round 118 local learning rate = 0.0004237288135593221

>>> Round:  119 / Acc: 24.107% / Loss: 2.0996 / Grad Norm: 0.5366 / Grad Diff: 29.0950 / Time: 7.74s
======================================================================================================

round 119 local learning rate = 0.0004201680672268908

>>> Round:  120 / Acc: 24.231% / Loss: 2.0984 / Grad Norm: 0.5381 / Grad Diff: 29.2697 / Time: 7.78s
======================================================================================================

= Test = round: 120 / acc: 26.310% / loss: 2.0827 / Time: 0.63s
======================================================================================================

round 120 local learning rate = 0.0004166666666666667

>>> Round:  121 / Acc: 24.402% / Loss: 2.0971 / Grad Norm: 0.5397 / Grad Diff: 29.4429 / Time: 7.58s
======================================================================================================

round 121 local learning rate = 0.0004132231404958678

>>> Round:  122 / Acc: 24.518% / Loss: 2.0958 / Grad Norm: 0.5412 / Grad Diff: 29.6203 / Time: 7.74s
======================================================================================================

round 122 local learning rate = 0.0004098360655737705

>>> Round:  123 / Acc: 24.657% / Loss: 2.0945 / Grad Norm: 0.5426 / Grad Diff: 29.7919 / Time: 7.56s
======================================================================================================

round 123 local learning rate = 0.0004065040650406504

>>> Round:  124 / Acc: 24.843% / Loss: 2.0933 / Grad Norm: 0.5440 / Grad Diff: 29.9618 / Time: 7.75s
======================================================================================================

round 124 local learning rate = 0.0004032258064516129

>>> Round:  125 / Acc: 25.017% / Loss: 2.0920 / Grad Norm: 0.5455 / Grad Diff: 30.1365 / Time: 7.74s
======================================================================================================

= Test = round: 125 / acc: 27.010% / loss: 2.0761 / Time: 0.63s
======================================================================================================

round 125 local learning rate = 0.0004

>>> Round:  126 / Acc: 25.183% / Loss: 2.0908 / Grad Norm: 0.5471 / Grad Diff: 30.3124 / Time: 8.72s
======================================================================================================

round 126 local learning rate = 0.0003968253968253968

>>> Round:  127 / Acc: 25.315% / Loss: 2.0895 / Grad Norm: 0.5484 / Grad Diff: 30.4741 / Time: 7.91s
======================================================================================================

round 127 local learning rate = 0.00039370078740157485

>>> Round:  128 / Acc: 25.421% / Loss: 2.0883 / Grad Norm: 0.5497 / Grad Diff: 30.6375 / Time: 7.81s
======================================================================================================

round 128 local learning rate = 0.000390625

>>> Round:  129 / Acc: 25.531% / Loss: 2.0870 / Grad Norm: 0.5512 / Grad Diff: 30.8096 / Time: 7.88s
======================================================================================================

round 129 local learning rate = 0.0003875968992248062

>>> Round:  130 / Acc: 25.638% / Loss: 2.0858 / Grad Norm: 0.5529 / Grad Diff: 30.9858 / Time: 7.74s
======================================================================================================

= Test = round: 130 / acc: 27.460% / loss: 2.0696 / Time: 0.63s
======================================================================================================

round 130 local learning rate = 0.0003846153846153846

>>> Round:  131 / Acc: 25.799% / Loss: 2.0846 / Grad Norm: 0.5542 / Grad Diff: 31.1498 / Time: 7.85s
======================================================================================================

round 131 local learning rate = 0.0003816793893129771

>>> Round:  132 / Acc: 25.893% / Loss: 2.0833 / Grad Norm: 0.5557 / Grad Diff: 31.3201 / Time: 7.78s
======================================================================================================

round 132 local learning rate = 0.0003787878787878788

>>> Round:  133 / Acc: 26.033% / Loss: 2.0821 / Grad Norm: 0.5572 / Grad Diff: 31.4926 / Time: 7.70s
======================================================================================================

round 133 local learning rate = 0.00037593984962406017

>>> Round:  134 / Acc: 26.212% / Loss: 2.0809 / Grad Norm: 0.5588 / Grad Diff: 31.6620 / Time: 7.62s
======================================================================================================

round 134 local learning rate = 0.00037313432835820896

>>> Round:  135 / Acc: 26.339% / Loss: 2.0796 / Grad Norm: 0.5602 / Grad Diff: 31.8341 / Time: 7.54s
======================================================================================================

= Test = round: 135 / acc: 28.380% / loss: 2.0632 / Time: 0.67s
======================================================================================================

round 135 local learning rate = 0.0003703703703703704

>>> Round:  136 / Acc: 26.474% / Loss: 2.0784 / Grad Norm: 0.5619 / Grad Diff: 32.0046 / Time: 8.67s
======================================================================================================

round 136 local learning rate = 0.0003676470588235294

>>> Round:  137 / Acc: 26.601% / Loss: 2.0772 / Grad Norm: 0.5634 / Grad Diff: 32.1779 / Time: 7.70s
======================================================================================================

round 137 local learning rate = 0.00036496350364963507

>>> Round:  138 / Acc: 26.734% / Loss: 2.0760 / Grad Norm: 0.5647 / Grad Diff: 32.3425 / Time: 7.62s
======================================================================================================

round 138 local learning rate = 0.00036231884057971015

>>> Round:  139 / Acc: 26.884% / Loss: 2.0748 / Grad Norm: 0.5661 / Grad Diff: 32.5065 / Time: 8.08s
======================================================================================================

round 139 local learning rate = 0.00035971223021582735

>>> Round:  140 / Acc: 26.985% / Loss: 2.0736 / Grad Norm: 0.5675 / Grad Diff: 32.6711 / Time: 9.05s
======================================================================================================

= Test = round: 140 / acc: 29.130% / loss: 2.0569 / Time: 0.66s
======================================================================================================

round 140 local learning rate = 0.00035714285714285714

>>> Round:  141 / Acc: 27.120% / Loss: 2.0723 / Grad Norm: 0.5688 / Grad Diff: 32.8366 / Time: 8.01s
======================================================================================================

round 141 local learning rate = 0.0003546099290780142

>>> Round:  142 / Acc: 27.245% / Loss: 2.0711 / Grad Norm: 0.5702 / Grad Diff: 33.0001 / Time: 8.45s
======================================================================================================

round 142 local learning rate = 0.00035211267605633805

>>> Round:  143 / Acc: 27.352% / Loss: 2.0699 / Grad Norm: 0.5715 / Grad Diff: 33.1624 / Time: 8.05s
======================================================================================================

round 143 local learning rate = 0.00034965034965034965

>>> Round:  144 / Acc: 27.494% / Loss: 2.0687 / Grad Norm: 0.5729 / Grad Diff: 33.3277 / Time: 7.13s
======================================================================================================

round 144 local learning rate = 0.00034722222222222224

>>> Round:  145 / Acc: 27.590% / Loss: 2.0675 / Grad Norm: 0.5743 / Grad Diff: 33.4945 / Time: 7.94s
======================================================================================================

= Test = round: 145 / acc: 29.740% / loss: 2.0506 / Time: 0.66s
======================================================================================================

round 145 local learning rate = 0.0003448275862068966

>>> Round:  146 / Acc: 27.721% / Loss: 2.0663 / Grad Norm: 0.5758 / Grad Diff: 33.6657 / Time: 7.75s
======================================================================================================

round 146 local learning rate = 0.00034246575342465754

>>> Round:  147 / Acc: 27.814% / Loss: 2.0651 / Grad Norm: 0.5772 / Grad Diff: 33.8294 / Time: 7.93s
======================================================================================================

round 147 local learning rate = 0.00034013605442176874

>>> Round:  148 / Acc: 27.887% / Loss: 2.0639 / Grad Norm: 0.5785 / Grad Diff: 33.9918 / Time: 8.07s
======================================================================================================

round 148 local learning rate = 0.00033783783783783786

>>> Round:  149 / Acc: 27.965% / Loss: 2.0628 / Grad Norm: 0.5797 / Grad Diff: 34.1573 / Time: 8.47s
======================================================================================================

round 149 local learning rate = 0.00033557046979865775

>>> Round:  150 / Acc: 28.028% / Loss: 2.0616 / Grad Norm: 0.5810 / Grad Diff: 34.3183 / Time: 8.95s
======================================================================================================

= Test = round: 150 / acc: 30.140% / loss: 2.0443 / Time: 0.63s
======================================================================================================

round 150 local learning rate = 0.0003333333333333334

>>> Round:  151 / Acc: 28.114% / Loss: 2.0604 / Grad Norm: 0.5824 / Grad Diff: 34.4777 / Time: 7.87s
======================================================================================================

round 151 local learning rate = 0.00033112582781456954

>>> Round:  152 / Acc: 28.216% / Loss: 2.0592 / Grad Norm: 0.5838 / Grad Diff: 34.6428 / Time: 7.67s
======================================================================================================

round 152 local learning rate = 0.0003289473684210526

>>> Round:  153 / Acc: 28.332% / Loss: 2.0580 / Grad Norm: 0.5851 / Grad Diff: 34.8059 / Time: 8.01s
======================================================================================================

round 153 local learning rate = 0.00032679738562091506

>>> Round:  154 / Acc: 28.452% / Loss: 2.0568 / Grad Norm: 0.5865 / Grad Diff: 34.9713 / Time: 7.68s
======================================================================================================

round 154 local learning rate = 0.0003246753246753247

>>> Round:  155 / Acc: 28.522% / Loss: 2.0557 / Grad Norm: 0.5879 / Grad Diff: 35.1360 / Time: 9.11s
======================================================================================================

= Test = round: 155 / acc: 30.550% / loss: 2.0382 / Time: 0.62s
======================================================================================================

round 155 local learning rate = 0.0003225806451612903

>>> Round:  156 / Acc: 28.649% / Loss: 2.0545 / Grad Norm: 0.5894 / Grad Diff: 35.3031 / Time: 6.92s
======================================================================================================

round 156 local learning rate = 0.0003205128205128205

>>> Round:  157 / Acc: 28.760% / Loss: 2.0533 / Grad Norm: 0.5906 / Grad Diff: 35.4629 / Time: 8.36s
======================================================================================================

round 157 local learning rate = 0.00031847133757961787

>>> Round:  158 / Acc: 28.849% / Loss: 2.0522 / Grad Norm: 0.5920 / Grad Diff: 35.6256 / Time: 8.88s
======================================================================================================

round 158 local learning rate = 0.00031645569620253165

>>> Round:  159 / Acc: 28.961% / Loss: 2.0510 / Grad Norm: 0.5934 / Grad Diff: 35.7903 / Time: 7.51s
======================================================================================================

round 159 local learning rate = 0.0003144654088050315

>>> Round:  160 / Acc: 29.089% / Loss: 2.0498 / Grad Norm: 0.5949 / Grad Diff: 35.9534 / Time: 7.66s
======================================================================================================

= Test = round: 160 / acc: 31.110% / loss: 2.0322 / Time: 0.63s
======================================================================================================

round 160 local learning rate = 0.0003125

>>> Round:  161 / Acc: 29.162% / Loss: 2.0487 / Grad Norm: 0.5960 / Grad Diff: 36.1098 / Time: 7.78s
======================================================================================================

round 161 local learning rate = 0.00031055900621118014

>>> Round:  162 / Acc: 29.266% / Loss: 2.0475 / Grad Norm: 0.5972 / Grad Diff: 36.2663 / Time: 7.94s
======================================================================================================

round 162 local learning rate = 0.00030864197530864197

>>> Round:  163 / Acc: 29.376% / Loss: 2.0464 / Grad Norm: 0.5985 / Grad Diff: 36.4250 / Time: 7.80s
======================================================================================================

round 163 local learning rate = 0.00030674846625766873

>>> Round:  164 / Acc: 29.463% / Loss: 2.0452 / Grad Norm: 0.6000 / Grad Diff: 36.5897 / Time: 7.73s
======================================================================================================

round 164 local learning rate = 0.0003048780487804878

>>> Round:  165 / Acc: 29.511% / Loss: 2.0441 / Grad Norm: 0.6013 / Grad Diff: 36.7512 / Time: 7.76s
======================================================================================================

= Test = round: 165 / acc: 31.600% / loss: 2.0262 / Time: 0.62s
======================================================================================================

round 165 local learning rate = 0.00030303030303030303

>>> Round:  166 / Acc: 29.568% / Loss: 2.0429 / Grad Norm: 0.6024 / Grad Diff: 36.9077 / Time: 7.61s
======================================================================================================

round 166 local learning rate = 0.00030120481927710846

>>> Round:  167 / Acc: 29.596% / Loss: 2.0418 / Grad Norm: 0.6037 / Grad Diff: 37.0687 / Time: 7.81s
======================================================================================================

round 167 local learning rate = 0.0002994011976047904

>>> Round:  168 / Acc: 29.662% / Loss: 2.0406 / Grad Norm: 0.6049 / Grad Diff: 37.2268 / Time: 7.67s
======================================================================================================

round 168 local learning rate = 0.00029761904761904765

>>> Round:  169 / Acc: 29.727% / Loss: 2.0395 / Grad Norm: 0.6060 / Grad Diff: 37.3796 / Time: 7.56s
======================================================================================================

round 169 local learning rate = 0.0002958579881656805

>>> Round:  170 / Acc: 29.804% / Loss: 2.0383 / Grad Norm: 0.6074 / Grad Diff: 37.5448 / Time: 7.34s
======================================================================================================

= Test = round: 170 / acc: 32.040% / loss: 2.0202 / Time: 0.88s
======================================================================================================

round 170 local learning rate = 0.00029411764705882356

>>> Round:  171 / Acc: 29.886% / Loss: 2.0372 / Grad Norm: 0.6086 / Grad Diff: 37.7041 / Time: 7.72s
======================================================================================================

round 171 local learning rate = 0.00029239766081871346

>>> Round:  172 / Acc: 29.954% / Loss: 2.0361 / Grad Norm: 0.6101 / Grad Diff: 37.8718 / Time: 7.74s
======================================================================================================

round 172 local learning rate = 0.00029069767441860465

>>> Round:  173 / Acc: 30.041% / Loss: 2.0349 / Grad Norm: 0.6113 / Grad Diff: 38.0266 / Time: 7.79s
======================================================================================================

round 173 local learning rate = 0.00028901734104046245

>>> Round:  174 / Acc: 30.125% / Loss: 2.0338 / Grad Norm: 0.6123 / Grad Diff: 38.1756 / Time: 7.83s
======================================================================================================

round 174 local learning rate = 0.00028735632183908046

>>> Round:  175 / Acc: 30.227% / Loss: 2.0327 / Grad Norm: 0.6139 / Grad Diff: 38.3465 / Time: 7.27s
======================================================================================================

= Test = round: 175 / acc: 32.550% / loss: 2.0144 / Time: 0.63s
======================================================================================================

round 175 local learning rate = 0.00028571428571428574

>>> Round:  176 / Acc: 30.275% / Loss: 2.0316 / Grad Norm: 0.6150 / Grad Diff: 38.4972 / Time: 7.77s
======================================================================================================

round 176 local learning rate = 0.00028409090909090913

>>> Round:  177 / Acc: 30.330% / Loss: 2.0304 / Grad Norm: 0.6162 / Grad Diff: 38.6584 / Time: 7.87s
======================================================================================================

round 177 local learning rate = 0.0002824858757062147

>>> Round:  178 / Acc: 30.410% / Loss: 2.0293 / Grad Norm: 0.6173 / Grad Diff: 38.8103 / Time: 8.04s
======================================================================================================

round 178 local learning rate = 0.0002808988764044944

>>> Round:  179 / Acc: 30.467% / Loss: 2.0282 / Grad Norm: 0.6184 / Grad Diff: 38.9613 / Time: 8.09s
======================================================================================================

round 179 local learning rate = 0.0002793296089385475

>>> Round:  180 / Acc: 30.530% / Loss: 2.0271 / Grad Norm: 0.6196 / Grad Diff: 39.1215 / Time: 8.00s
======================================================================================================

= Test = round: 180 / acc: 32.880% / loss: 2.0086 / Time: 0.63s
======================================================================================================

round 180 local learning rate = 0.0002777777777777778

>>> Round:  181 / Acc: 30.600% / Loss: 2.0260 / Grad Norm: 0.6209 / Grad Diff: 39.2801 / Time: 7.73s
======================================================================================================

round 181 local learning rate = 0.00027624309392265195

>>> Round:  182 / Acc: 30.646% / Loss: 2.0248 / Grad Norm: 0.6221 / Grad Diff: 39.4371 / Time: 7.98s
======================================================================================================

round 182 local learning rate = 0.0002747252747252747

>>> Round:  183 / Acc: 30.718% / Loss: 2.0237 / Grad Norm: 0.6232 / Grad Diff: 39.5855 / Time: 8.14s
======================================================================================================

round 183 local learning rate = 0.000273224043715847

>>> Round:  184 / Acc: 30.760% / Loss: 2.0226 / Grad Norm: 0.6243 / Grad Diff: 39.7350 / Time: 7.81s
======================================================================================================

round 184 local learning rate = 0.0002717391304347826

>>> Round:  185 / Acc: 30.788% / Loss: 2.0215 / Grad Norm: 0.6256 / Grad Diff: 39.8937 / Time: 7.96s
======================================================================================================

= Test = round: 185 / acc: 33.140% / loss: 2.0028 / Time: 0.64s
======================================================================================================

round 185 local learning rate = 0.0002702702702702703

>>> Round:  186 / Acc: 30.862% / Loss: 2.0204 / Grad Norm: 0.6268 / Grad Diff: 40.0479 / Time: 8.09s
======================================================================================================

round 186 local learning rate = 0.00026881720430107527

>>> Round:  187 / Acc: 30.946% / Loss: 2.0193 / Grad Norm: 0.6280 / Grad Diff: 40.2042 / Time: 7.79s
======================================================================================================

round 187 local learning rate = 0.00026737967914438503

>>> Round:  188 / Acc: 31.011% / Loss: 2.0182 / Grad Norm: 0.6291 / Grad Diff: 40.3555 / Time: 7.90s
======================================================================================================

round 188 local learning rate = 0.00026595744680851064

>>> Round:  189 / Acc: 31.089% / Loss: 2.0171 / Grad Norm: 0.6304 / Grad Diff: 40.5145 / Time: 8.39s
======================================================================================================

round 189 local learning rate = 0.00026455026455026457

>>> Round:  190 / Acc: 31.162% / Loss: 2.0160 / Grad Norm: 0.6315 / Grad Diff: 40.6679 / Time: 7.73s
======================================================================================================

= Test = round: 190 / acc: 33.500% / loss: 1.9971 / Time: 0.79s
======================================================================================================

round 190 local learning rate = 0.0002631578947368421
Traceback (most recent call last):
  File "main_mnist_mnist_m.py", line 332, in <module>
    main()
  File "main_mnist_mnist_m.py", line 275, in main
    trainer.train()
  File "/data/shared/chao/transfer_fl/TranferableFL/src/trainers/fedavgtl.py", line 78, in train
    solns, stats, local_grads = self.local_train(round_i, selected_clients, last_round_avg_local_grad_norm=last_round_avg_local_grad_norm)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/trainers/base.py", line 112, in local_train
    soln, stat, local_grad = c.local_train(last_round_avg_local_grad_norm=last_round_avg_local_grad_norm)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/client.py", line 67, in local_train
    local_solution, worker_stats, local_grad = self.worker.local_train(self.train_dataloader, last_round_avg_local_grad_norm=last_round_avg_local_grad_norm, **kwargs)
  File "/data/shared/chao/transfer_fl/TranferableFL/src/models/worker.py", line 211, in local_train
    torch.nn.utils.clip_grad_norm_(self.model.parameters(), 60)
  File "/home/chaopan2/miniconda3/envs/graph_unlearn/lib/python3.7/site-packages/torch/nn/utils/clip_grad.py", line 42, in clip_grad_norm_
    total_norm = torch.norm(torch.stack([torch.norm(p.grad.detach(), norm_type).to(device) for p in parameters]), norm_type)
KeyboardInterrupt
