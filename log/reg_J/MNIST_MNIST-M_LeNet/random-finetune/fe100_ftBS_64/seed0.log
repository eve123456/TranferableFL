nohup: ignoring input
/home/eve/miniconda3/lib/python3.7/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/eve/miniconda3/lib/python3.7/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
Traceback (most recent call last):
  File "Transfer__MNIST_MNIST-M.py", line 12, in <module>
    from src.utils.worker_utils import read_data
  File "/home/eve/TransferableFL/TranferableFL/src/utils/worker_utils.py", line 8, in <module>
    from tensorboardX import SummaryWriter
ModuleNotFoundError: No module named 'tensorboardX'
nohup: ignoring input



 reg_J_flag =  0
<class 'int'>



 does 0 == 0 ?   True



 reg_J_flag =  False
>>> Arguments:
	             algo : fedavg4
	       batch_size : 64
	clients_per_round : 10
	          dataset : mnist_all_data_1_random_niid
	           device : 0
	              dis : 
	       eval_every : 5
	 finetune_dataset : mnist-m
	  finetune_epochs : 100
	      finetune_lr : 0.01
	      finetune_wd : 0.0
	    ft_batch_size : 64
	              gpu : True
	      input_shape : (1, 28, 28)
	        lbd_reg_J : 0.0001
	               lr : 0.01
	            model : LeNet
	        noaverage : False
	          noprint : False
	        num_class : 10
	        num_epoch : 10
	        num_round : 200
	       reg_J_flag : False
	             seed : 0
	               wd : 0.0
>>> Read data from:
     ./data/mnist/data/train/all_data_1_random_niid.pkl
     ./data/mnist/data/test/all_data_1_random_niid.pkl
Training model_flag...
Epoch:001, Trn_loss:0.0020, Trn_acc:0.3523, Tst_loss:0.0099, Tst_acc:0.3567
Epoch:002, Trn_loss:0.0021, Trn_acc:0.3492, Tst_loss:0.0099, Tst_acc:0.3497
Epoch:003, Trn_loss:0.0018, Trn_acc:0.3638, Tst_loss:0.0078, Tst_acc:0.3704
Epoch:004, Trn_loss:0.0019, Trn_acc:0.3546, Tst_loss:0.0091, Tst_acc:0.3617
Epoch:005, Trn_loss:0.0021, Trn_acc:0.3568, Tst_loss:0.0102, Tst_acc:0.3615
Epoch:006, Trn_loss:0.0018, Trn_acc:0.3665, Tst_loss:0.0096, Tst_acc:0.3701
Epoch:007, Trn_loss:0.0020, Trn_acc:0.3658, Tst_loss:0.0071, Tst_acc:0.3743
Epoch:008, Trn_loss:0.0019, Trn_acc:0.3512, Tst_loss:0.0102, Tst_acc:0.3593
Epoch:009, Trn_loss:0.0018, Trn_acc:0.3622, Tst_loss:0.0082, Tst_acc:0.3626
Epoch:010, Trn_loss:0.0019, Trn_acc:0.3548, Tst_loss:0.0097, Tst_acc:0.3585
Epoch:011, Trn_loss:0.0019, Trn_acc:0.3735, Tst_loss:0.0085, Tst_acc:0.3780
Epoch:012, Trn_loss:0.0017, Trn_acc:0.3693, Tst_loss:0.0096, Tst_acc:0.3756
Epoch:013, Trn_loss:0.0017, Trn_acc:0.3766, Tst_loss:0.0072, Tst_acc:0.3828
Epoch:014, Trn_loss:0.0019, Trn_acc:0.3596, Tst_loss:0.0080, Tst_acc:0.3637
Epoch:015, Trn_loss:0.0020, Trn_acc:0.3723, Tst_loss:0.0089, Tst_acc:0.3750
Epoch:016, Trn_loss:0.0016, Trn_acc:0.3729, Tst_loss:0.0087, Tst_acc:0.3751
Epoch:017, Trn_loss:0.0017, Trn_acc:0.3591, Tst_loss:0.0088, Tst_acc:0.3670
Epoch:018, Trn_loss:0.0018, Trn_acc:0.3618, Tst_loss:0.0085, Tst_acc:0.3668
Epoch:019, Trn_loss:0.0022, Trn_acc:0.3609, Tst_loss:0.0089, Tst_acc:0.3655
Epoch:020, Trn_loss:0.0017, Trn_acc:0.3655, Tst_loss:0.0098, Tst_acc:0.3690
Epoch:021, Trn_loss:0.0018, Trn_acc:0.3439, Tst_loss:0.0088, Tst_acc:0.3511
Epoch:022, Trn_loss:0.0018, Trn_acc:0.3610, Tst_loss:0.0084, Tst_acc:0.3670
Epoch:023, Trn_loss:0.0021, Trn_acc:0.3680, Tst_loss:0.0084, Tst_acc:0.3735
Epoch:024, Trn_loss:0.0019, Trn_acc:0.3776, Tst_loss:0.0089, Tst_acc:0.3795
Epoch:025, Trn_loss:0.0020, Trn_acc:0.3741, Tst_loss:0.0100, Tst_acc:0.3707
Epoch:026, Trn_loss:0.0019, Trn_acc:0.3664, Tst_loss:0.0084, Tst_acc:0.3686
Epoch:027, Trn_loss:0.0018, Trn_acc:0.3772, Tst_loss:0.0087, Tst_acc:0.3810
Epoch:028, Trn_loss:0.0019, Trn_acc:0.3766, Tst_loss:0.0080, Tst_acc:0.3814
Epoch:029, Trn_loss:0.0019, Trn_acc:0.3796, Tst_loss:0.0081, Tst_acc:0.3824
Epoch:030, Trn_loss:0.0018, Trn_acc:0.3574, Tst_loss:0.0075, Tst_acc:0.3583
Epoch:031, Trn_loss:0.0020, Trn_acc:0.3447, Tst_loss:0.0090, Tst_acc:0.3456
Epoch:032, Trn_loss:0.0020, Trn_acc:0.3344, Tst_loss:0.0106, Tst_acc:0.3450
Epoch:033, Trn_loss:0.0019, Trn_acc:0.3805, Tst_loss:0.0096, Tst_acc:0.3855
Epoch:034, Trn_loss:0.0020, Trn_acc:0.3691, Tst_loss:0.0098, Tst_acc:0.3753
Epoch:035, Trn_loss:0.0019, Trn_acc:0.3699, Tst_loss:0.0092, Tst_acc:0.3755
Epoch:036, Trn_loss:0.0018, Trn_acc:0.3532, Tst_loss:0.0080, Tst_acc:0.3552
Epoch:037, Trn_loss:0.0022, Trn_acc:0.3661, Tst_loss:0.0084, Tst_acc:0.3734
Epoch:038, Trn_loss:0.0017, Trn_acc:0.3704, Tst_loss:0.0093, Tst_acc:0.3725
Epoch:039, Trn_loss:0.0019, Trn_acc:0.3734, Tst_loss:0.0086, Tst_acc:0.3761
Epoch:040, Trn_loss:0.0021, Trn_acc:0.3659, Tst_loss:0.0102, Tst_acc:0.3705
Epoch:041, Trn_loss:0.0018, Trn_acc:0.3486, Tst_loss:0.0089, Tst_acc:0.3534
Epoch:042, Trn_loss:0.0017, Trn_acc:0.3699, Tst_loss:0.0093, Tst_acc:0.3700
Epoch:043, Trn_loss:0.0019, Trn_acc:0.3473, Tst_loss:0.0082, Tst_acc:0.3546
Epoch:044, Trn_loss:0.0017, Trn_acc:0.3704, Tst_loss:0.0104, Tst_acc:0.3721
Epoch:045, Trn_loss:0.0018, Trn_acc:0.3630, Tst_loss:0.0085, Tst_acc:0.3684
Epoch:046, Trn_loss:0.0021, Trn_acc:0.3632, Tst_loss:0.0082, Tst_acc:0.3724
Epoch:047, Trn_loss:0.0021, Trn_acc:0.3720, Tst_loss:0.0087, Tst_acc:0.3771
Epoch:048, Trn_loss:0.0019, Trn_acc:0.3752, Tst_loss:0.0087, Tst_acc:0.3846
Epoch:049, Trn_loss:0.0018, Trn_acc:0.3683, Tst_loss:0.0088, Tst_acc:0.3715
Epoch:050, Trn_loss:0.0017, Trn_acc:0.3791, Tst_loss:0.0079, Tst_acc:0.3798
Epoch:051, Trn_loss:0.0017, Trn_acc:0.3517, Tst_loss:0.0079, Tst_acc:0.3638
Epoch:052, Trn_loss:0.0020, Trn_acc:0.3534, Tst_loss:0.0082, Tst_acc:0.3527
Epoch:053, Trn_loss:0.0016, Trn_acc:0.3674, Tst_loss:0.0087, Tst_acc:0.3751
Epoch:054, Trn_loss:0.0016, Trn_acc:0.3538, Tst_loss:0.0097, Tst_acc:0.3531
Epoch:055, Trn_loss:0.0018, Trn_acc:0.3512, Tst_loss:0.0085, Tst_acc:0.3601
Epoch:056, Trn_loss:0.0019, Trn_acc:0.3601, Tst_loss:0.0090, Tst_acc:0.3615
Epoch:057, Trn_loss:0.0018, Trn_acc:0.3753, Tst_loss:0.0086, Tst_acc:0.3842
Epoch:058, Trn_loss:0.0020, Trn_acc:0.3756, Tst_loss:0.0093, Tst_acc:0.3764
Epoch:059, Trn_loss:0.0019, Trn_acc:0.3618, Tst_loss:0.0085, Tst_acc:0.3697
Epoch:060, Trn_loss:0.0017, Trn_acc:0.3682, Tst_loss:0.0091, Tst_acc:0.3733
Epoch:061, Trn_loss:0.0017, Trn_acc:0.3426, Tst_loss:0.0085, Tst_acc:0.3502
Epoch:062, Trn_loss:0.0018, Trn_acc:0.3810, Tst_loss:0.0080, Tst_acc:0.3806
Epoch:063, Trn_loss:0.0021, Trn_acc:0.3522, Tst_loss:0.0091, Tst_acc:0.3571
Epoch:064, Trn_loss:0.0021, Trn_acc:0.3551, Tst_loss:0.0085, Tst_acc:0.3615
Epoch:065, Trn_loss:0.0018, Trn_acc:0.3687, Tst_loss:0.0077, Tst_acc:0.3706
Epoch:066, Trn_loss:0.0016, Trn_acc:0.3712, Tst_loss:0.0079, Tst_acc:0.3735
Epoch:067, Trn_loss:0.0019, Trn_acc:0.3683, Tst_loss:0.0090, Tst_acc:0.3716
Epoch:068, Trn_loss:0.0017, Trn_acc:0.3603, Tst_loss:0.0089, Tst_acc:0.3628
Epoch:069, Trn_loss:0.0019, Trn_acc:0.3642, Tst_loss:0.0084, Tst_acc:0.3718
Epoch:070, Trn_loss:0.0020, Trn_acc:0.3674, Tst_loss:0.0092, Tst_acc:0.3731
Epoch:071, Trn_loss:0.0017, Trn_acc:0.3732, Tst_loss:0.0088, Tst_acc:0.3774
Epoch:072, Trn_loss:0.0018, Trn_acc:0.3458, Tst_loss:0.0115, Tst_acc:0.3473
Epoch:073, Trn_loss:0.0017, Trn_acc:0.3773, Tst_loss:0.0086, Tst_acc:0.3825
Epoch:074, Trn_loss:0.0020, Trn_acc:0.3511, Tst_loss:0.0084, Tst_acc:0.3587
Epoch:075, Trn_loss:0.0018, Trn_acc:0.3582, Tst_loss:0.0088, Tst_acc:0.3692
Epoch:076, Trn_loss:0.0020, Trn_acc:0.3599, Tst_loss:0.0093, Tst_acc:0.3662
Epoch:077, Trn_loss:0.0021, Trn_acc:0.3553, Tst_loss:0.0076, Tst_acc:0.3600
Epoch:078, Trn_loss:0.0017, Trn_acc:0.3590, Tst_loss:0.0086, Tst_acc:0.3647
Epoch:079, Trn_loss:0.0020, Trn_acc:0.3630, Tst_loss:0.0088, Tst_acc:0.3694
Epoch:080, Trn_loss:0.0017, Trn_acc:0.3385, Tst_loss:0.0094, Tst_acc:0.3446
Epoch:081, Trn_loss:0.0016, Trn_acc:0.3680, Tst_loss:0.0090, Tst_acc:0.3758
Epoch:082, Trn_loss:0.0020, Trn_acc:0.3338, Tst_loss:0.0087, Tst_acc:0.3374
Epoch:083, Trn_loss:0.0020, Trn_acc:0.3728, Tst_loss:0.0084, Tst_acc:0.3743
Epoch:084, Trn_loss:0.0016, Trn_acc:0.3555, Tst_loss:0.0075, Tst_acc:0.3638
Epoch:085, Trn_loss:0.0023, Trn_acc:0.3597, Tst_loss:0.0092, Tst_acc:0.3642
Epoch:086, Trn_loss:0.0019, Trn_acc:0.3583, Tst_loss:0.0107, Tst_acc:0.3576
Epoch:087, Trn_loss:0.0017, Trn_acc:0.3539, Tst_loss:0.0089, Tst_acc:0.3607
Epoch:088, Trn_loss:0.0018, Trn_acc:0.3517, Tst_loss:0.0093, Tst_acc:0.3573
Epoch:089, Trn_loss:0.0016, Trn_acc:0.3725, Tst_loss:0.0094, Tst_acc:0.3782
Epoch:090, Trn_loss:0.0019, Trn_acc:0.3608, Tst_loss:0.0156, Tst_acc:0.3612
Epoch:091, Trn_loss:0.0016, Trn_acc:0.3598, Tst_loss:0.0090, Tst_acc:0.3631
Epoch:092, Trn_loss:0.0018, Trn_acc:0.3655, Tst_loss:0.0076, Tst_acc:0.3757
Epoch:093, Trn_loss:0.0017, Trn_acc:0.3619, Tst_loss:0.0085, Tst_acc:0.3624
Epoch:094, Trn_loss:0.0018, Trn_acc:0.3707, Tst_loss:0.0098, Tst_acc:0.3710
Epoch:095, Trn_loss:0.0016, Trn_acc:0.3705, Tst_loss:0.0085, Tst_acc:0.3741
Epoch:096, Trn_loss:0.0020, Trn_acc:0.3612, Tst_loss:0.0091, Tst_acc:0.3646
Epoch:097, Trn_loss:0.0021, Trn_acc:0.3421, Tst_loss:0.0088, Tst_acc:0.3472
Epoch:098, Trn_loss:0.0019, Trn_acc:0.3533, Tst_loss:0.0093, Tst_acc:0.3578
Epoch:099, Trn_loss:0.0016, Trn_acc:0.3379, Tst_loss:0.0094, Tst_acc:0.3442
Epoch:100, Trn_loss:0.0017, Trn_acc:0.3656, Tst_loss:0.0080, Tst_acc:0.3696
Finetune done
